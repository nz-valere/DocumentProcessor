2025-06-24 09:59:46 [INF] Application starting up
2025-06-24 09:59:46 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 09:59:46 [DBG] Hosting starting
2025-06-24 09:59:47 [INF] Now listening on: "http://localhost:5190"
2025-06-24 09:59:47 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 09:59:47 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 09:59:47 [INF] Hosting environment: "Development"
2025-06-24 09:59:47 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 09:59:47 [DBG] Hosting started
2025-06-24 10:00:18 [DBG] Connection id ""0HNDIVM5ER012"" accepted.
2025-06-24 10:00:18 [DBG] Connection id ""0HNDIVM5ER012"" started.
2025-06-24 10:00:18 [DBG] Connection id ""0HNDIVM5ER013"" accepted.
2025-06-24 10:00:18 [DBG] Connection id ""0HNDIVM5ER013"" started.
2025-06-24 10:00:18 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 10:00:18 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 10:00:18 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 10:00:18 [DBG] Request did not match any endpoints
2025-06-24 10:00:18 [DBG] Connection id ""0HNDIVM5ER012"" completed keep alive response.
2025-06-24 10:00:18 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 115.9038ms
2025-06-24 10:00:19 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 10:00:19 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 10:00:19 [DBG] Request did not match any endpoints
2025-06-24 10:00:19 [DBG] Connection id ""0HNDIVM5ER012"" completed keep alive response.
2025-06-24 10:00:19 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 100.4525ms
2025-06-24 10:01:02 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarydHJ7A6i4uySY52aC" 284721
2025-06-24 10:01:02 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 10:01:02 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 10:01:02 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 10:01:02 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 10:01:02 [WRN] Failed to determine the https port for redirect.
2025-06-24 10:01:02 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 10:01:02 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 10:01:02 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 10:01:02 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 10:01:02 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 10:01:02 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 10:01:02 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 10:01:02 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 10:01:02 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 10:01:03 [INF] Tesseract engine initialized successfully
2025-06-24 10:01:03 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 10:01:03 [DBG] Connection id ""0HNDIVM5ER012"", Request id ""0HNDIVM5ER012:00000003"": started reading request body.
2025-06-24 10:01:03 [DBG] Connection id ""0HNDIVM5ER012"", Request id ""0HNDIVM5ER012:00000003"": done reading request body.
2025-06-24 10:01:03 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 10:01:03 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 10:01:03 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 10:01:03 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 10:01:03 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 10:01:03 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 10:01:03 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 10:01:03 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 10:01:03 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 10:01:03 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 10:01:03 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 10:01:03 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 10:01:03 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 10:01:03 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 10:01:03 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 10:01:04 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 10:01:04 [DBG] Processing page 1/1
2025-06-24 10:01:05 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 10:01:06 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 10:01:06 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 10:01:06 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 10:01:06 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 10:01:06 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 10:01:06 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 10:01:06 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 10:01:06 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 10:01:06 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 10:01:06 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 10:01:06 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 10:01:06 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 10:01:06 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 10:01:06 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 10:01:06 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 10:01:06 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 10:01:06 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 10:01:06 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 10:01:06 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 10:01:06 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 10:01:06 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[ImageOcrMicroservice.Models.DocumentMetadata, DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 10:01:06 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3859.8603ms
2025-06-24 10:01:06 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 10:01:06 [DBG] Connection id ""0HNDIVM5ER012"" completed keep alive response.
2025-06-24 10:01:06 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 10:01:06 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3928.0831ms
2025-06-24 10:01:20 [DBG] Connection id ""0HNDIVM5ER013"" received FIN.
2025-06-24 10:01:20 [DBG] Connection id ""0HNDIVM5ER013"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 10:01:20 [DBG] Connection id ""0HNDIVM5ER013"" disconnecting.
2025-06-24 10:01:20 [DBG] Connection id ""0HNDIVM5ER013"" stopped.
2025-06-24 10:03:18 [DBG] Connection id ""0HNDIVM5ER012"" disconnecting.
2025-06-24 10:03:18 [DBG] Connection id ""0HNDIVM5ER012"" stopped.
2025-06-24 10:03:18 [DBG] Connection id ""0HNDIVM5ER012"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 10:03:44 [DBG] Connection id ""0HNDIVM5ER014"" accepted.
2025-06-24 10:03:44 [DBG] Connection id ""0HNDIVM5ER014"" started.
2025-06-24 10:03:44 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/api/Metadata/document-types""" - null null
2025-06-24 10:03:44 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/document-types"'
2025-06-24 10:03:44 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.GetSupportedDocumentTypes (DocumentProcessor.API)"' with route pattern '"api/Metadata/document-types"' is valid for the request path '"/api/Metadata/document-types"'
2025-06-24 10:03:44 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.GetSupportedDocumentTypes (DocumentProcessor.API)"'
2025-06-24 10:03:44 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 10:03:44 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.GetSupportedDocumentTypes (DocumentProcessor.API)"'
2025-06-24 10:03:44 [INF] Route matched with "{action = \"GetSupportedDocumentTypes\", controller = \"Metadata\"}". Executing controller action with signature "Microsoft.AspNetCore.Mvc.IActionResult GetSupportedDocumentTypes()" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 10:03:44 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 10:03:44 [DBG] Execution plan of "resource" filters (in the following order): ["None"]
2025-06-24 10:03:44 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 10:03:44 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 10:03:44 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 10:03:44 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 10:03:44 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 10:03:44 [INF] Tesseract engine initialized successfully
2025-06-24 10:03:44 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 10:03:44 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 10:03:44 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 10:03:44 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 10:03:44 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 10:03:44 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 10:03:44 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 10:03:44 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType5`2[[System.Collections.Generic.List`1[[<>f__AnonymousType4`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-06-24 10:03:44 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.GetSupportedDocumentTypes (DocumentProcessor.API)" in 57.1671ms
2025-06-24 10:03:44 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.GetSupportedDocumentTypes (DocumentProcessor.API)"'
2025-06-24 10:03:44 [DBG] Connection id ""0HNDIVM5ER014"" completed keep alive response.
2025-06-24 10:03:44 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 10:03:44 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/api/Metadata/document-types""" - 200 null "application/json; charset=utf-8" 81.3971ms
2025-06-24 10:05:55 [DBG] Connection id ""0HNDIVM5ER014"" disconnecting.
2025-06-24 10:05:55 [DBG] Connection id ""0HNDIVM5ER014"" stopped.
2025-06-24 10:05:55 [DBG] Connection id ""0HNDIVM5ER014"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:02:03 [INF] Application is shutting down...
2025-06-24 11:02:03 [DBG] Hosting stopping
2025-06-24 11:02:03 [DBG] Hosting stopped
2025-06-24 11:10:35 [INF] Application starting up
2025-06-24 11:10:35 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 11:10:35 [DBG] Hosting starting
2025-06-24 11:10:35 [INF] Now listening on: "http://localhost:5190"
2025-06-24 11:10:35 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 11:10:35 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 11:10:35 [INF] Hosting environment: "Development"
2025-06-24 11:10:35 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 11:10:35 [DBG] Hosting started
2025-06-24 11:10:45 [DBG] Connection id ""0HNDJ0TH7MTNA"" accepted.
2025-06-24 11:10:45 [DBG] Connection id ""0HNDJ0TH7MTNA"" started.
2025-06-24 11:10:45 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarySJFWvJnAMO0znAgb" 284721
2025-06-24 11:10:45 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 11:10:45 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:10:45 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:10:45 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:10:45 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:10:45 [WRN] Failed to determine the https port for redirect.
2025-06-24 11:10:45 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:10:45 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:10:45 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:10:45 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:10:45 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:10:45 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:10:45 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:10:45 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:10:45 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:10:45 [INF] Tesseract engine initialized successfully
2025-06-24 11:10:45 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:10:45 [DBG] Connection id ""0HNDJ0TH7MTNA"", Request id ""0HNDJ0TH7MTNA:00000001"": started reading request body.
2025-06-24 11:10:45 [DBG] Connection id ""0HNDJ0TH7MTNA"", Request id ""0HNDJ0TH7MTNA:00000001"": done reading request body.
2025-06-24 11:10:45 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:10:45 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:10:45 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:10:45 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:10:45 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:10:45 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:10:45 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:10:45 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:10:45 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:10:45 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:10:45 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:10:45 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:10:45 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:10:45 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:10:46 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:10:47 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:10:47 [DBG] Processing page 1/1
2025-06-24 11:10:47 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:10:48 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:10:48 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:10:48 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:10:48 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:10:48 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:10:48 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:10:48 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:10:48 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:10:49 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:10:49 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:10:49 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:10:49 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:10:49 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:10:49 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:10:49 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:10:49 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:10:49 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:10:49 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:10:49 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:10:49 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:10:49 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[ImageOcrMicroservice.Models.DocumentMetadata, DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:10:49 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3559.1333ms
2025-06-24 11:10:49 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:10:49 [DBG] Connection id ""0HNDJ0TH7MTNA"" completed keep alive response.
2025-06-24 11:10:49 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:10:49 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3630.9648ms
2025-06-24 11:11:00 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 11:11:00 [DBG] Connection id ""0HNDJ0TH7MTNB"" accepted.
2025-06-24 11:11:00 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 11:11:00 [DBG] Connection id ""0HNDJ0TH7MTNB"" started.
2025-06-24 11:11:00 [DBG] Request did not match any endpoints
2025-06-24 11:11:00 [DBG] Connection id ""0HNDJ0TH7MTNA"" completed keep alive response.
2025-06-24 11:11:00 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 41.6529ms
2025-06-24 11:11:00 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 11:11:00 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 11:11:00 [DBG] Request did not match any endpoints
2025-06-24 11:11:01 [DBG] Connection id ""0HNDJ0TH7MTNA"" completed keep alive response.
2025-06-24 11:11:01 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 127.2125ms
2025-06-24 11:11:17 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarymeMgj302Tg0B0A2R" 284721
2025-06-24 11:11:17 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:11:17 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:11:17 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:11:17 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:11:17 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:11:17 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:11:17 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:11:17 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:11:17 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:11:17 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:11:17 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:11:17 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:11:17 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:11:17 [INF] Tesseract engine initialized successfully
2025-06-24 11:11:17 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:11:17 [DBG] Connection id ""0HNDJ0TH7MTNA"", Request id ""0HNDJ0TH7MTNA:00000004"": started reading request body.
2025-06-24 11:11:17 [DBG] Connection id ""0HNDJ0TH7MTNA"", Request id ""0HNDJ0TH7MTNA:00000004"": done reading request body.
2025-06-24 11:11:17 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:11:17 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:11:17 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:11:17 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:11:17 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:11:17 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:11:17 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:11:17 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:11:17 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:11:17 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:11:17 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:11:17 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:11:17 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:11:17 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:11:17 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:11:18 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:11:18 [DBG] Processing page 1/1
2025-06-24 11:11:19 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:11:20 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:11:20 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:11:20 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:11:20 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:11:20 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:11:20 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:11:20 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:11:20 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:11:20 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:11:20 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:11:20 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:11:20 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:11:20 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:11:20 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:11:20 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:11:20 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:11:20 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:11:20 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:11:20 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:11:20 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:11:20 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[ImageOcrMicroservice.Models.DocumentMetadata, DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:11:20 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2894.0572ms
2025-06-24 11:11:20 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:11:20 [DBG] Connection id ""0HNDJ0TH7MTNA"" completed keep alive response.
2025-06-24 11:11:20 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:11:20 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2921.0343ms
2025-06-24 11:12:00 [DBG] Connection id ""0HNDJ0TH7MTNB"" received FIN.
2025-06-24 11:12:00 [DBG] Connection id ""0HNDJ0TH7MTNB"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:12:00 [DBG] Connection id ""0HNDJ0TH7MTNB"" disconnecting.
2025-06-24 11:12:00 [DBG] Connection id ""0HNDJ0TH7MTNB"" stopped.
2025-06-24 11:12:44 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundary6wUyVbrgwyyJBFPI" 284721
2025-06-24 11:12:44 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:12:44 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:12:44 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:12:44 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:12:44 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:12:44 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:12:44 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:12:44 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:12:44 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:12:44 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:12:44 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:12:44 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:12:44 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:12:44 [INF] Tesseract engine initialized successfully
2025-06-24 11:12:44 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:12:44 [DBG] Connection id ""0HNDJ0TH7MTNA"", Request id ""0HNDJ0TH7MTNA:00000005"": started reading request body.
2025-06-24 11:12:44 [DBG] Connection id ""0HNDJ0TH7MTNA"", Request id ""0HNDJ0TH7MTNA:00000005"": done reading request body.
2025-06-24 11:12:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:12:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:12:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:12:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:12:44 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:12:44 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:12:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:12:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:12:44 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:12:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:12:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:12:44 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:12:44 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:12:44 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:12:44 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:12:45 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:12:45 [DBG] Processing page 1/1
2025-06-24 11:12:46 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:12:47 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:12:47 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:12:47 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:12:47 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:12:47 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:12:47 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:12:47 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:12:47 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:12:47 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:12:47 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:12:47 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:12:47 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:12:47 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:12:47 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:12:47 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:12:47 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:12:47 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:12:47 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:12:47 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:12:47 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:12:47 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[ImageOcrMicroservice.Models.DocumentMetadata, DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:12:47 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2789.9212ms
2025-06-24 11:12:47 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:12:47 [DBG] Connection id ""0HNDJ0TH7MTNA"" completed keep alive response.
2025-06-24 11:12:47 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:12:47 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2819.8135ms
2025-06-24 11:14:58 [DBG] Connection id ""0HNDJ0TH7MTNA"" disconnecting.
2025-06-24 11:14:58 [DBG] Connection id ""0HNDJ0TH7MTNA"" stopped.
2025-06-24 11:14:58 [DBG] Connection id ""0HNDJ0TH7MTNA"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:18:21 [INF] Application is shutting down...
2025-06-24 11:18:21 [DBG] Hosting stopping
2025-06-24 11:18:21 [DBG] Hosting stopped
2025-06-24 11:18:25 [INF] Application starting up
2025-06-24 11:18:25 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 11:18:25 [DBG] Hosting starting
2025-06-24 11:18:25 [INF] Now listening on: "http://localhost:5190"
2025-06-24 11:18:25 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 11:18:25 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 11:18:25 [INF] Hosting environment: "Development"
2025-06-24 11:18:25 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 11:18:25 [DBG] Hosting started
2025-06-24 11:19:16 [DBG] Connection id ""0HNDJ129ISNIP"" accepted.
2025-06-24 11:19:16 [DBG] Connection id ""0HNDJ129ISNIP"" started.
2025-06-24 11:19:16 [DBG] Connection id ""0HNDJ129ISNIQ"" accepted.
2025-06-24 11:19:16 [DBG] Connection id ""0HNDJ129ISNIQ"" started.
2025-06-24 11:19:16 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 11:19:16 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 11:19:16 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 11:19:16 [DBG] Request did not match any endpoints
2025-06-24 11:19:16 [DBG] Connection id ""0HNDJ129ISNIP"" completed keep alive response.
2025-06-24 11:19:16 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 77.5233ms
2025-06-24 11:19:17 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 11:19:17 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 11:19:17 [DBG] Request did not match any endpoints
2025-06-24 11:19:17 [DBG] Connection id ""0HNDJ129ISNIP"" completed keep alive response.
2025-06-24 11:19:17 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 116.7863ms
2025-06-24 11:19:29 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryCwVEa9BWOE2dla5E" 284721
2025-06-24 11:19:29 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:19:29 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:19:29 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:19:29 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:19:29 [WRN] Failed to determine the https port for redirect.
2025-06-24 11:19:29 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:19:29 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:19:29 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:19:29 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:19:29 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:19:29 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:19:29 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:19:29 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:19:29 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:19:29 [INF] Tesseract engine initialized successfully
2025-06-24 11:19:29 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:19:29 [DBG] Connection id ""0HNDJ129ISNIP"", Request id ""0HNDJ129ISNIP:00000003"": started reading request body.
2025-06-24 11:19:29 [DBG] Connection id ""0HNDJ129ISNIP"", Request id ""0HNDJ129ISNIP:00000003"": done reading request body.
2025-06-24 11:19:29 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:19:29 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:19:29 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:19:29 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:19:29 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:19:29 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:19:29 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:19:29 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:19:29 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:19:29 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:19:29 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:19:29 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:19:29 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:19:29 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:19:29 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:19:30 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:19:30 [DBG] Processing page 1/1
2025-06-24 11:19:31 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:19:31 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:19:31 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:19:31 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:19:31 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:19:31 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:19:31 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:19:31 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:19:31 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:19:32 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:19:32 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:19:32 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:19:32 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:19:32 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:19:32 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:19:32 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:19:32 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:19:32 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:19:32 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:19:32 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:19:32 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:19:32 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:19:32 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2708.4133ms
2025-06-24 11:19:32 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:19:32 [DBG] Connection id ""0HNDJ129ISNIP"" completed keep alive response.
2025-06-24 11:19:32 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:19:32 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2758.4896ms
2025-06-24 11:20:19 [DBG] Connection id ""0HNDJ129ISNIQ"" received FIN.
2025-06-24 11:20:19 [DBG] Connection id ""0HNDJ129ISNIQ"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:20:19 [DBG] Connection id ""0HNDJ129ISNIQ"" disconnecting.
2025-06-24 11:20:19 [DBG] Connection id ""0HNDJ129ISNIQ"" stopped.
2025-06-24 11:21:43 [DBG] Connection id ""0HNDJ129ISNIP"" disconnecting.
2025-06-24 11:21:43 [DBG] Connection id ""0HNDJ129ISNIP"" stopped.
2025-06-24 11:21:43 [DBG] Connection id ""0HNDJ129ISNIP"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:27:11 [INF] Application is shutting down...
2025-06-24 11:27:11 [DBG] Hosting stopping
2025-06-24 11:27:11 [DBG] Hosting stopped
2025-06-24 11:27:16 [INF] Application starting up
2025-06-24 11:27:16 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 11:27:16 [DBG] Hosting starting
2025-06-24 11:27:16 [INF] Now listening on: "http://localhost:5190"
2025-06-24 11:27:16 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 11:27:16 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 11:27:16 [INF] Hosting environment: "Development"
2025-06-24 11:27:16 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 11:27:16 [DBG] Hosting started
2025-06-24 11:27:23 [DBG] Connection id ""0HNDJ16QII5GR"" accepted.
2025-06-24 11:27:23 [DBG] Connection id ""0HNDJ16QII5GR"" started.
2025-06-24 11:27:23 [DBG] Connection id ""0HNDJ16QII5GS"" accepted.
2025-06-24 11:27:23 [DBG] Connection id ""0HNDJ16QII5GS"" started.
2025-06-24 11:27:23 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 11:27:23 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 11:27:23 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 11:27:23 [DBG] Request did not match any endpoints
2025-06-24 11:27:23 [DBG] Connection id ""0HNDJ16QII5GR"" completed keep alive response.
2025-06-24 11:27:23 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 84.9757ms
2025-06-24 11:27:23 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 11:27:23 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 11:27:23 [DBG] Request did not match any endpoints
2025-06-24 11:27:23 [DBG] Connection id ""0HNDJ16QII5GR"" completed keep alive response.
2025-06-24 11:27:23 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 92.1274ms
2025-06-24 11:27:37 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarybO7tdNK71rJDX7Bi" 284721
2025-06-24 11:27:37 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:27:37 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:27:37 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:27:37 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:27:37 [WRN] Failed to determine the https port for redirect.
2025-06-24 11:27:37 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:27:37 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:27:37 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:27:37 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:27:37 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:27:37 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:27:37 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:27:37 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:27:37 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:27:38 [INF] Tesseract engine initialized successfully
2025-06-24 11:27:38 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:27:38 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000003"": started reading request body.
2025-06-24 11:27:38 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000003"": done reading request body.
2025-06-24 11:27:38 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:27:38 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:27:38 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:27:38 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:27:38 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:27:38 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:27:38 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:27:38 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:27:38 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:38 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:38 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:38 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:27:38 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:38 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:27:38 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:27:39 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:27:39 [DBG] Processing page 1/1
2025-06-24 11:27:39 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:27:41 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:27:41 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:27:41 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:27:41 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:27:41 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:27:41 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:27:41 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:27:41 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:27:41 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:27:41 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:27:41 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:27:41 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:27:41 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:27:41 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:27:41 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:27:41 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:27:41 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:27:41 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:27:41 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:27:41 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:27:41 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:27:41 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3297.6517ms
2025-06-24 11:27:41 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:27:41 [DBG] Connection id ""0HNDJ16QII5GR"" completed keep alive response.
2025-06-24 11:27:41 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:27:41 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3365.2187ms
2025-06-24 11:27:54 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryFbTVADuGeQdKpZBV" 491180
2025-06-24 11:27:54 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:27:54 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:27:54 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:27:54 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:27:54 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:27:54 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:27:54 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:27:54 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:27:54 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:27:54 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:27:54 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:27:54 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:27:54 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:27:54 [INF] Tesseract engine initialized successfully
2025-06-24 11:27:54 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:27:54 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000004"": started reading request body.
2025-06-24 11:27:54 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000004"": done reading request body.
2025-06-24 11:27:54 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:27:54 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:27:54 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:27:54 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:27:54 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:27:54 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:27:54 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:27:54 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:27:54 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:54 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:54 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:54 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:27:54 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:27:54 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 11:27:54 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-24 11:27:56 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:27:56 [DBG] Processing page 1/1
2025-06-24 11:27:56 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-24 11:27:59 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-24 11:27:59 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-24 11:27:59 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:27:59 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 11:27:59 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 11:27:59 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 11:27:59 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 11:27:59 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 11:27:59 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:27:59 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, RawText"]
2025-06-24 11:27:59 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 8, Is filtered: True
2025-06-24 11:27:59 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:27:59 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 11:27:59 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:27:59 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:27:59 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:27:59 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:27:59 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:27:59 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:27:59 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:27:59 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4269.2614ms
2025-06-24 11:27:59 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:27:59 [DBG] Connection id ""0HNDJ16QII5GR"" completed keep alive response.
2025-06-24 11:27:59 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:27:59 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4297.6616ms
2025-06-24 11:28:28 [DBG] Connection id ""0HNDJ16QII5GS"" received FIN.
2025-06-24 11:28:28 [DBG] Connection id ""0HNDJ16QII5GS"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:28:28 [DBG] Connection id ""0HNDJ16QII5GS"" disconnecting.
2025-06-24 11:28:28 [DBG] Connection id ""0HNDJ16QII5GS"" stopped.
2025-06-24 11:29:23 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundary7A01BoRkIvZ1F7kg" 284721
2025-06-24 11:29:23 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:29:23 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:29:23 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:29:23 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:29:23 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:29:23 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:29:23 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:29:23 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:29:23 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:29:23 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:29:23 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:29:23 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:29:23 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:29:23 [INF] Tesseract engine initialized successfully
2025-06-24 11:29:23 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:29:23 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000005"": started reading request body.
2025-06-24 11:29:23 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000005"": done reading request body.
2025-06-24 11:29:23 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:29:23 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:29:23 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:29:23 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:29:23 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:29:23 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:29:23 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:29:23 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:29:23 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:23 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:23 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:23 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:29:23 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:23 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:23 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:29:24 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:29:24 [DBG] Processing page 1/1
2025-06-24 11:29:25 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:29:26 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:29:26 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:29:26 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:29:26 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:26 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:26 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:29:26 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:29:26 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:29:26 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:29:26 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:29:26 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:29:26 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:29:26 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:29:26 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:26 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:29:26 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:29:26 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:29:26 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:29:26 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:29:26 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:29:26 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:29:26 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2557.4581ms
2025-06-24 11:29:26 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:29:26 [DBG] Connection id ""0HNDJ16QII5GR"" completed keep alive response.
2025-06-24 11:29:26 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:29:26 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2577.7036ms
2025-06-24 11:29:48 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundary8x5YfB2BHheccUMk" 284721
2025-06-24 11:29:48 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:29:48 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:29:48 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:29:48 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:29:48 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:29:48 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:29:48 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:29:48 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:29:48 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:29:48 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:29:48 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:29:48 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:29:48 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:29:48 [INF] Tesseract engine initialized successfully
2025-06-24 11:29:48 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:29:48 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000006"": started reading request body.
2025-06-24 11:29:48 [DBG] Connection id ""0HNDJ16QII5GR"", Request id ""0HNDJ16QII5GR:00000006"": done reading request body.
2025-06-24 11:29:48 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:29:48 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:29:48 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:29:48 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:29:48 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:29:48 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:29:48 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:29:48 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:29:48 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:48 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:48 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:48 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:29:48 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:29:48 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:48 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:29:49 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:29:49 [DBG] Processing page 1/1
2025-06-24 11:29:50 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:29:51 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:29:51 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:29:51 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:29:51 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:51 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:51 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:29:51 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:29:51 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:29:51 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:29:51 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:29:51 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:29:51 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:29:51 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:29:51 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:29:51 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:29:51 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:29:51 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:29:51 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:29:51 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:29:51 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:29:51 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:29:51 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2691.1664ms
2025-06-24 11:29:51 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:29:51 [DBG] Connection id ""0HNDJ16QII5GR"" completed keep alive response.
2025-06-24 11:29:51 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:29:51 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2724.0724ms
2025-06-24 11:32:02 [DBG] Connection id ""0HNDJ16QII5GR"" disconnecting.
2025-06-24 11:32:02 [DBG] Connection id ""0HNDJ16QII5GR"" stopped.
2025-06-24 11:32:02 [DBG] Connection id ""0HNDJ16QII5GR"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:32:38 [INF] Application is shutting down...
2025-06-24 11:32:38 [DBG] Hosting stopping
2025-06-24 11:32:38 [DBG] Hosting stopped
2025-06-24 11:33:30 [INF] Application starting up
2025-06-24 11:33:30 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 11:33:30 [DBG] Hosting starting
2025-06-24 11:33:31 [INF] Now listening on: "http://localhost:5190"
2025-06-24 11:33:31 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 11:33:31 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 11:33:31 [INF] Hosting environment: "Development"
2025-06-24 11:33:31 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 11:33:31 [DBG] Hosting started
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFJ"" accepted.
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFJ"" started.
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFK"" accepted.
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFK"" started.
2025-06-24 11:34:54 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger""" - null null
2025-06-24 11:34:54 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 11:34:54 [DBG] No candidates found for the request path '"/swagger"'
2025-06-24 11:34:54 [DBG] Request did not match any endpoints
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFJ"" completed keep alive response.
2025-06-24 11:34:54 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger""" - 301 0 null 36.1676ms
2025-06-24 11:34:54 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 11:34:54 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 11:34:54 [DBG] Request did not match any endpoints
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFJ"" completed keep alive response.
2025-06-24 11:34:54 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 59.9906ms
2025-06-24 11:34:54 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui.css""" - null null
2025-06-24 11:34:54 [DBG] No candidates found for the request path '"/swagger/swagger-ui.css"'
2025-06-24 11:34:54 [DBG] Request did not match any endpoints
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFL"" accepted.
2025-06-24 11:34:54 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-bundle.js""" - null null
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFL"" started.
2025-06-24 11:34:54 [DBG] No candidates found for the request path '"/swagger/swagger-ui-bundle.js"'
2025-06-24 11:34:54 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-standalone-preset.js""" - null null
2025-06-24 11:34:54 [DBG] Request did not match any endpoints
2025-06-24 11:34:54 [DBG] No candidates found for the request path '"/swagger/swagger-ui-standalone-preset.js"'
2025-06-24 11:34:54 [DBG] Request did not match any endpoints
2025-06-24 11:34:54 [INF] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
2025-06-24 11:34:54 [INF] Sending file. Request path: '"/swagger-ui-standalone-preset.js"'. Physical path: '"N/A"'
2025-06-24 11:34:54 [INF] Sending file. Request path: '"/swagger-ui-bundle.js"'. Physical path: '"N/A"'
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFJ"" completed keep alive response.
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFL"" completed keep alive response.
2025-06-24 11:34:54 [DBG] Connection id ""0HNDJ1B14TPFK"" completed keep alive response.
2025-06-24 11:34:54 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui.css""" - 200 152034 "text/css" 34.0657ms
2025-06-24 11:34:54 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-standalone-preset.js""" - 200 230280 "text/javascript" 25.6471ms
2025-06-24 11:34:54 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-bundle.js""" - 200 1456926 "text/javascript" 31.5966ms
2025-06-24 11:34:55 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 11:34:55 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 11:34:55 [DBG] Request did not match any endpoints
2025-06-24 11:34:55 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/favicon-32x32.png""" - null null
2025-06-24 11:34:55 [DBG] No candidates found for the request path '"/swagger/favicon-32x32.png"'
2025-06-24 11:34:55 [DBG] Request did not match any endpoints
2025-06-24 11:34:55 [INF] Sending file. Request path: '"/favicon-32x32.png"'. Physical path: '"N/A"'
2025-06-24 11:34:55 [DBG] Connection id ""0HNDJ1B14TPFL"" completed keep alive response.
2025-06-24 11:34:55 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/favicon-32x32.png""" - 200 628 "image/png" 6.472ms
2025-06-24 11:34:55 [DBG] Connection id ""0HNDJ1B14TPFK"" completed keep alive response.
2025-06-24 11:34:55 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 69.6971ms
2025-06-24 11:35:21 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryFSmZFO43pBdhwAQx" 284721
2025-06-24 11:35:21 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:35:21 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:35:21 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:35:21 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:35:21 [WRN] Failed to determine the https port for redirect.
2025-06-24 11:35:21 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:35:21 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:35:21 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:35:21 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:35:21 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:35:21 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:35:21 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:35:21 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:35:21 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:35:21 [INF] Tesseract engine initialized successfully
2025-06-24 11:35:21 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:35:22 [DBG] Connection id ""0HNDJ1B14TPFK"", Request id ""0HNDJ1B14TPFK:00000003"": started reading request body.
2025-06-24 11:35:22 [DBG] Connection id ""0HNDJ1B14TPFK"", Request id ""0HNDJ1B14TPFK:00000003"": done reading request body.
2025-06-24 11:35:22 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:35:22 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:35:22 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:35:22 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:35:22 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:35:22 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:35:22 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:35:22 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:35:22 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:35:22 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:35:22 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:35:22 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:35:22 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:35:22 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:35:22 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:35:23 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:35:23 [DBG] Processing page 1/1
2025-06-24 11:35:24 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:35:25 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:35:25 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:35:25 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:35:25 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:35:25 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:35:25 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:35:25 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:35:25 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:35:25 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:35:25 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:35:25 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:35:25 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:35:25 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:35:25 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:35:25 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:35:25 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:35:25 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:35:25 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:35:25 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:35:25 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:35:25 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:35:25 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3570.2571ms
2025-06-24 11:35:25 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:35:25 [DBG] Connection id ""0HNDJ1B14TPFK"" completed keep alive response.
2025-06-24 11:35:25 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:35:25 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3621.8509ms
2025-06-24 11:37:06 [DBG] Connection id ""0HNDJ1B14TPFJ"" disconnecting.
2025-06-24 11:37:06 [DBG] Connection id ""0HNDJ1B14TPFL"" disconnecting.
2025-06-24 11:37:06 [DBG] Connection id ""0HNDJ1B14TPFJ"" stopped.
2025-06-24 11:37:06 [DBG] Connection id ""0HNDJ1B14TPFL"" stopped.
2025-06-24 11:37:06 [DBG] Connection id ""0HNDJ1B14TPFL"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:37:06 [DBG] Connection id ""0HNDJ1B14TPFJ"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:37:35 [DBG] Connection id ""0HNDJ1B14TPFK"" disconnecting.
2025-06-24 11:37:35 [DBG] Connection id ""0HNDJ1B14TPFK"" stopped.
2025-06-24 11:37:35 [DBG] Connection id ""0HNDJ1B14TPFK"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:43:07 [INF] Application starting up
2025-06-24 11:43:07 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 11:43:07 [DBG] Hosting starting
2025-06-24 11:43:08 [INF] Now listening on: "http://localhost:5190"
2025-06-24 11:43:08 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 11:43:08 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 11:43:08 [INF] Hosting environment: "Development"
2025-06-24 11:43:08 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 11:43:08 [DBG] Hosting started
2025-06-24 11:43:40 [DBG] Connection id ""0HNDJ1FTV215R"" accepted.
2025-06-24 11:43:40 [DBG] Connection id ""0HNDJ1FTV215R"" started.
2025-06-24 11:43:40 [DBG] Connection id ""0HNDJ1FTV215S"" accepted.
2025-06-24 11:43:40 [DBG] Connection id ""0HNDJ1FTV215S"" started.
2025-06-24 11:43:40 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 11:43:40 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 11:43:40 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 11:43:40 [DBG] Request did not match any endpoints
2025-06-24 11:43:41 [DBG] Connection id ""0HNDJ1FTV215R"" completed keep alive response.
2025-06-24 11:43:41 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 89.2262ms
2025-06-24 11:43:41 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 11:43:41 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 11:43:41 [DBG] Request did not match any endpoints
2025-06-24 11:43:41 [DBG] Connection id ""0HNDJ1FTV215R"" completed keep alive response.
2025-06-24 11:43:41 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 110.9716ms
2025-06-24 11:43:57 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryswUIzwh6tg6AmP97" 284721
2025-06-24 11:43:57 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 11:43:57 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 11:43:57 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:43:57 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 11:43:57 [WRN] Failed to determine the https port for redirect.
2025-06-24 11:43:57 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:43:57 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 11:43:57 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 11:43:57 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 11:43:57 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 11:43:57 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 11:43:57 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 11:43:57 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:43:58 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 11:43:58 [INF] Tesseract engine initialized successfully
2025-06-24 11:43:58 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 11:43:58 [DBG] Connection id ""0HNDJ1FTV215R"", Request id ""0HNDJ1FTV215R:00000003"": started reading request body.
2025-06-24 11:43:58 [DBG] Connection id ""0HNDJ1FTV215R"", Request id ""0HNDJ1FTV215R:00000003"": done reading request body.
2025-06-24 11:43:58 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:43:58 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 11:43:58 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:43:58 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:43:58 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 11:43:58 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 11:43:58 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:43:58 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 11:43:58 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:43:58 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:43:58 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:43:58 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 11:43:58 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 11:43:58 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:43:58 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 11:43:59 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 11:43:59 [DBG] Processing page 1/1
2025-06-24 11:44:00 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 11:44:01 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 11:44:01 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 11:44:01 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 11:44:01 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:44:01 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:44:01 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:44:01 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:44:01 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 11:44:01 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 11:44:01 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 11:44:01 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 11:44:01 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 11:44:01 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 11:44:01 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 11:44:01 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 11:44:01 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 11:44:01 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 11:44:01 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 11:44:01 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 11:44:01 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 11:44:01 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 11:44:01 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3769.6573ms
2025-06-24 11:44:01 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 11:44:01 [DBG] Connection id ""0HNDJ1FTV215R"" completed keep alive response.
2025-06-24 11:44:01 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 11:44:01 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3832.13ms
2025-06-24 11:45:40 [DBG] Connection id ""0HNDJ1FTV215S"" received FIN.
2025-06-24 11:45:40 [DBG] Connection id ""0HNDJ1FTV215S"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:45:40 [DBG] Connection id ""0HNDJ1FTV215S"" disconnecting.
2025-06-24 11:45:40 [DBG] Connection id ""0HNDJ1FTV215S"" stopped.
2025-06-24 11:45:52 [DBG] Connection id ""0HNDJ1FTV215R"" received FIN.
2025-06-24 11:45:52 [DBG] Connection id ""0HNDJ1FTV215R"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 11:45:52 [DBG] Connection id ""0HNDJ1FTV215R"" disconnecting.
2025-06-24 11:45:52 [DBG] Connection id ""0HNDJ1FTV215R"" stopped.
2025-06-24 12:07:01 [DBG] Connection id ""0HNDJ1FTV215T"" accepted.
2025-06-24 12:07:01 [DBG] Connection id ""0HNDJ1FTV215T"" started.
2025-06-24 12:07:01 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryjSsj56chVKVaO2gR" 491180
2025-06-24 12:07:01 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 12:07:01 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 12:07:01 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 12:07:01 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 12:07:01 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 12:07:01 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 12:07:01 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 12:07:01 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 12:07:01 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 12:07:01 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 12:07:01 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 12:07:01 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 12:07:01 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 12:07:01 [INF] Tesseract engine initialized successfully
2025-06-24 12:07:01 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 12:07:01 [DBG] Connection id ""0HNDJ1FTV215T"", Request id ""0HNDJ1FTV215T:00000001"": started reading request body.
2025-06-24 12:07:01 [DBG] Connection id ""0HNDJ1FTV215T"", Request id ""0HNDJ1FTV215T:00000001"": done reading request body.
2025-06-24 12:07:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 12:07:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 12:07:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 12:07:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 12:07:01 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 12:07:01 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 12:07:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 12:07:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 12:07:01 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 12:07:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 12:07:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 12:07:01 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 12:07:01 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 12:07:01 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 12:07:01 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-24 12:07:02 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 12:07:02 [DBG] Processing page 1/1
2025-06-24 12:07:03 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-24 12:07:05 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-24 12:07:05 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-24 12:07:05 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 12:07:05 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 12:07:05 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 12:07:05 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 12:07:05 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 12:07:05 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 12:07:05 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 12:07:05 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, RawText"]
2025-06-24 12:07:05 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 8, Is filtered: True
2025-06-24 12:07:05 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 12:07:05 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 12:07:05 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 12:07:05 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 12:07:05 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 12:07:05 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 12:07:05 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 12:07:05 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 12:07:05 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 12:07:05 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4097.7779ms
2025-06-24 12:07:05 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 12:07:05 [DBG] Connection id ""0HNDJ1FTV215T"" completed keep alive response.
2025-06-24 12:07:05 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 12:07:05 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4131.7679ms
2025-06-24 12:09:16 [DBG] Connection id ""0HNDJ1FTV215T"" disconnecting.
2025-06-24 12:09:16 [DBG] Connection id ""0HNDJ1FTV215T"" stopped.
2025-06-24 12:09:16 [DBG] Connection id ""0HNDJ1FTV215T"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 14:15:15 [INF] Application is shutting down...
2025-06-24 14:15:15 [DBG] Hosting stopping
2025-06-24 14:15:15 [DBG] Hosting stopped
2025-06-24 14:15:22 [INF] Application starting up
2025-06-24 14:15:22 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 14:15:22 [DBG] Hosting starting
2025-06-24 14:15:22 [INF] Now listening on: "http://localhost:5190"
2025-06-24 14:15:22 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 14:15:22 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 14:15:22 [INF] Hosting environment: "Development"
2025-06-24 14:15:22 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 14:15:22 [DBG] Hosting started
2025-06-24 14:15:28 [DBG] Connection id ""0HNDJ44OA6S6P"" accepted.
2025-06-24 14:15:28 [DBG] Connection id ""0HNDJ44OA6S6P"" started.
2025-06-24 14:15:28 [DBG] Connection id ""0HNDJ44OA6S6Q"" accepted.
2025-06-24 14:15:28 [DBG] Connection id ""0HNDJ44OA6S6Q"" started.
2025-06-24 14:15:28 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 14:15:28 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 14:15:28 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 14:15:28 [DBG] Request did not match any endpoints
2025-06-24 14:15:28 [DBG] Connection id ""0HNDJ44OA6S6P"" completed keep alive response.
2025-06-24 14:15:28 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 97.7718ms
2025-06-24 14:15:29 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 14:15:29 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 14:15:29 [DBG] Request did not match any endpoints
2025-06-24 14:15:29 [DBG] Connection id ""0HNDJ44OA6S6P"" completed keep alive response.
2025-06-24 14:15:29 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 76.2191ms
2025-06-24 14:15:51 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryvrlUfXOU594nQhk2" 284721
2025-06-24 14:15:51 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 14:15:51 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 14:15:51 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:15:51 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 14:15:51 [WRN] Failed to determine the https port for redirect.
2025-06-24 14:15:51 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:15:51 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 14:15:51 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 14:15:51 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 14:15:51 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 14:15:51 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 14:15:51 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 14:15:51 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 14:15:51 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 14:15:51 [INF] Tesseract engine initialized successfully
2025-06-24 14:15:51 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 14:15:51 [DBG] Connection id ""0HNDJ44OA6S6P"", Request id ""0HNDJ44OA6S6P:00000003"": started reading request body.
2025-06-24 14:15:51 [DBG] Connection id ""0HNDJ44OA6S6P"", Request id ""0HNDJ44OA6S6P:00000003"": done reading request body.
2025-06-24 14:15:51 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 14:15:51 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 14:15:51 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:15:51 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:15:51 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 14:15:51 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:15:51 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 14:15:51 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 14:15:51 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:15:51 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:15:51 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:15:51 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 14:15:51 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:15:51 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 14:15:51 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 14:15:52 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 14:15:52 [DBG] Processing page 1/1
2025-06-24 14:15:53 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 14:15:54 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 14:15:54 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 14:15:54 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 14:15:54 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 14:15:54 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 14:15:54 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 14:15:54 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 14:15:54 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 14:15:54 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 14:15:54 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 14:15:54 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 14:15:54 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 14:15:54 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-06-24 14:15:54 [WRN] Validation issues for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 14:15:54 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 14:15:54 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 14:15:54 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 14:15:54 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 14:15:54 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 14:15:54 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 14:15:54 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 14:15:54 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 14:15:54 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3075.8298ms
2025-06-24 14:15:54 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:15:54 [DBG] Connection id ""0HNDJ44OA6S6P"" completed keep alive response.
2025-06-24 14:15:54 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 14:15:54 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3138.592ms
2025-06-24 14:16:37 [DBG] Connection id ""0HNDJ44OA6S6Q"" received FIN.
2025-06-24 14:16:37 [DBG] Connection id ""0HNDJ44OA6S6Q"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 14:16:37 [DBG] Connection id ""0HNDJ44OA6S6Q"" disconnecting.
2025-06-24 14:16:37 [DBG] Connection id ""0HNDJ44OA6S6Q"" stopped.
2025-06-24 14:18:04 [DBG] Connection id ""0HNDJ44OA6S6P"" disconnecting.
2025-06-24 14:18:04 [DBG] Connection id ""0HNDJ44OA6S6P"" stopped.
2025-06-24 14:18:04 [DBG] Connection id ""0HNDJ44OA6S6P"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 14:18:39 [DBG] Connection id ""0HNDJ44OA6S6R"" accepted.
2025-06-24 14:18:39 [DBG] Connection id ""0HNDJ44OA6S6R"" started.
2025-06-24 14:18:39 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryseVoJAWjWfWnijjt" 491180
2025-06-24 14:18:39 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 14:18:39 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 14:18:39 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:18:39 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 14:18:39 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:18:39 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 14:18:39 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 14:18:39 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 14:18:39 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 14:18:39 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 14:18:39 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 14:18:39 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 14:18:39 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 14:18:39 [INF] Tesseract engine initialized successfully
2025-06-24 14:18:39 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 14:18:39 [DBG] Connection id ""0HNDJ44OA6S6R"", Request id ""0HNDJ44OA6S6R:00000001"": started reading request body.
2025-06-24 14:18:39 [DBG] Connection id ""0HNDJ44OA6S6R"", Request id ""0HNDJ44OA6S6R:00000001"": done reading request body.
2025-06-24 14:18:39 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 14:18:39 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 14:18:39 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:18:39 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:18:39 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 14:18:39 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:18:39 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 14:18:39 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 14:18:39 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:18:39 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:18:39 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:18:39 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 14:18:39 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:18:39 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:18:39 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-24 14:18:40 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 14:18:40 [DBG] Processing page 1/1
2025-06-24 14:18:41 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-24 14:18:43 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-24 14:18:43 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-24 14:18:43 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 14:18:43 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:18:43 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:18:43 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 14:18:43 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 14:18:43 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 14:18:43 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 14:18:43 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, RawText"]
2025-06-24 14:18:43 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 8, Is filtered: True
2025-06-24 14:18:43 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 14:18:43 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:18:43 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 14:18:43 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 14:18:43 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 14:18:43 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 14:18:43 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 14:18:43 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 14:18:43 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 14:18:43 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4045.3412ms
2025-06-24 14:18:43 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:18:43 [DBG] Connection id ""0HNDJ44OA6S6R"" completed keep alive response.
2025-06-24 14:18:43 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 14:18:43 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4071.7414ms
2025-06-24 14:20:54 [DBG] Connection id ""0HNDJ44OA6S6R"" disconnecting.
2025-06-24 14:20:54 [DBG] Connection id ""0HNDJ44OA6S6R"" stopped.
2025-06-24 14:20:54 [DBG] Connection id ""0HNDJ44OA6S6R"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 14:35:16 [INF] Application is shutting down...
2025-06-24 14:35:16 [DBG] Hosting stopping
2025-06-24 14:35:16 [DBG] Hosting stopped
2025-06-24 14:35:37 [INF] Application starting up
2025-06-24 14:35:37 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 14:35:37 [DBG] Hosting starting
2025-06-24 14:35:37 [INF] Now listening on: "http://localhost:5190"
2025-06-24 14:35:37 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 14:35:37 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 14:35:37 [INF] Hosting environment: "Development"
2025-06-24 14:35:37 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 14:35:37 [DBG] Hosting started
2025-06-24 14:35:44 [DBG] Connection id ""0HNDJ4G2GU3GT"" accepted.
2025-06-24 14:35:44 [DBG] Connection id ""0HNDJ4G2GU3GT"" started.
2025-06-24 14:35:44 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryBMCAWA7z1808hTq4" 491180
2025-06-24 14:35:44 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 14:35:44 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 14:35:44 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 14:35:44 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:35:44 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 14:35:44 [WRN] Failed to determine the https port for redirect.
2025-06-24 14:35:44 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:35:44 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 14:35:44 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 14:35:44 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 14:35:44 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 14:35:44 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 14:35:44 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 14:35:44 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 14:35:44 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 14:35:44 [INF] Tesseract engine initialized successfully
2025-06-24 14:35:44 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 14:35:44 [DBG] Connection id ""0HNDJ4G2GU3GT"", Request id ""0HNDJ4G2GU3GT:00000001"": started reading request body.
2025-06-24 14:35:44 [DBG] Connection id ""0HNDJ4G2GU3GT"", Request id ""0HNDJ4G2GU3GT:00000001"": done reading request body.
2025-06-24 14:35:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 14:35:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 14:35:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:35:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:35:44 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 14:35:44 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 14:35:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 14:35:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 14:35:44 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:35:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:35:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:35:44 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 14:35:44 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 14:35:44 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:35:44 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-24 14:35:45 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 14:35:45 [DBG] Processing page 1/1
2025-06-24 14:35:46 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-24 14:35:48 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-24 14:35:48 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-24 14:35:48 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 14:35:48 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:35:48 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:35:48 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 14:35:48 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 14:35:48 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 14:35:48 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 14:35:48 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes"]
2025-06-24 14:35:48 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-06-24 14:35:48 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-24 14:35:48 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 14:35:48 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 14:35:48 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 14:35:48 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 14:35:48 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 14:35:48 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 14:35:48 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 14:35:48 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 14:35:48 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4487.6967ms
2025-06-24 14:35:48 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 14:35:48 [DBG] Connection id ""0HNDJ4G2GU3GT"" completed keep alive response.
2025-06-24 14:35:48 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 14:35:48 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4560.2373ms
2025-06-24 14:37:22 [DBG] Connection id ""0HNDJ4G2GU3GT"" received FIN.
2025-06-24 14:37:22 [DBG] Connection id ""0HNDJ4G2GU3GT"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 14:37:22 [DBG] Connection id ""0HNDJ4G2GU3GT"" disconnecting.
2025-06-24 14:37:22 [DBG] Connection id ""0HNDJ4G2GU3GT"" stopped.
2025-06-24 14:49:18 [DBG] Connection id ""0HNDJ4G2GU3GU"" accepted.
2025-06-24 14:49:18 [DBG] Connection id ""0HNDJ4G2GU3GU"" started.
2025-06-24 14:49:18 [DBG] Connection id ""0HNDJ4G2GU3GV"" accepted.
2025-06-24 14:49:18 [DBG] Connection id ""0HNDJ4G2GU3GV"" started.
2025-06-24 14:49:18 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 14:49:18 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 14:49:18 [DBG] Request did not match any endpoints
2025-06-24 14:49:18 [DBG] Connection id ""0HNDJ4G2GU3GU"" completed keep alive response.
2025-06-24 14:49:18 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 42.2949ms
2025-06-24 14:49:18 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 14:49:18 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 14:49:18 [DBG] Request did not match any endpoints
2025-06-24 14:49:18 [DBG] Connection id ""0HNDJ4G2GU3GU"" completed keep alive response.
2025-06-24 14:49:18 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 91.4771ms
2025-06-24 14:50:39 [DBG] Connection id ""0HNDJ4G2GU3GV"" received FIN.
2025-06-24 14:50:39 [DBG] Connection id ""0HNDJ4G2GU3GV"" disconnecting.
2025-06-24 14:50:39 [DBG] Connection id ""0HNDJ4G2GU3GV"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 14:50:39 [DBG] Connection id ""0HNDJ4G2GU3GV"" stopped.
2025-06-24 14:51:29 [DBG] Connection id ""0HNDJ4G2GU3GU"" disconnecting.
2025-06-24 14:51:29 [DBG] Connection id ""0HNDJ4G2GU3GU"" stopped.
2025-06-24 14:51:29 [DBG] Connection id ""0HNDJ4G2GU3GU"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 15:00:16 [DBG] Connection id ""0HNDJ4G2GU3H0"" accepted.
2025-06-24 15:00:16 [DBG] Connection id ""0HNDJ4G2GU3H0"" started.
2025-06-24 15:00:16 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarywQABfADAar80b0kk" 284721
2025-06-24 15:00:16 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-24 15:00:16 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-24 15:00:16 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 15:00:16 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 15:00:16 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 15:00:16 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 15:00:16 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 15:00:16 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 15:00:16 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 15:00:16 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 15:00:16 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 15:00:16 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 15:00:16 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 15:00:16 [INF] Tesseract engine initialized successfully
2025-06-24 15:00:16 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 15:00:16 [DBG] Connection id ""0HNDJ4G2GU3H0"", Request id ""0HNDJ4G2GU3H0:00000001"": started reading request body.
2025-06-24 15:00:16 [DBG] Connection id ""0HNDJ4G2GU3H0"", Request id ""0HNDJ4G2GU3H0:00000001"": done reading request body.
2025-06-24 15:00:16 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 15:00:16 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-24 15:00:16 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 15:00:16 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 15:00:16 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-24 15:00:16 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-24 15:00:16 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 15:00:16 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 15:00:16 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:00:16 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:00:16 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:00:16 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 15:00:16 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:00:16 [INF] Step 1: Starting OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 15:00:16 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 15:00:17 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:00:17 [DBG] Processing page 1/1
2025-06-24 15:00:18 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 15:00:19 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 15:00:19 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 15:00:19 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 15:00:19 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 15:00:19 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 15:00:19 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:00:19 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:00:19 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:00:19 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:00:19 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 15:00:19 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 15:00:19 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 15:00:19 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Récépissé", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-06-24 15:00:19 [WRN] Validation issues for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 15:00:19 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 15:00:19 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 15:00:19 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 15:00:19 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 15:00:19 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 15:00:19 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 15:00:19 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 15:00:19 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 15:00:19 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2864.9312ms
2025-06-24 15:00:19 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-24 15:00:19 [DBG] Connection id ""0HNDJ4G2GU3H0"" completed keep alive response.
2025-06-24 15:00:19 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 15:00:19 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2890.895ms
2025-06-24 15:02:30 [DBG] Connection id ""0HNDJ4G2GU3H0"" disconnecting.
2025-06-24 15:02:30 [DBG] Connection id ""0HNDJ4G2GU3H0"" stopped.
2025-06-24 15:02:30 [DBG] Connection id ""0HNDJ4G2GU3H0"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" accepted.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" started.
2025-06-24 15:05:55 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract-batch""" - "multipart/form-data; boundary=----WebKitFormBoundaryBeD8Oigot6S2jK8E" 3396663
2025-06-24 15:05:55 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract-batch"'
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" paused.
2025-06-24 15:05:55 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract-batch"' is valid for the request path '"/api/Metadata/extract-batch"'
2025-06-24 15:05:55 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"'
2025-06-24 15:05:55 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 15:05:55 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"'
2025-06-24 15:05:55 [INF] Route matched with "{action = \"ExtractMetadataFromMultipleFiles\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromMultipleFiles(System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 15:05:55 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 15:05:55 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 15:05:55 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 15:05:55 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 15:05:55 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 15:05:55 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 15:05:55 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 15:05:55 [INF] Tesseract engine initialized successfully
2025-06-24 15:05:55 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"", Request id ""0HNDJ4G2GU3H1:00000001"": started reading request body.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" resumed.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" paused.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" resumed.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" paused.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"" resumed.
2025-06-24 15:05:55 [DBG] Connection id ""0HNDJ4G2GU3H1"", Request id ""0HNDJ4G2GU3H1:00000001"": done reading request body.
2025-06-24 15:05:55 [DBG] Attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"' ...
2025-06-24 15:05:55 [DBG] Attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"' using the name '"files"' in request data ...
2025-06-24 15:05:55 [DBG] Done attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"'.
2025-06-24 15:05:55 [DBG] Done attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"'.
2025-06-24 15:05:55 [DBG] Attempting to validate the bound parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"' ...
2025-06-24 15:05:55 [DBG] Done attempting to validate the bound parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"'.
2025-06-24 15:05:55 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 15:05:55 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 15:05:55 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:05:55 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:05:55 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:05:55 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 15:05:55 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:05:55 [INF] Starting PDF OCR processing for 479169 bytes
2025-06-24 15:05:55 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-24 15:05:55 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 15:05:55 [INF] Starting PDF OCR processing for 942540 bytes
2025-06-24 15:05:55 [INF] Starting PDF OCR processing for 1198568 bytes
2025-06-24 15:05:57 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:05:57 [DBG] Processing page 1/1
2025-06-24 15:05:58 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:05:58 [DBG] Processing page 1/1
2025-06-24 15:05:58 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:05:58 [DBG] Processing page 1/1
2025-06-24 15:05:59 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 15:05:59 [INF] PDF processed successfully. Processing 2 pages
2025-06-24 15:05:59 [DBG] Processing page 1/2
2025-06-24 15:05:59 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-24 15:05:59 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:05:59 [WRN] No text extracted from page 1
2025-06-24 15:05:59 [INF] PDF processing completed. Successfully processed 0/1 pages
2025-06-24 15:05:59 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 15:05:59 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 15:05:59 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 15:05:59 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 15:05:59 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:05:59 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes"]
2025-06-24 15:05:59 [WRN] Validation failed for document type CarteContribuabledValide: "Critical field 'NiuNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-06-24 15:05:59 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 2, Is filtered: True
2025-06-24 15:06:00 [INF] PDF processed successfully. Processing 2 pages
2025-06-24 15:06:00 [DBG] Processing page 1/2
2025-06-24 15:06:00 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-06-24 15:06:00 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:06:00 [WRN] No text extracted from page 1
2025-06-24 15:06:00 [INF] PDF processing completed. Successfully processed 0/1 pages
2025-06-24 15:06:00 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-24 15:06:00 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-24 15:06:00 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-24 15:06:00 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-24 15:06:00 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:06:00 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates, RawText"]
2025-06-24 15:06:00 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-06-24 15:06:00 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 3, Is filtered: True
2025-06-24 15:06:00 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 15:06:00 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 15:06:00 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 15:06:00 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 15:06:00 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:06:00 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:06:00 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:06:00 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:06:00 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-06-24 15:06:00 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 15:06:00 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-06-24 15:06:01 [DBG] Starting OCR processing on image data of 3961667 bytes
2025-06-24 15:06:01 [DBG] Starting OCR processing on image data of 3920374 bytes
2025-06-24 15:06:01 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:06:01 [WRN] No text extracted from page 1
2025-06-24 15:06:01 [DBG] Processing page 2/2
2025-06-24 15:06:03 [DBG] Starting OCR processing on image data of 4085823 bytes
2025-06-24 15:06:03 [INF] OCR completed successfully. Confidence: 0.66%, Text length: 1029 characters
2025-06-24 15:06:03 [WRN] Low OCR confidence detected: 0.66%. Text quality may be poor
2025-06-24 15:06:03 [DBG] Processing page 2/2
2025-06-24 15:06:04 [DBG] Starting OCR processing on image data of 2338997 bytes
2025-06-24 15:06:04 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:06:04 [WRN] No text extracted from page 2
2025-06-24 15:06:04 [INF] PDF processing completed. Successfully processed 1/2 pages
2025-06-24 15:06:04 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-24 15:06:04 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-24 15:06:04 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-24 15:06:04 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-24 15:06:04 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:06:04 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses, RawText"]
2025-06-24 15:06:04 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'BusinessNames' is missing or empty, Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 15:06:04 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 4, Is filtered: True
2025-06-24 15:06:06 [INF] OCR completed successfully. Confidence: 0.61%, Text length: 2093 characters
2025-06-24 15:06:06 [WRN] Low OCR confidence detected: 0.61%. Text quality may be poor
2025-06-24 15:06:06 [INF] PDF processing completed. Successfully processed 1/2 pages
2025-06-24 15:06:06 [INF] Starting metadata extraction from raw text for file '"REGISTRECOMMERCE_20250529121955.pdf"'.
2025-06-24 15:06:06 [DBG] Normalized file name: '"registrecommerce20250529121955"' from original: '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-06-24 15:06:06 [INF] Detected document type 'RegistreCommerce' for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-06-24 15:06:06 [INF] Detected document type: RegistreCommerce for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-06-24 15:06:06 [DBG] Full metadata extraction completed. Found 0 NIU(s), 1 RCCM(s), 2 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:06:06 [INF] Filtered metadata for document type 'RegistreCommerce'. Allowed fields: ["DocumentName, DocumentType, RccmNumbers, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, RegistrationDates, DeliveredDates, CompanyDuration, TribunalNames, ActivityCodes, Quarters, PhoneNumbers, EmailAddresses, RawText"]
2025-06-24 15:06:06 [INF] Metadata extraction completed for '"REGISTRECOMMERCE_20250529121955.pdf"'. Document type: RegistreCommerce, Extracted fields: 7, Is filtered: True
2025-06-24 15:06:06 [INF] Batch processing completed. Total Files: 5, Processed: 5, Successful: 1, Failed/Skipped: 4
2025-06-24 15:06:06 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 15:06:06 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 15:06:06 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 15:06:06 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 15:06:06 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 15:06:06 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 15:06:06 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType2`2[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType3`4[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 15:06:06 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)" in 10569.8729ms
2025-06-24 15:06:06 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"'
2025-06-24 15:06:06 [DBG] Connection id ""0HNDJ4G2GU3H1"" completed keep alive response.
2025-06-24 15:06:06 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 15:06:06 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract-batch""" - 200 null "application/json; charset=utf-8" 10605.737ms
2025-06-24 15:08:17 [DBG] Connection id ""0HNDJ4G2GU3H1"" disconnecting.
2025-06-24 15:08:17 [DBG] Connection id ""0HNDJ4G2GU3H1"" stopped.
2025-06-24 15:08:17 [DBG] Connection id ""0HNDJ4G2GU3H1"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 15:08:30 [INF] Application is shutting down...
2025-06-24 15:08:30 [DBG] Hosting stopping
2025-06-24 15:08:30 [DBG] Hosting stopped
2025-06-24 15:08:56 [INF] Application starting up
2025-06-24 15:08:56 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-24 15:08:56 [DBG] Hosting starting
2025-06-24 15:08:57 [INF] Now listening on: "http://localhost:5190"
2025-06-24 15:08:57 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-24 15:08:57 [INF] Application started. Press Ctrl+C to shut down.
2025-06-24 15:08:57 [INF] Hosting environment: "Development"
2025-06-24 15:08:57 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-24 15:08:57 [DBG] Hosting started
2025-06-24 15:09:02 [DBG] Connection id ""0HNDJ52M0K30S"" accepted.
2025-06-24 15:09:02 [DBG] Connection id ""0HNDJ52M0K30S"" started.
2025-06-24 15:09:02 [DBG] Connection id ""0HNDJ52M0K30T"" accepted.
2025-06-24 15:09:02 [DBG] Connection id ""0HNDJ52M0K30T"" started.
2025-06-24 15:09:02 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-24 15:09:02 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-24 15:09:02 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-24 15:09:02 [DBG] Request did not match any endpoints
2025-06-24 15:09:02 [DBG] Connection id ""0HNDJ52M0K30S"" completed keep alive response.
2025-06-24 15:09:02 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 78.3654ms
2025-06-24 15:09:02 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-24 15:09:02 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-24 15:09:02 [DBG] Request did not match any endpoints
2025-06-24 15:09:02 [DBG] Connection id ""0HNDJ52M0K30S"" completed keep alive response.
2025-06-24 15:09:02 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 75.9078ms
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30T"" received FIN.
2025-06-24 15:10:06 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract-batch""" - "multipart/form-data; boundary=----WebKitFormBoundaryPwtHEB0NRHnBBfEL" 3396663
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"" paused.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30T"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 15:10:06 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract-batch"'
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30T"" disconnecting.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30T"" stopped.
2025-06-24 15:10:06 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract-batch"' is valid for the request path '"/api/Metadata/extract-batch"'
2025-06-24 15:10:06 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"'
2025-06-24 15:10:06 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-24 15:10:06 [WRN] Failed to determine the https port for redirect.
2025-06-24 15:10:06 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"'
2025-06-24 15:10:06 [INF] Route matched with "{action = \"ExtractMetadataFromMultipleFiles\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromMultipleFiles(System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile], System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-24 15:10:06 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-24 15:10:06 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-24 15:10:06 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-24 15:10:06 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-24 15:10:06 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-24 15:10:06 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 15:10:06 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-24 15:10:06 [INF] Tesseract engine initialized successfully
2025-06-24 15:10:06 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"", Request id ""0HNDJ52M0K30S:00000003"": started reading request body.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"" resumed.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"" paused.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"" resumed.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"" paused.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"" resumed.
2025-06-24 15:10:06 [DBG] Connection id ""0HNDJ52M0K30S"", Request id ""0HNDJ52M0K30S:00000003"": done reading request body.
2025-06-24 15:10:06 [DBG] Attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"' ...
2025-06-24 15:10:06 [DBG] Attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"' using the name '"files"' in request data ...
2025-06-24 15:10:06 [DBG] Done attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"'.
2025-06-24 15:10:06 [DBG] Done attempting to bind parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"'.
2025-06-24 15:10:06 [DBG] Attempting to validate the bound parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"' ...
2025-06-24 15:10:06 [DBG] Done attempting to validate the bound parameter '"files"' of type '"System.Collections.Generic.List`1[Microsoft.AspNetCore.Http.IFormFile]"'.
2025-06-24 15:10:06 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-24 15:10:06 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-24 15:10:06 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:10:06 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:10:06 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:10:06 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-24 15:10:06 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-24 15:10:06 [INF] Starting PDF OCR processing for 1198568 bytes
2025-06-24 15:10:06 [INF] Starting PDF OCR processing for 284504 bytes
2025-06-24 15:10:06 [INF] Starting PDF OCR processing for 479169 bytes
2025-06-24 15:10:06 [INF] Starting PDF OCR processing for 942540 bytes
2025-06-24 15:10:06 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-24 15:10:07 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:10:07 [DBG] Processing page 1/1
2025-06-24 15:10:07 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:10:07 [DBG] Processing page 1/1
2025-06-24 15:10:07 [INF] PDF processed successfully. Processing 1 pages
2025-06-24 15:10:07 [DBG] Processing page 1/1
2025-06-24 15:10:08 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-06-24 15:10:08 [INF] PDF processed successfully. Processing 2 pages
2025-06-24 15:10:08 [DBG] Processing page 1/2
2025-06-24 15:10:08 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-24 15:10:09 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:10:09 [WRN] No text extracted from page 1
2025-06-24 15:10:09 [INF] PDF processing completed. Successfully processed 0/1 pages
2025-06-24 15:10:09 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-24 15:10:09 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 15:10:09 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 15:10:09 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-24 15:10:09 [INF] PDF processed successfully. Processing 2 pages
2025-06-24 15:10:09 [DBG] Processing page 1/2
2025-06-24 15:10:09 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:10:09 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes"]
2025-06-24 15:10:09 [WRN] Validation failed for document type CarteContribuabledValide: "Critical field 'NiuNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-06-24 15:10:09 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 2, Is filtered: True
2025-06-24 15:10:09 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-06-24 15:10:09 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-06-24 15:10:09 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-06-24 15:10:09 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 15:10:09 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-06-24 15:10:09 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:10:09 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:10:09 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-06-24 15:10:09 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:10:09 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates"]
2025-06-24 15:10:09 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 15:10:09 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 3, Is filtered: True
2025-06-24 15:10:10 [DBG] Starting OCR processing on image data of 3961667 bytes
2025-06-24 15:10:10 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:10:10 [WRN] No text extracted from page 1
2025-06-24 15:10:10 [DBG] Processing page 2/2
2025-06-24 15:10:10 [DBG] Starting OCR processing on image data of 3920374 bytes
2025-06-24 15:10:10 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:10:10 [WRN] No text extracted from page 1
2025-06-24 15:10:10 [DBG] Processing page 2/2
2025-06-24 15:10:11 [DBG] Starting OCR processing on image data of 2338997 bytes
2025-06-24 15:10:11 [ERR] Error during Tesseract OCR processing
System.InvalidOperationException: Only one image can be processed at once. Please make sure you dispose of the page once your finished with it.
   at Tesseract.TesseractEngine.Process(Pix image, String inputName, Rect region, Nullable`1 pageSegMode)
   at Tesseract.TesseractEngine.Process(Pix image, Nullable`1 pageSegMode)
   at ImageOcrMicroservice.Services.OcrService.PerformOcrOnImage(Byte[] imageBytes) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\OcrService.cs:line 42
2025-06-24 15:10:11 [WRN] No text extracted from page 2
2025-06-24 15:10:11 [INF] PDF processing completed. Successfully processed 0/2 pages
2025-06-24 15:10:11 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-24 15:10:11 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-24 15:10:11 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-24 15:10:11 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-24 15:10:11 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:10:11 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses"]
2025-06-24 15:10:11 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'BusinessNames' is missing or empty, Critical field 'RegistrationNumbers' is missing or empty"
2025-06-24 15:10:11 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 2, Is filtered: True
2025-06-24 15:10:11 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-06-24 15:10:11 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-24 15:10:11 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-24 15:10:11 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-24 15:10:11 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-24 15:10:11 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-24 15:10:11 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-24 15:10:11 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-06-24 15:10:11 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-06-24 15:10:11 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-24 15:10:11 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 8, Is filtered: True
2025-06-24 15:10:12 [DBG] Starting OCR processing on image data of 4085823 bytes
2025-06-24 15:10:15 [INF] OCR completed successfully. Confidence: 0.61%, Text length: 2093 characters
2025-06-24 15:10:15 [WRN] Low OCR confidence detected: 0.61%. Text quality may be poor
2025-06-24 15:10:15 [INF] PDF processing completed. Successfully processed 1/2 pages
2025-06-24 15:10:15 [INF] Starting metadata extraction from raw text for file '"REGISTRECOMMERCE_20250529121955.pdf"'.
2025-06-24 15:10:15 [DBG] Normalized file name: '"registrecommerce20250529121955"' from original: '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-06-24 15:10:15 [INF] Detected document type 'RegistreCommerce' for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-06-24 15:10:15 [INF] Detected document type: RegistreCommerce for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-06-24 15:10:15 [DBG] Full metadata extraction completed. Found 0 NIU(s), 1 RCCM(s), 2 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-24 15:10:15 [INF] Filtered metadata for document type 'RegistreCommerce'. Allowed fields: ["DocumentName, DocumentType, RccmNumbers, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, RegistrationDates, DeliveredDates, CompanyDuration, TribunalNames, ActivityCodes, Quarters, PhoneNumbers, EmailAddresses"]
2025-06-24 15:10:15 [INF] Metadata extraction completed for '"REGISTRECOMMERCE_20250529121955.pdf"'. Document type: RegistreCommerce, Extracted fields: 6, Is filtered: True
2025-06-24 15:10:15 [INF] Batch processing completed. Total Files: 5, Processed: 5, Successful: 1, Failed/Skipped: 4
2025-06-24 15:10:15 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-24 15:10:15 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-24 15:10:15 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-24 15:10:15 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-24 15:10:15 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-24 15:10:15 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-24 15:10:15 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType2`2[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType3`4[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-24 15:10:15 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)" in 9103.4207ms
2025-06-24 15:10:15 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromMultipleFiles (DocumentProcessor.API)"'
2025-06-24 15:10:15 [DBG] Connection id ""0HNDJ52M0K30S"" completed keep alive response.
2025-06-24 15:10:15 [DBG] Disposing OcrService and Tesseract engine
2025-06-24 15:10:15 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract-batch""" - 200 null "application/json; charset=utf-8" 9163.3587ms
2025-06-24 15:12:25 [DBG] Connection id ""0HNDJ52M0K30S"" disconnecting.
2025-06-24 15:12:25 [DBG] Connection id ""0HNDJ52M0K30S"" stopped.
2025-06-24 15:12:25 [DBG] Connection id ""0HNDJ52M0K30S"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-24 15:19:40 [INF] Application is shutting down...
2025-06-24 15:19:40 [DBG] Hosting stopping
2025-06-24 15:19:40 [DBG] Hosting stopped
