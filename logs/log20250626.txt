2025-06-26 08:36:53 [INF] Application starting up
2025-06-26 08:36:53 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 08:36:53 [DBG] Hosting starting
2025-06-26 08:36:53 [INF] Now listening on: "http://localhost:5190"
2025-06-26 08:36:53 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 08:36:53 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 08:36:53 [INF] Hosting environment: "Development"
2025-06-26 08:36:53 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 08:36:53 [DBG] Hosting started
2025-06-26 08:37:18 [DBG] Connection id ""0HNDKGH3P8U24"" accepted.
2025-06-26 08:37:18 [DBG] Connection id ""0HNDKGH3P8U24"" started.
2025-06-26 08:37:18 [DBG] Connection id ""0HNDKGH3P8U25"" accepted.
2025-06-26 08:37:18 [DBG] Connection id ""0HNDKGH3P8U25"" started.
2025-06-26 08:37:18 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 08:37:18 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 08:37:18 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 08:37:18 [DBG] Request did not match any endpoints
2025-06-26 08:37:18 [DBG] Connection id ""0HNDKGH3P8U24"" completed keep alive response.
2025-06-26 08:37:18 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 131.944ms
2025-06-26 08:37:19 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 08:37:19 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 08:37:19 [DBG] Request did not match any endpoints
2025-06-26 08:37:19 [DBG] Connection id ""0HNDKGH3P8U24"" completed keep alive response.
2025-06-26 08:37:19 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 115.2875ms
2025-06-26 08:39:05 [DBG] Connection id ""0HNDKGH3P8U25"" received FIN.
2025-06-26 08:39:05 [DBG] Connection id ""0HNDKGH3P8U25"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 08:39:05 [DBG] Connection id ""0HNDKGH3P8U25"" disconnecting.
2025-06-26 08:39:05 [DBG] Connection id ""0HNDKGH3P8U25"" stopped.
2025-06-26 08:39:30 [DBG] Connection id ""0HNDKGH3P8U24"" disconnecting.
2025-06-26 08:39:30 [DBG] Connection id ""0HNDKGH3P8U24"" stopped.
2025-06-26 08:39:30 [DBG] Connection id ""0HNDKGH3P8U24"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 08:41:06 [INF] Application is shutting down...
2025-06-26 08:41:06 [DBG] Hosting stopping
2025-06-26 08:41:06 [DBG] Hosting stopped
2025-06-26 08:41:11 [INF] Application starting up
2025-06-26 08:41:12 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 08:41:12 [DBG] Hosting starting
2025-06-26 08:41:12 [INF] Now listening on: "http://localhost:5190"
2025-06-26 08:41:12 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 08:41:12 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 08:41:12 [INF] Hosting environment: "Development"
2025-06-26 08:41:12 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 08:41:12 [DBG] Hosting started
2025-06-26 08:41:17 [DBG] Connection id ""0HNDKGJB0V2TP"" accepted.
2025-06-26 08:41:17 [DBG] Connection id ""0HNDKGJB0V2TP"" started.
2025-06-26 08:41:17 [DBG] Connection id ""0HNDKGJB0V2TQ"" accepted.
2025-06-26 08:41:17 [DBG] Connection id ""0HNDKGJB0V2TQ"" started.
2025-06-26 08:41:17 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 08:41:17 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 08:41:17 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 08:41:17 [DBG] Request did not match any endpoints
2025-06-26 08:41:17 [DBG] Connection id ""0HNDKGJB0V2TP"" completed keep alive response.
2025-06-26 08:41:17 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 82.7264ms
2025-06-26 08:41:18 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 08:41:18 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 08:41:18 [DBG] Request did not match any endpoints
2025-06-26 08:41:18 [DBG] Connection id ""0HNDKGJB0V2TP"" completed keep alive response.
2025-06-26 08:41:18 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 74.8872ms
2025-06-26 08:42:31 [DBG] Connection id ""0HNDKGJB0V2TQ"" received FIN.
2025-06-26 08:42:31 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryNQD9jfxB4QjxBpdW" 479395
2025-06-26 08:42:31 [DBG] Connection id ""0HNDKGJB0V2TQ"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 08:42:31 [DBG] Connection id ""0HNDKGJB0V2TQ"" disconnecting.
2025-06-26 08:42:31 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 08:42:31 [DBG] Connection id ""0HNDKGJB0V2TQ"" stopped.
2025-06-26 08:42:31 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 08:42:31 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 08:42:31 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 08:42:31 [WRN] Failed to determine the https port for redirect.
2025-06-26 08:42:31 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 08:42:31 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 08:42:31 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 08:42:31 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 08:42:31 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 08:42:31 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 08:42:31 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 08:42:31 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 08:42:31 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 08:42:31 [INF] Tesseract engine initialized successfully
2025-06-26 08:42:31 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 08:42:31 [DBG] Connection id ""0HNDKGJB0V2TP"", Request id ""0HNDKGJB0V2TP:00000003"": started reading request body.
2025-06-26 08:42:31 [DBG] Connection id ""0HNDKGJB0V2TP"", Request id ""0HNDKGJB0V2TP:00000003"": done reading request body.
2025-06-26 08:42:31 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 08:42:31 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 08:42:31 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 08:42:31 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 08:42:31 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 08:42:31 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 08:42:31 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 08:42:31 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 08:42:31 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 08:42:31 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 08:42:31 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 08:42:31 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 08:42:31 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 08:42:31 [INF] Step 1: Starting OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 08:42:31 [INF] Starting PDF OCR processing for 479169 bytes
2025-06-26 08:42:33 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 08:42:33 [DBG] Processing page 1/1
2025-06-26 08:42:34 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-06-26 08:42:36 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-06-26 08:42:36 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 08:42:36 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 08:42:36 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 08:42:36 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 08:42:36 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 08:42:36 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 08:42:36 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 08:42:36 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-06-26 08:42:36 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-06-26 08:42:36 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 08:42:36 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 8, Is filtered: True
2025-06-26 08:42:36 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-06-26 08:42:36 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 08:42:36 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 08:42:36 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 08:42:36 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 08:42:36 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 08:42:36 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 08:42:36 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 08:42:36 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 08:42:36 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 08:42:36 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 5506.3519ms
2025-06-26 08:42:36 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 08:42:36 [DBG] Connection id ""0HNDKGJB0V2TP"" completed keep alive response.
2025-06-26 08:42:36 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 08:42:36 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 5578.1525ms
2025-06-26 08:44:47 [DBG] Connection id ""0HNDKGJB0V2TP"" disconnecting.
2025-06-26 08:44:47 [DBG] Connection id ""0HNDKGJB0V2TP"" stopped.
2025-06-26 08:44:47 [DBG] Connection id ""0HNDKGJB0V2TP"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:21:26 [INF] Application is shutting down...
2025-06-26 09:21:26 [DBG] Hosting stopping
2025-06-26 09:21:26 [DBG] Hosting stopped
2025-06-26 09:31:25 [INF] Application starting up
2025-06-26 09:31:25 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 09:31:25 [DBG] Hosting starting
2025-06-26 09:31:25 [INF] Now listening on: "http://localhost:5190"
2025-06-26 09:31:25 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 09:31:25 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 09:31:25 [INF] Hosting environment: "Development"
2025-06-26 09:31:25 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 09:31:25 [DBG] Hosting started
2025-06-26 09:31:30 [DBG] Connection id ""0HNDKHFCRGHHS"" accepted.
2025-06-26 09:31:30 [DBG] Connection id ""0HNDKHFCRGHHS"" started.
2025-06-26 09:31:30 [DBG] Connection id ""0HNDKHFCRGHHT"" accepted.
2025-06-26 09:31:30 [DBG] Connection id ""0HNDKHFCRGHHT"" started.
2025-06-26 09:31:30 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 09:31:30 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 09:31:30 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 09:31:30 [DBG] Request did not match any endpoints
2025-06-26 09:31:30 [DBG] Connection id ""0HNDKHFCRGHHS"" completed keep alive response.
2025-06-26 09:31:30 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 78.726ms
2025-06-26 09:31:30 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 09:31:30 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 09:31:30 [DBG] Request did not match any endpoints
2025-06-26 09:31:30 [DBG] Connection id ""0HNDKHFCRGHHS"" completed keep alive response.
2025-06-26 09:31:30 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 78.7283ms
2025-06-26 09:31:44 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryyNYBcEbfJgdBv3e8" 479395
2025-06-26 09:31:44 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:31:44 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:31:44 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:31:44 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:31:44 [WRN] Failed to determine the https port for redirect.
2025-06-26 09:31:44 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:31:44 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:31:44 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:31:44 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:31:44 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:31:44 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:31:44 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:31:44 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:31:44 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:31:44 [INF] Tesseract engine initialized successfully
2025-06-26 09:31:44 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:31:44 [DBG] Connection id ""0HNDKHFCRGHHS"", Request id ""0HNDKHFCRGHHS:00000003"": started reading request body.
2025-06-26 09:31:44 [DBG] Connection id ""0HNDKHFCRGHHS"", Request id ""0HNDKHFCRGHHS:00000003"": done reading request body.
2025-06-26 09:31:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:31:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:31:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:31:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:31:44 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:31:44 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:31:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:31:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:31:44 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:31:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:31:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:31:44 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:31:44 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:31:44 [INF] Step 1: Starting OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:31:44 [INF] Starting PDF OCR processing for 479169 bytes
2025-06-26 09:31:46 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 09:31:46 [DBG] Processing page 1/1
2025-06-26 09:31:47 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-06-26 09:31:49 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-06-26 09:31:49 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 09:31:49 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 09:31:49 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:31:49 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:31:49 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 09:31:49 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 09:31:49 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 09:31:49 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-06-26 09:31:49 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, CapitalAmounts, DocumentLocationsAndDates"]
2025-06-26 09:31:49 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 09:31:49 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 8, Is filtered: True
2025-06-26 09:31:49 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-06-26 09:31:49 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 09:31:49 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:31:49 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:31:49 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:31:49 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:31:49 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:31:49 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:31:49 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:31:49 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:31:49 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4868.1542ms
2025-06-26 09:31:49 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:31:49 [DBG] Connection id ""0HNDKHFCRGHHS"" completed keep alive response.
2025-06-26 09:31:49 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:31:49 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4931.1432ms
2025-06-26 09:33:41 [DBG] Connection id ""0HNDKHFCRGHHT"" disconnecting.
2025-06-26 09:33:41 [DBG] Connection id ""0HNDKHFCRGHHT"" stopped.
2025-06-26 09:33:41 [DBG] Connection id ""0HNDKHFCRGHHT"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:34:00 [DBG] Connection id ""0HNDKHFCRGHHS"" disconnecting.
2025-06-26 09:34:00 [DBG] Connection id ""0HNDKHFCRGHHS"" stopped.
2025-06-26 09:34:00 [DBG] Connection id ""0HNDKHFCRGHHS"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:35:36 [INF] Application is shutting down...
2025-06-26 09:35:36 [DBG] Hosting stopping
2025-06-26 09:35:36 [DBG] Hosting stopped
2025-06-26 09:35:40 [INF] Application starting up
2025-06-26 09:35:40 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 09:35:40 [DBG] Hosting starting
2025-06-26 09:35:40 [INF] Now listening on: "http://localhost:5190"
2025-06-26 09:35:40 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 09:35:40 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 09:35:40 [INF] Hosting environment: "Development"
2025-06-26 09:35:40 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 09:35:40 [DBG] Hosting started
2025-06-26 09:35:50 [DBG] Connection id ""0HNDKHHQEPM2P"" accepted.
2025-06-26 09:35:50 [DBG] Connection id ""0HNDKHHQEPM2P"" started.
2025-06-26 09:35:50 [DBG] Connection id ""0HNDKHHQEPM2Q"" accepted.
2025-06-26 09:35:50 [DBG] Connection id ""0HNDKHHQEPM2Q"" started.
2025-06-26 09:35:50 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 09:35:50 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 09:35:50 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 09:35:50 [DBG] Request did not match any endpoints
2025-06-26 09:35:50 [DBG] Connection id ""0HNDKHHQEPM2P"" completed keep alive response.
2025-06-26 09:35:50 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 84.4335ms
2025-06-26 09:35:51 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 09:35:51 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 09:35:51 [DBG] Request did not match any endpoints
2025-06-26 09:35:51 [DBG] Connection id ""0HNDKHHQEPM2P"" completed keep alive response.
2025-06-26 09:35:51 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 97.0119ms
2025-06-26 09:36:03 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarye6In8drbzSQTCyKS" 479395
2025-06-26 09:36:03 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:36:03 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:36:03 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:36:03 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:36:03 [WRN] Failed to determine the https port for redirect.
2025-06-26 09:36:03 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:36:03 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:36:03 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:36:03 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:36:03 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:36:03 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:36:03 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:36:03 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:36:03 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:36:03 [INF] Tesseract engine initialized successfully
2025-06-26 09:36:03 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:36:03 [DBG] Connection id ""0HNDKHHQEPM2P"", Request id ""0HNDKHHQEPM2P:00000003"": started reading request body.
2025-06-26 09:36:03 [DBG] Connection id ""0HNDKHHQEPM2P"", Request id ""0HNDKHHQEPM2P:00000003"": done reading request body.
2025-06-26 09:36:03 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:36:03 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:36:03 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:36:03 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:36:03 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:36:03 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:36:03 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:36:03 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:36:03 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:36:03 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:36:03 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:36:03 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:36:03 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:36:03 [INF] Step 1: Starting OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:36:03 [INF] Starting PDF OCR processing for 479169 bytes
2025-06-26 09:36:05 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 09:36:05 [DBG] Processing page 1/1
2025-06-26 09:36:06 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-06-26 09:36:08 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-06-26 09:36:08 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 09:36:08 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 09:36:08 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:36:08 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:36:08 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 09:36:08 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 09:36:08 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 09:36:08 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-06-26 09:36:08 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-06-26 09:36:08 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 09:36:08 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-06-26 09:36:08 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-06-26 09:36:08 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 09:36:08 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 09:36:08 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:36:08 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:36:08 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:36:08 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:36:08 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:36:08 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:36:08 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:36:08 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4694.143ms
2025-06-26 09:36:08 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:36:08 [DBG] Connection id ""0HNDKHHQEPM2P"" completed keep alive response.
2025-06-26 09:36:08 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:36:08 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4758.0888ms
2025-06-26 09:38:01 [DBG] Connection id ""0HNDKHHQEPM2Q"" disconnecting.
2025-06-26 09:38:01 [DBG] Connection id ""0HNDKHHQEPM2Q"" stopped.
2025-06-26 09:38:01 [DBG] Connection id ""0HNDKHHQEPM2Q"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:38:18 [DBG] Connection id ""0HNDKHHQEPM2P"" disconnecting.
2025-06-26 09:38:18 [DBG] Connection id ""0HNDKHHQEPM2P"" stopped.
2025-06-26 09:38:18 [DBG] Connection id ""0HNDKHHQEPM2P"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:39:33 [DBG] Connection id ""0HNDKHHQEPM2R"" accepted.
2025-06-26 09:39:33 [DBG] Connection id ""0HNDKHHQEPM2R"" started.
2025-06-26 09:39:33 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundary7aGnSCmhx18eSceY" 491180
2025-06-26 09:39:33 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:39:33 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:39:33 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:39:33 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:39:33 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:39:33 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:39:33 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:39:33 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:39:33 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:39:33 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:39:33 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:39:33 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:39:33 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:39:33 [INF] Tesseract engine initialized successfully
2025-06-26 09:39:33 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:39:33 [DBG] Connection id ""0HNDKHHQEPM2R"", Request id ""0HNDKHHQEPM2R:00000001"": started reading request body.
2025-06-26 09:39:33 [DBG] Connection id ""0HNDKHHQEPM2R"", Request id ""0HNDKHHQEPM2R:00000001"": done reading request body.
2025-06-26 09:39:33 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:39:33 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:39:33 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:39:33 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:39:33 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:39:33 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:39:33 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:39:33 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:39:33 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:39:33 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:39:33 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:39:33 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:39:33 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:39:33 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:39:33 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-26 09:39:34 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 09:39:34 [DBG] Processing page 1/1
2025-06-26 09:39:35 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-26 09:39:37 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-26 09:39:37 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 09:39:37 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 09:39:37 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:39:37 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:39:37 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:39:37 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:39:37 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:39:37 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 09:39:37 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes"]
2025-06-26 09:39:37 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-06-26 09:39:37 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-26 09:39:37 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:39:37 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:39:37 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:39:37 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:39:37 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:39:37 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:39:37 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:39:37 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:39:37 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4272.374ms
2025-06-26 09:39:37 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:39:37 [DBG] Connection id ""0HNDKHHQEPM2R"" completed keep alive response.
2025-06-26 09:39:37 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:39:37 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4300.447ms
2025-06-26 09:41:49 [DBG] Connection id ""0HNDKHHQEPM2R"" disconnecting.
2025-06-26 09:41:49 [DBG] Connection id ""0HNDKHHQEPM2R"" stopped.
2025-06-26 09:41:49 [DBG] Connection id ""0HNDKHHQEPM2R"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:42:01 [DBG] Connection id ""0HNDKHHQEPM2S"" accepted.
2025-06-26 09:42:01 [DBG] Connection id ""0HNDKHHQEPM2S"" started.
2025-06-26 09:42:01 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryaQzs5NBxGZ24GkPO" 491180
2025-06-26 09:42:01 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:42:01 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:42:01 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:01 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:42:01 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:01 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:42:01 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:42:01 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:42:01 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:42:01 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:42:01 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:42:01 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:42:01 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:42:01 [INF] Tesseract engine initialized successfully
2025-06-26 09:42:01 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:42:01 [DBG] Connection id ""0HNDKHHQEPM2S"", Request id ""0HNDKHHQEPM2S:00000001"": started reading request body.
2025-06-26 09:42:01 [DBG] Connection id ""0HNDKHHQEPM2S"", Request id ""0HNDKHHQEPM2S:00000001"": done reading request body.
2025-06-26 09:42:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:42:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:42:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:01 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:42:01 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:42:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:42:01 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:01 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:42:01 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:01 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:01 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-26 09:42:02 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 09:42:02 [DBG] Processing page 1/1
2025-06-26 09:42:03 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-26 09:42:05 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-26 09:42:05 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 09:42:05 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 09:42:05 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:05 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:05 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:05 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:05 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:05 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 09:42:05 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes"]
2025-06-26 09:42:05 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-06-26 09:42:05 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-26 09:42:05 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:05 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:42:05 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:42:05 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:42:05 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:42:05 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:42:05 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:42:05 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:42:05 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4043.4751ms
2025-06-26 09:42:05 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:05 [DBG] Connection id ""0HNDKHHQEPM2S"" completed keep alive response.
2025-06-26 09:42:05 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:42:05 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4073.6373ms
2025-06-26 09:42:10 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryTNJQE5GwN3zUChAT" 491180
2025-06-26 09:42:10 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:42:10 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:42:10 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:10 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:42:10 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:10 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:42:10 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:42:10 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:42:10 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:42:10 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:42:10 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:42:10 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:42:10 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:42:10 [INF] Tesseract engine initialized successfully
2025-06-26 09:42:10 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:42:10 [DBG] Connection id ""0HNDKHHQEPM2S"", Request id ""0HNDKHHQEPM2S:00000002"": started reading request body.
2025-06-26 09:42:10 [DBG] Connection id ""0HNDKHHQEPM2S"", Request id ""0HNDKHHQEPM2S:00000002"": done reading request body.
2025-06-26 09:42:10 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:42:10 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:42:10 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:10 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:10 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:42:10 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:10 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:42:10 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:42:10 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:10 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:10 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:10 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:42:10 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:10 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:10 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-26 09:42:11 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 09:42:11 [DBG] Processing page 1/1
2025-06-26 09:42:12 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-26 09:42:14 [INF] Application is shutting down...
2025-06-26 09:42:14 [DBG] Hosting stopping
2025-06-26 09:42:14 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-26 09:42:14 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 09:42:14 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 09:42:14 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:14 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:14 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:14 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:14 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:14 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 09:42:14 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes"]
2025-06-26 09:42:14 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-06-26 09:42:14 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-26 09:42:14 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:14 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:42:14 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:42:14 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:42:14 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:42:14 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:42:14 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:42:14 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:42:14 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4036.6858ms
2025-06-26 09:42:14 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:14 [DBG] Connection id ""0HNDKHHQEPM2S"" received FIN.
2025-06-26 09:42:14 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:42:14 [DBG] Connection id ""0HNDKHHQEPM2S"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 09:42:14 [DBG] Connection id ""0HNDKHHQEPM2S"" disconnecting.
2025-06-26 09:42:14 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4063.9148ms
2025-06-26 09:42:14 [DBG] Connection id ""0HNDKHHQEPM2S"" stopped.
2025-06-26 09:42:14 [DBG] Hosting stopped
2025-06-26 09:42:18 [INF] Application starting up
2025-06-26 09:42:18 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 09:42:18 [DBG] Hosting starting
2025-06-26 09:42:18 [INF] Now listening on: "http://localhost:5190"
2025-06-26 09:42:18 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 09:42:18 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 09:42:18 [INF] Hosting environment: "Development"
2025-06-26 09:42:18 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 09:42:18 [DBG] Hosting started
2025-06-26 09:42:27 [DBG] Connection id ""0HNDKHLGJPC1L"" accepted.
2025-06-26 09:42:27 [DBG] Connection id ""0HNDKHLGJPC1L"" started.
2025-06-26 09:42:27 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryvg0XOjO5JN0tfLVQ" 491180
2025-06-26 09:42:27 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 09:42:27 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:42:27 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:42:27 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:27 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:42:27 [WRN] Failed to determine the https port for redirect.
2025-06-26 09:42:27 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:27 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:42:27 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:42:27 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:42:27 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:42:27 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:42:27 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:42:27 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:42:27 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:42:27 [INF] Tesseract engine initialized successfully
2025-06-26 09:42:27 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:42:27 [DBG] Connection id ""0HNDKHLGJPC1L"", Request id ""0HNDKHLGJPC1L:00000001"": started reading request body.
2025-06-26 09:42:27 [DBG] Connection id ""0HNDKHLGJPC1L"", Request id ""0HNDKHLGJPC1L:00000001"": done reading request body.
2025-06-26 09:42:27 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:42:27 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:42:27 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:27 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:27 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:42:27 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:42:27 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:42:27 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:42:27 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:27 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:27 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:27 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:42:27 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:42:27 [INF] Step 1: Starting OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:27 [INF] Starting PDF OCR processing for 490959 bytes
2025-06-26 09:42:28 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 09:42:28 [DBG] Processing page 1/1
2025-06-26 09:42:29 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-06-26 09:42:31 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-06-26 09:42:31 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 09:42:31 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 09:42:31 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:31 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:31 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:31 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:31 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-06-26 09:42:31 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 09:42:31 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems"]
2025-06-26 09:42:31 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-06-26 09:42:31 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-26 09:42:31 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-06-26 09:42:31 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:42:31 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:42:31 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:42:31 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:42:31 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:42:31 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:42:31 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:42:31 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4343.1085ms
2025-06-26 09:42:31 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:42:31 [DBG] Connection id ""0HNDKHLGJPC1L"" completed keep alive response.
2025-06-26 09:42:31 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:42:31 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4418.0852ms
2025-06-26 09:43:48 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryKoXu4qr7nWfYeshz" 942756
2025-06-26 09:43:48 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 09:43:48 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 09:43:48 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:43:48 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 09:43:48 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:43:48 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 09:43:48 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 09:43:48 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 09:43:48 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 09:43:48 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 09:43:48 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 09:43:48 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:43:48 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 09:43:48 [INF] Tesseract engine initialized successfully
2025-06-26 09:43:48 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 09:43:48 [DBG] Connection id ""0HNDKHLGJPC1L"", Request id ""0HNDKHLGJPC1L:00000002"": started reading request body.
2025-06-26 09:43:48 [DBG] Connection id ""0HNDKHLGJPC1L"", Request id ""0HNDKHLGJPC1L:00000002"": done reading request body.
2025-06-26 09:43:48 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:43:48 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 09:43:48 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:43:48 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:43:48 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 09:43:48 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 09:43:48 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:43:48 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 09:43:48 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:43:48 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:43:48 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:43:48 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 09:43:48 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 09:43:48 [INF] Step 1: Starting OCR process for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 09:43:48 [INF] Starting PDF OCR processing for 942540 bytes
2025-06-26 09:43:50 [INF] PDF processed successfully. Processing 2 pages
2025-06-26 09:43:50 [DBG] Processing page 1/2
2025-06-26 09:43:52 [DBG] Starting OCR processing on image data of 3961667 bytes
2025-06-26 09:43:53 [INF] OCR completed successfully. Confidence: 0.66%, Text length: 1029 characters
2025-06-26 09:43:53 [WRN] Low OCR confidence detected: 0.66%. Text quality may be poor
2025-06-26 09:43:53 [DBG] Processing page 2/2
2025-06-26 09:43:54 [DBG] Starting OCR processing on image data of 2338997 bytes
2025-06-26 09:43:56 [INF] OCR completed successfully. Confidence: 0.79%, Text length: 2749 characters
2025-06-26 09:43:56 [WRN] Low OCR confidence detected: 0.79%. Text quality may be poor
2025-06-26 09:43:56 [INF] PDF processing completed. Successfully processed 2/2 pages
2025-06-26 09:43:56 [INF] Step 2: Starting metadata extraction from OCR text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 09:43:56 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 09:43:56 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 09:43:56 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 09:43:56 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 09:43:56 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 09:43:56 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses"]
2025-06-26 09:43:56 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'BusinessNames' is missing or empty, Critical field 'RegistrationNumbers' is missing or empty"
2025-06-26 09:43:56 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 3, Is filtered: True
2025-06-26 09:43:56 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document Type: "Formulaire Agrg OM", Total Fields Extracted: 3, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-06-26 09:43:56 [WRN] Validation issues for '"FORMULAIREAGREGEOM_20250529122131.pdf"': "Critical field 'BusinessNames' is missing or empty, Critical field 'RegistrationNumbers' is missing or empty"
2025-06-26 09:43:56 [INF] Step 4: Returning structured metadata for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 09:43:56 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 09:43:56 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 09:43:56 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 09:43:56 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 09:43:56 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 09:43:56 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 09:43:56 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`3[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2025-06-26 09:43:56 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 8039.2516ms
2025-06-26 09:43:56 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 09:43:56 [DBG] Connection id ""0HNDKHLGJPC1L"" completed keep alive response.
2025-06-26 09:43:56 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 09:43:56 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 8069.6059ms
2025-06-26 09:46:08 [DBG] Connection id ""0HNDKHLGJPC1L"" disconnecting.
2025-06-26 09:46:08 [DBG] Connection id ""0HNDKHLGJPC1L"" stopped.
2025-06-26 09:46:08 [DBG] Connection id ""0HNDKHLGJPC1L"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 10:42:53 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:42:55 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:42:56 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:42:57 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:42:57 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:43:13 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:43:13 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:43:28 [DBG] Config reload token fired. Checking for changes...
2025-06-26 10:43:28 [DBG] Config reload token fired. Checking for changes...
2025-06-26 11:26:33 [INF] Application is shutting down...
2025-06-26 11:26:33 [DBG] Hosting stopping
2025-06-26 11:26:33 [DBG] Hosting stopped
2025-06-26 11:26:39 [INF] Application starting up
2025-06-26 11:26:39 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 11:26:39 [DBG] Hosting starting
2025-06-26 11:26:39 [INF] Now listening on: "http://localhost:5190"
2025-06-26 11:26:39 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 11:26:39 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 11:26:39 [INF] Hosting environment: "Development"
2025-06-26 11:26:39 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 11:26:39 [DBG] Hosting started
2025-06-26 11:26:47 [DBG] Connection id ""0HNDKJFQ9JB9L"" accepted.
2025-06-26 11:26:47 [DBG] Connection id ""0HNDKJFQ9JB9L"" started.
2025-06-26 11:26:47 [DBG] Connection id ""0HNDKJFQ9JB9M"" accepted.
2025-06-26 11:26:47 [DBG] Connection id ""0HNDKJFQ9JB9M"" started.
2025-06-26 11:26:47 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 11:26:47 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 11:26:47 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 11:26:47 [DBG] Request did not match any endpoints
2025-06-26 11:26:47 [DBG] Connection id ""0HNDKJFQ9JB9L"" completed keep alive response.
2025-06-26 11:26:47 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 77.5354ms
2025-06-26 11:26:47 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 11:26:47 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 11:26:47 [DBG] Request did not match any endpoints
2025-06-26 11:26:47 [DBG] Connection id ""0HNDKJFQ9JB9L"" completed keep alive response.
2025-06-26 11:26:47 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 73.7718ms
2025-06-26 11:27:15 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""" - "multipart/form-data; boundary=----WebKitFormBoundaryFOizsuDp3EEL596U" 942756
2025-06-26 11:27:15 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:27:15 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:27:15 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:27:15 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:27:15 [WRN] Failed to determine the https port for redirect.
2025-06-26 11:27:15 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:27:15 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 11:27:15 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:27:15 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:27:15 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:27:15 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:27:15 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:27:15 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 11:27:15 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 6.0456ms
2025-06-26 11:27:15 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:27:15 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'ImageOcrMicroservice.Services.OcrOrchestrationService' while attempting to activate 'ImageOcrMicroservice.Controllers.OcrController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-06-26 11:27:15 [DBG] Connection id ""0HNDKJFQ9JB9L"" completed keep alive response.
2025-06-26 11:27:15 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""" - 500 null "text/plain; charset=utf-8" 84.109ms
2025-06-26 11:27:15 [DBG] Connection id ""0HNDKJFQ9JB9L"", Request id ""0HNDKJFQ9JB9L:00000003"": started reading request body.
2025-06-26 11:27:15 [DBG] Connection id ""0HNDKJFQ9JB9L"", Request id ""0HNDKJFQ9JB9L:00000003"": done reading request body.
2025-06-26 11:28:10 [DBG] Connection id ""0HNDKJFQ9JB9M"" received FIN.
2025-06-26 11:28:10 [DBG] Connection id ""0HNDKJFQ9JB9M"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 11:28:10 [DBG] Connection id ""0HNDKJFQ9JB9M"" disconnecting.
2025-06-26 11:28:10 [DBG] Connection id ""0HNDKJFQ9JB9M"" stopped.
2025-06-26 11:29:27 [DBG] Connection id ""0HNDKJFQ9JB9L"" disconnecting.
2025-06-26 11:29:27 [DBG] Connection id ""0HNDKJFQ9JB9L"" stopped.
2025-06-26 11:29:27 [DBG] Connection id ""0HNDKJFQ9JB9L"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 11:32:49 [INF] Application is shutting down...
2025-06-26 11:32:49 [DBG] Hosting stopping
2025-06-26 11:32:49 [DBG] Hosting stopped
2025-06-26 11:32:53 [INF] Application starting up
2025-06-26 11:32:53 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 11:32:53 [DBG] Hosting starting
2025-06-26 11:32:53 [INF] Now listening on: "http://localhost:5190"
2025-06-26 11:32:53 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 11:32:53 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 11:32:53 [INF] Hosting environment: "Development"
2025-06-26 11:32:53 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 11:32:53 [DBG] Hosting started
2025-06-26 11:33:18 [DBG] Connection id ""0HNDKJJEU29UU"" accepted.
2025-06-26 11:33:18 [DBG] Connection id ""0HNDKJJEU29UU"" started.
2025-06-26 11:33:18 [DBG] Connection id ""0HNDKJJEU29UV"" accepted.
2025-06-26 11:33:18 [DBG] Connection id ""0HNDKJJEU29UV"" started.
2025-06-26 11:33:18 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 11:33:18 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 11:33:18 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 11:33:18 [DBG] Request did not match any endpoints
2025-06-26 11:33:18 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:33:18 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 82.7685ms
2025-06-26 11:33:19 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 11:33:19 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 11:33:19 [DBG] Request did not match any endpoints
2025-06-26 11:33:19 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:33:19 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 74.1786ms
2025-06-26 11:33:49 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""" - "multipart/form-data; boundary=----WebKitFormBoundaryp1BWCW4WvgHo8JCp" 942756
2025-06-26 11:33:49 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:33:49 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:33:49 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:33:49 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:33:49 [WRN] Failed to determine the https port for redirect.
2025-06-26 11:33:49 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:33:49 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 11:33:49 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:33:49 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:33:49 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:33:49 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:33:49 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:33:49 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 11:33:49 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 3.2195ms
2025-06-26 11:33:49 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:33:49 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'ImageOcrMicroservice.Services.OcrOrchestrationService' while attempting to activate 'ImageOcrMicroservice.Controllers.OcrController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-06-26 11:33:49 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:33:49 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""" - 500 null "text/plain; charset=utf-8" 76.2776ms
2025-06-26 11:33:49 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000003"": started reading request body.
2025-06-26 11:33:49 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000003"": done reading request body.
2025-06-26 11:34:20 [DBG] Connection id ""0HNDKJJEU29UV"" received FIN.
2025-06-26 11:34:20 [DBG] Connection id ""0HNDKJJEU29UV"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 11:34:20 [DBG] Connection id ""0HNDKJJEU29UV"" disconnecting.
2025-06-26 11:34:20 [DBG] Connection id ""0HNDKJJEU29UV"" stopped.
2025-06-26 11:35:07 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryARdfAuDmY0ZFLpjK" 942756
2025-06-26 11:35:07 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 11:35:07 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 11:35:07 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:07 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:35:07 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:07 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 11:35:07 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:35:07 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:35:07 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:35:07 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:35:07 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:35:07 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 11:35:07 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 1.5364ms
2025-06-26 11:35:07 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:07 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'ImageOcrMicroservice.Services.OcrOrchestrationService' while attempting to activate 'ImageOcrMicroservice.Controllers.MetadataController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method17(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-06-26 11:35:07 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:35:07 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 500 null "text/plain; charset=utf-8" 35.3505ms
2025-06-26 11:35:07 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000004"": started reading request body.
2025-06-26 11:35:07 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000004"": done reading request body.
2025-06-26 11:35:16 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryerqOaVTKwA016FEy" 479395
2025-06-26 11:35:16 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 11:35:16 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 11:35:16 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:16 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:35:16 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:16 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 11:35:16 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:35:16 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:35:16 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:35:16 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:35:16 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:35:16 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 11:35:16 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 1.6735ms
2025-06-26 11:35:16 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:16 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'ImageOcrMicroservice.Services.OcrOrchestrationService' while attempting to activate 'ImageOcrMicroservice.Controllers.MetadataController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method17(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-06-26 11:35:16 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:35:16 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 500 null "text/plain; charset=utf-8" 31.7287ms
2025-06-26 11:35:16 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000005"": started reading request body.
2025-06-26 11:35:16 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000005"": done reading request body.
2025-06-26 11:35:19 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 11:35:19 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 11:35:19 [DBG] Request did not match any endpoints
2025-06-26 11:35:19 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:35:19 [DBG] Connection id ""0HNDKJJEU29V0"" accepted.
2025-06-26 11:35:19 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 4.8484ms
2025-06-26 11:35:19 [DBG] Connection id ""0HNDKJJEU29V0"" started.
2025-06-26 11:35:19 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 11:35:19 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 11:35:19 [DBG] Request did not match any endpoints
2025-06-26 11:35:19 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:35:19 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 12.2007ms
2025-06-26 11:35:33 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryzAZKpO2yZ2pJHSwI" 491180
2025-06-26 11:35:33 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 11:35:33 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 11:35:33 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:33 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:35:33 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:33 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 11:35:33 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:35:33 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:35:33 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:35:33 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:35:33 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:35:33 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 11:35:33 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 1.3725ms
2025-06-26 11:35:33 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 11:35:33 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'ImageOcrMicroservice.Services.OcrOrchestrationService' while attempting to activate 'ImageOcrMicroservice.Controllers.MetadataController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method17(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-06-26 11:35:33 [DBG] Connection id ""0HNDKJJEU29UU"" completed keep alive response.
2025-06-26 11:35:33 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 500 null "text/plain; charset=utf-8" 36.8399ms
2025-06-26 11:35:33 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000008"": started reading request body.
2025-06-26 11:35:33 [DBG] Connection id ""0HNDKJJEU29UU"", Request id ""0HNDKJJEU29UU:00000008"": done reading request body.
2025-06-26 11:36:20 [DBG] Connection id ""0HNDKJJEU29V0"" received FIN.
2025-06-26 11:36:20 [DBG] Connection id ""0HNDKJJEU29V0"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 11:36:20 [DBG] Connection id ""0HNDKJJEU29V0"" disconnecting.
2025-06-26 11:36:20 [DBG] Connection id ""0HNDKJJEU29V0"" stopped.
2025-06-26 11:37:44 [DBG] Connection id ""0HNDKJJEU29UU"" disconnecting.
2025-06-26 11:37:44 [DBG] Connection id ""0HNDKJJEU29UU"" stopped.
2025-06-26 11:37:44 [DBG] Connection id ""0HNDKJJEU29UU"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 11:43:54 [INF] Application is shutting down...
2025-06-26 11:43:54 [DBG] Hosting stopping
2025-06-26 11:43:54 [DBG] Hosting stopped
2025-06-26 11:43:59 [INF] Application starting up
2025-06-26 11:44:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 11:44:00 [DBG] Hosting starting
2025-06-26 11:44:00 [INF] Now listening on: "http://localhost:5190"
2025-06-26 11:44:00 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 11:44:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 11:44:00 [INF] Hosting environment: "Development"
2025-06-26 11:44:00 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 11:44:00 [DBG] Hosting started
2025-06-26 11:44:43 [DBG] Connection id ""0HNDKJPR2OTQU"" accepted.
2025-06-26 11:44:43 [DBG] Connection id ""0HNDKJPR2OTQU"" started.
2025-06-26 11:44:43 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""" - "multipart/form-data; boundary=----WebKitFormBoundarypFg4SsOGwgy7bscn" 942756
2025-06-26 11:44:43 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 11:44:43 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:44:43 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:44:43 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:44:43 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:44:43 [WRN] Failed to determine the https port for redirect.
2025-06-26 11:44:43 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:44:43 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 11:44:43 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:44:43 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:44:43 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:44:43 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:44:43 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:44:43 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 11:44:43 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 11:44:44 [INF] Tesseract engine initialized successfully
2025-06-26 11:44:44 [INF] AzureOcrService initialized successfully.
2025-06-26 11:44:44 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 11:44:44 [DBG] Connection id ""0HNDKJPR2OTQU"", Request id ""0HNDKJPR2OTQU:00000001"": started reading request body.
2025-06-26 11:44:44 [DBG] Connection id ""0HNDKJPR2OTQU"", Request id ""0HNDKJPR2OTQU:00000001"": done reading request body.
2025-06-26 11:44:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 11:44:44 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 11:44:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 11:44:44 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 11:44:44 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 11:44:44 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 11:44:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 11:44:44 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 11:44:44 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:44:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:44:44 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:44:44 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 11:44:44 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:44:44 [DBG] The request has model state errors, returning an error response.
2025-06-26 11:44:44 [DBG] Request was short circuited at action filter '"Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter"'.
2025-06-26 11:44:44 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 11:44:44 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-06-26 11:44:44 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 11:44:44 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'.
2025-06-26 11:44:44 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/problem+json"' to write the response.
2025-06-26 11:44:44 [INF] Executing "BadRequestObjectResult", writing value of type '"Microsoft.AspNetCore.Mvc.ValidationProblemDetails"'.
2025-06-26 11:44:44 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 484.5843ms
2025-06-26 11:44:44 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:44:44 [DBG] Connection id ""0HNDKJPR2OTQU"" completed keep alive response.
2025-06-26 11:44:44 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 11:44:44 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""" - 400 null "application/problem+json; charset=utf-8" 569.7918ms
2025-06-26 11:45:07 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - "multipart/form-data; boundary=----WebKitFormBoundaryTnH9TkMVlCOJpdUP" 942756
2025-06-26 11:45:07 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:45:07 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 11:45:07 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:45:07 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 11:45:07 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:45:07 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 11:45:07 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 11:45:07 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 11:45:07 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 11:45:07 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 11:45:07 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 11:45:07 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 11:45:07 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 11:45:07 [INF] Tesseract engine initialized successfully
2025-06-26 11:45:07 [INF] AzureOcrService initialized successfully.
2025-06-26 11:45:07 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 11:45:07 [DBG] Connection id ""0HNDKJPR2OTQU"", Request id ""0HNDKJPR2OTQU:00000002"": started reading request body.
2025-06-26 11:45:07 [DBG] Connection id ""0HNDKJPR2OTQU"", Request id ""0HNDKJPR2OTQU:00000002"": done reading request body.
2025-06-26 11:45:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 11:45:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 11:45:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 11:45:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 11:45:07 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 11:45:07 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 11:45:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 11:45:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '"documentType"' in request data ...
2025-06-26 11:45:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:45:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:45:07 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 11:45:07 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 11:45:07 [INF] Processing file '"FORMULAIREAGREGEOM_20250529122131.pdf"' with specified document type 'Unknown'.
2025-06-26 11:45:07 [INF] Processing document with specified type: Unknown for file: "FORMULAIREAGREGEOM_20250529122131.pdf"
2025-06-26 11:45:07 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 11:45:07 [INF] Using "Azure OCR" for specified document type: Unknown
2025-06-26 11:45:07 [INF] Starting Azure OCR processing for file: "FORMULAIREAGREGEOM_20250529122131.pdf" (942540 bytes)
2025-06-26 11:45:10 [ERR] An error occurred during Azure Document Analysis.
Azure.RequestFailedException: Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource.
Status: 401 (PermissionDenied)
ErrorCode: 401

Content:
{"error":{"code":"401","message":"Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource."}}

Headers:
apim-request-id: ad6b7f59-0ab7-42ca-8481-1c33a5c94601
Date: Thu, 26 Jun 2025 10:45:06 GMT
Content-Length: 224
Content-Type: application/json

   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisRestClient.DocumentModelsAnalyzeDocumentAsync(String modelId, InternalContentType contentType, String pages, String locale, Nullable`1 stringIndexType, IEnumerable`1 features, Stream analyzeRequest, CancellationToken cancellationToken)
   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisClient.AnalyzeDocumentAsync(WaitUntil waitUntil, String modelId, Stream document, AnalyzeDocumentOptions options, CancellationToken cancellationToken)
   at ImageOcrMicroservice.Services.AzureOcrService.ExtractTextAsync(Stream fileStream) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\AzureOcrService.cs:line 33
2025-06-26 11:45:10 [WRN] Azure OCR failed or returned no text for "FORMULAIREAGREGEOM_20250529122131.pdf". Falling back to Tesseract.
2025-06-26 11:45:10 [INF] Starting Tesseract OCR processing (942540 bytes)
2025-06-26 11:45:10 [INF] Starting PDF OCR processing for 942540 bytes
2025-06-26 11:45:12 [INF] PDF processed successfully. Processing 2 pages
2025-06-26 11:45:12 [DBG] Processing page 1/2
2025-06-26 11:45:13 [DBG] Starting OCR processing on image data of 3961667 bytes
2025-06-26 11:45:15 [INF] OCR completed successfully. Confidence: 0.66%, Text length: 1029 characters
2025-06-26 11:45:15 [WRN] Low OCR confidence detected: 0.66%. Text quality may be poor
2025-06-26 11:45:15 [DBG] Processing page 2/2
2025-06-26 11:45:16 [DBG] Starting OCR processing on image data of 2338997 bytes
2025-06-26 11:45:18 [INF] OCR completed successfully. Confidence: 0.79%, Text length: 2749 characters
2025-06-26 11:45:18 [WRN] Low OCR confidence detected: 0.79%. Text quality may be poor
2025-06-26 11:45:18 [INF] PDF processing completed. Successfully processed 2/2 pages
2025-06-26 11:45:18 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 11:45:18 [INF] Successfully extracted text from file '"FORMULAIREAGREGEOM_20250529122131.pdf"' using "Azure Document Analysis".
2025-06-26 11:45:18 [INF] Executing "FileContentResult", sending file with download name '"FORMULAIREAGREGEOM_20250529122131_extracted_text.txt"' ...
2025-06-26 11:45:18 [DBG] The file result has not been enabled for processing range requests. To enable it, set the EnableRangeProcessing property on the result to 'true'.
2025-06-26 11:45:18 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 11710.8735ms
2025-06-26 11:45:18 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 11:45:18 [DBG] Connection id ""0HNDKJPR2OTQU"" completed keep alive response.
2025-06-26 11:45:18 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 11:45:18 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - 200 3907 "text/plain" 11739.95ms
2025-06-26 11:47:30 [DBG] Connection id ""0HNDKJPR2OTQU"" disconnecting.
2025-06-26 11:47:30 [DBG] Connection id ""0HNDKJPR2OTQU"" stopped.
2025-06-26 11:47:30 [DBG] Connection id ""0HNDKJPR2OTQU"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 12:08:29 [DBG] Connection id ""0HNDKJPR2OTQV"" accepted.
2025-06-26 12:08:29 [DBG] Connection id ""0HNDKJPR2OTQV"" started.
2025-06-26 12:08:29 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundary9rrK6n46EAATxVf5" 479395
2025-06-26 12:08:29 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 12:08:29 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 12:08:29 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 12:08:29 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 12:08:29 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 12:08:29 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 12:08:29 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 12:08:29 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 12:08:29 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 12:08:29 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 12:08:29 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 12:08:29 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 12:08:29 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 12:08:29 [INF] Tesseract engine initialized successfully
2025-06-26 12:08:29 [INF] AzureOcrService initialized successfully.
2025-06-26 12:08:29 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 12:08:29 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000001"": started reading request body.
2025-06-26 12:08:29 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000001"": done reading request body.
2025-06-26 12:08:29 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:08:29 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 12:08:29 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:08:29 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:08:29 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:08:29 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:08:29 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:08:29 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 12:08:29 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:29 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:29 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:29 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:08:29 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:29 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 12:08:29 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 12:08:29 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 12:08:29 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-06-26 12:08:29 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-06-26 12:08:29 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-06-26 12:08:29 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-06-26 12:08:29 [INF] Starting PDF OCR processing for 479169 bytes
2025-06-26 12:08:31 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 12:08:31 [DBG] Processing page 1/1
2025-06-26 12:08:32 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-06-26 12:08:33 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-06-26 12:08:33 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-06-26 12:08:33 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 12:08:33 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 12:08:33 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 12:08:33 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 12:08:33 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 12:08:33 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-06-26 12:08:33 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-06-26 12:08:33 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-06-26 12:08:33 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 12:08:33 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-06-26 12:08:33 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-06-26 12:08:33 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-06-26 12:08:34 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-06-26 12:08:34 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-06-26 12:08:34 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-06-26 12:08:34 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 12:08:34 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 12:08:34 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 12:08:34 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 12:08:34 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 12:08:34 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 12:08:34 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-06-26 12:08:34 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4208.2857ms
2025-06-26 12:08:34 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 12:08:34 [DBG] Connection id ""0HNDKJPR2OTQV"" completed keep alive response.
2025-06-26 12:08:34 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 12:08:34 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4246.542ms
2025-06-26 12:08:47 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarym3rikjianfqSjagS" 942756
2025-06-26 12:08:47 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 12:08:47 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 12:08:47 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 12:08:47 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 12:08:47 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 12:08:47 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 12:08:47 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 12:08:47 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 12:08:47 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 12:08:47 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 12:08:47 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 12:08:47 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 12:08:47 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 12:08:47 [INF] Tesseract engine initialized successfully
2025-06-26 12:08:47 [INF] AzureOcrService initialized successfully.
2025-06-26 12:08:47 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 12:08:47 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000002"": started reading request body.
2025-06-26 12:08:47 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000002"": done reading request body.
2025-06-26 12:08:47 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:08:47 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 12:08:47 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:08:47 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:08:47 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:08:47 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:08:47 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:08:47 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 12:08:47 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:47 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:47 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:47 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:08:47 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:08:47 [INF] Step 1: Starting intelligent OCR process for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 12:08:47 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 12:08:47 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 12:08:47 [INF] Detected document type: FormulaireAgregeOM for file: "FORMULAIREAGREGEOM_20250529122131.pdf"
2025-06-26 12:08:47 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-06-26 12:08:47 [INF] Using "Azure OCR" for document type: FormulaireAgregeOM
2025-06-26 12:08:47 [INF] Starting Azure OCR processing for file: "FORMULAIREAGREGEOM_20250529122131.pdf" (942540 bytes)
2025-06-26 12:08:50 [ERR] An error occurred during Azure Document Analysis.
Azure.RequestFailedException: Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource.
Status: 401 (PermissionDenied)
ErrorCode: 401

Content:
{"error":{"code":"401","message":"Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource."}}

Headers:
apim-request-id: 6dfe00bc-2267-43e5-9a87-3aa5e9c7587f
Date: Thu, 26 Jun 2025 11:08:46 GMT
Content-Length: 224
Content-Type: application/json

   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisRestClient.DocumentModelsAnalyzeDocumentAsync(String modelId, InternalContentType contentType, String pages, String locale, Nullable`1 stringIndexType, IEnumerable`1 features, Stream analyzeRequest, CancellationToken cancellationToken)
   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisClient.AnalyzeDocumentAsync(WaitUntil waitUntil, String modelId, Stream document, AnalyzeDocumentOptions options, CancellationToken cancellationToken)
   at ImageOcrMicroservice.Services.AzureOcrService.ExtractTextAsync(Stream fileStream) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\AzureOcrService.cs:line 33
2025-06-26 12:08:50 [WRN] Azure OCR failed or returned no text for "FORMULAIREAGREGEOM_20250529122131.pdf". Falling back to Tesseract.
2025-06-26 12:08:50 [INF] Starting Tesseract OCR processing (942540 bytes)
2025-06-26 12:08:50 [INF] Starting PDF OCR processing for 942540 bytes
2025-06-26 12:08:52 [INF] PDF processed successfully. Processing 2 pages
2025-06-26 12:08:52 [DBG] Processing page 1/2
2025-06-26 12:08:53 [DBG] Starting OCR processing on image data of 3961667 bytes
2025-06-26 12:08:54 [INF] OCR completed successfully. Confidence: 0.66%, Text length: 1029 characters
2025-06-26 12:08:54 [WRN] Low OCR confidence detected: 0.66%. Text quality may be poor
2025-06-26 12:08:54 [DBG] Processing page 2/2
2025-06-26 12:08:55 [DBG] Starting OCR processing on image data of 2338997 bytes
2025-06-26 12:08:57 [INF] OCR completed successfully. Confidence: 0.79%, Text length: 2749 characters
2025-06-26 12:08:57 [WRN] Low OCR confidence detected: 0.79%. Text quality may be poor
2025-06-26 12:08:57 [INF] PDF processing completed. Successfully processed 2/2 pages
2025-06-26 12:08:57 [INF] Step 2: Starting metadata extraction from OCR text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 12:08:57 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 12:08:57 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 12:08:57 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 12:08:57 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-06-26 12:08:57 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 12:08:57 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses, RawText"]
2025-06-26 12:08:57 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'BusinessNames' is missing or empty, Critical field 'RegistrationNumbers' is missing or empty"
2025-06-26 12:08:57 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 4, Is filtered: True
2025-06-26 12:08:57 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-06-26 12:08:57 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document Type: "Formulaire Agrg OM", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-06-26 12:08:57 [WRN] Validation issues for '"FORMULAIREAGREGEOM_20250529122131.pdf"': "Critical field 'BusinessNames' is missing or empty, Critical field 'RegistrationNumbers' is missing or empty"
2025-06-26 12:08:57 [INF] Step 4: Returning structured metadata for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-06-26 12:08:57 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-06-26 12:08:57 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 12:08:57 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 12:08:57 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 12:08:57 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 12:08:57 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 12:08:57 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 12:08:57 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-06-26 12:08:57 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 10766.3331ms
2025-06-26 12:08:57 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 12:08:57 [DBG] Connection id ""0HNDKJPR2OTQV"" completed keep alive response.
2025-06-26 12:08:57 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 12:08:57 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 10803.9274ms
2025-06-26 12:09:40 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - "multipart/form-data; boundary=----WebKitFormBoundaryszVxnBveiOi7KBS2" 141
2025-06-26 12:09:40 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 12:09:40 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 12:09:40 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 12:09:40 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 12:09:40 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 12:09:40 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 12:09:40 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 12:09:40 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 12:09:40 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 12:09:40 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 12:09:40 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 12:09:40 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 12:09:40 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 12:09:40 [INF] Tesseract engine initialized successfully
2025-06-26 12:09:40 [INF] AzureOcrService initialized successfully.
2025-06-26 12:09:40 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 12:09:40 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000003"": started reading request body.
2025-06-26 12:09:40 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000003"": done reading request body.
2025-06-26 12:09:40 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:09:40 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 12:09:40 [DBG] No files found in the request to bind the model to.
2025-06-26 12:09:40 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:09:40 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:09:40 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:09:40 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:09:40 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:09:40 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '"documentType"' in request data ...
2025-06-26 12:09:40 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:09:40 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:09:40 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:09:40 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:09:40 [DBG] The request has model state errors, returning an error response.
2025-06-26 12:09:40 [DBG] Request was short circuited at action filter '"Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter"'.
2025-06-26 12:09:40 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 12:09:40 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-06-26 12:09:40 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 12:09:40 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'.
2025-06-26 12:09:40 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/problem+json"' to write the response.
2025-06-26 12:09:40 [INF] Executing "BadRequestObjectResult", writing value of type '"Microsoft.AspNetCore.Mvc.ValidationProblemDetails"'.
2025-06-26 12:09:40 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 49.0276ms
2025-06-26 12:09:40 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 12:09:40 [DBG] Connection id ""0HNDKJPR2OTQV"" completed keep alive response.
2025-06-26 12:09:40 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 12:09:40 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - 400 null "application/problem+json; charset=utf-8" 70.5636ms
2025-06-26 12:09:58 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - "multipart/form-data; boundary=----WebKitFormBoundary7bogxd6imIkwdtHK" 141
2025-06-26 12:09:58 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 12:09:58 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 12:09:58 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 12:09:58 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 12:09:58 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 12:09:58 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 12:09:58 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 12:09:58 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 12:09:58 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 12:09:58 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 12:09:58 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 12:09:58 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 12:09:58 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 12:09:58 [INF] Tesseract engine initialized successfully
2025-06-26 12:09:58 [INF] AzureOcrService initialized successfully.
2025-06-26 12:09:58 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 12:09:58 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000004"": started reading request body.
2025-06-26 12:09:58 [DBG] Connection id ""0HNDKJPR2OTQV"", Request id ""0HNDKJPR2OTQV:00000004"": done reading request body.
2025-06-26 12:09:58 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:09:58 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 12:09:58 [DBG] No files found in the request to bind the model to.
2025-06-26 12:09:58 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:09:58 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:09:58 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 12:09:58 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 12:09:58 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:09:58 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '"documentType"' in request data ...
2025-06-26 12:09:58 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:09:58 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:09:58 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 12:09:58 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 12:09:58 [DBG] The request has model state errors, returning an error response.
2025-06-26 12:09:58 [DBG] Request was short circuited at action filter '"Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter"'.
2025-06-26 12:09:58 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 12:09:58 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-06-26 12:09:58 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 12:09:58 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'.
2025-06-26 12:09:58 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/problem+json"' to write the response.
2025-06-26 12:09:58 [INF] Executing "BadRequestObjectResult", writing value of type '"Microsoft.AspNetCore.Mvc.ValidationProblemDetails"'.
2025-06-26 12:09:58 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 46.8922ms
2025-06-26 12:09:58 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 12:09:58 [DBG] Connection id ""0HNDKJPR2OTQV"" completed keep alive response.
2025-06-26 12:09:58 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 12:09:58 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - 400 null "application/problem+json; charset=utf-8" 73.859ms
2025-06-26 12:12:10 [DBG] Connection id ""0HNDKJPR2OTQV"" disconnecting.
2025-06-26 12:12:10 [DBG] Connection id ""0HNDKJPR2OTQV"" stopped.
2025-06-26 12:12:10 [DBG] Connection id ""0HNDKJPR2OTQV"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 14:43:11 [INF] Application starting up
2025-06-26 14:43:11 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-26 14:43:12 [DBG] Hosting starting
2025-06-26 14:43:12 [INF] Now listening on: "http://localhost:5190"
2025-06-26 14:43:12 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-06-26 14:43:12 [INF] Application started. Press Ctrl+C to shut down.
2025-06-26 14:43:12 [INF] Hosting environment: "Development"
2025-06-26 14:43:12 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-06-26 14:43:12 [DBG] Hosting started
2025-06-26 14:43:17 [DBG] Connection id ""0HNDKMTJSTCBS"" accepted.
2025-06-26 14:43:17 [DBG] Connection id ""0HNDKMTJSTCBS"" started.
2025-06-26 14:43:17 [DBG] Connection id ""0HNDKMTJSTCBT"" accepted.
2025-06-26 14:43:17 [DBG] Connection id ""0HNDKMTJSTCBT"" started.
2025-06-26 14:43:17 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-06-26 14:43:17 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-26 14:43:17 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-06-26 14:43:17 [DBG] Request did not match any endpoints
2025-06-26 14:43:17 [DBG] Connection id ""0HNDKMTJSTCBS"" completed keep alive response.
2025-06-26 14:43:17 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 90.7063ms
2025-06-26 14:43:17 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-06-26 14:43:17 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-06-26 14:43:17 [DBG] Request did not match any endpoints
2025-06-26 14:43:17 [DBG] Connection id ""0HNDKMTJSTCBS"" completed keep alive response.
2025-06-26 14:43:17 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 101.6744ms
2025-06-26 14:44:20 [DBG] Connection id ""0HNDKMTJSTCBT"" received FIN.
2025-06-26 14:44:20 [DBG] Connection id ""0HNDKMTJSTCBT"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 14:44:20 [DBG] Connection id ""0HNDKMTJSTCBT"" disconnecting.
2025-06-26 14:44:20 [DBG] Connection id ""0HNDKMTJSTCBT"" stopped.
2025-06-26 14:45:28 [DBG] Connection id ""0HNDKMTJSTCBS"" disconnecting.
2025-06-26 14:45:28 [DBG] Connection id ""0HNDKMTJSTCBS"" stopped.
2025-06-26 14:45:28 [DBG] Connection id ""0HNDKMTJSTCBS"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 14:46:48 [DBG] Connection id ""0HNDKMTJSTCBU"" accepted.
2025-06-26 14:46:48 [DBG] Connection id ""0HNDKMTJSTCBU"" started.
2025-06-26 14:46:48 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryr73NmZXFoxeG4BoV" 135
2025-06-26 14:46:48 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 14:46:48 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 14:46:48 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:46:48 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 14:46:48 [WRN] Failed to determine the https port for redirect.
2025-06-26 14:46:48 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:46:48 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 14:46:48 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 14:46:48 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 14:46:48 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 14:46:48 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 14:46:48 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 14:46:48 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 14:46:48 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 14:46:49 [INF] Tesseract engine initialized successfully
2025-06-26 14:46:49 [INF] AzureOcrService initialized successfully.
2025-06-26 14:46:49 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 14:46:49 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000001"": started reading request body.
2025-06-26 14:46:49 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000001"": done reading request body.
2025-06-26 14:46:49 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:46:49 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 14:46:49 [DBG] No files found in the request to bind the model to.
2025-06-26 14:46:49 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:46:49 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:46:49 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:46:49 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:46:49 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:46:49 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 14:46:49 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:46:49 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:46:49 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:46:49 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:46:49 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:46:49 [DBG] The request has model state errors, returning an error response.
2025-06-26 14:46:49 [DBG] Request was short circuited at action filter '"Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter"'.
2025-06-26 14:46:49 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 14:46:49 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-06-26 14:46:49 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 14:46:49 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json", "application/problem+xml", "application/problem+json", "application/problem+xml"]'.
2025-06-26 14:46:49 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/problem+json"' to write the response.
2025-06-26 14:46:49 [INF] Executing "BadRequestObjectResult", writing value of type '"Microsoft.AspNetCore.Mvc.ValidationProblemDetails"'.
2025-06-26 14:46:49 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 452.1208ms
2025-06-26 14:46:49 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:46:49 [DBG] Connection id ""0HNDKMTJSTCBU"" completed keep alive response.
2025-06-26 14:46:49 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 14:46:49 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 400 null "application/problem+json; charset=utf-8" 512.0704ms
2025-06-26 14:47:09 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryaGBhbLMnaJJWz2zG" 306654
2025-06-26 14:47:09 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 14:47:09 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 14:47:09 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:47:09 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 14:47:09 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:47:09 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 14:47:09 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 14:47:09 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 14:47:09 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 14:47:09 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 14:47:09 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 14:47:09 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 14:47:09 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 14:47:09 [INF] Tesseract engine initialized successfully
2025-06-26 14:47:09 [INF] AzureOcrService initialized successfully.
2025-06-26 14:47:09 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 14:47:09 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000002"": started reading request body.
2025-06-26 14:47:09 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000002"": done reading request body.
2025-06-26 14:47:09 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:47:09 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 14:47:09 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:47:09 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:47:09 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:47:09 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:47:09 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:47:09 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 14:47:09 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:09 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:09 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:09 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:47:09 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:09 [INF] Step 1: Starting intelligent OCR process for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-06-26 14:47:09 [DBG] Normalized file name: '"planlocalisation20250606124459"' from original: '"PLANLOCALISATION_20250606124459.pdf"'
2025-06-26 14:47:09 [INF] Could not detect document type for file '"PLANLOCALISATION_20250606124459.pdf"', returning Unknown
2025-06-26 14:47:09 [INF] Detected document type: Unknown for file: "PLANLOCALISATION_20250606124459.pdf"
2025-06-26 14:47:09 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:47:09 [INF] Using "Azure OCR" for document type: Unknown
2025-06-26 14:47:09 [INF] Starting Azure OCR processing for file: "PLANLOCALISATION_20250606124459.pdf" (306440 bytes)
2025-06-26 14:47:11 [ERR] An error occurred during Azure Document Analysis.
Azure.RequestFailedException: Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource.
Status: 401 (PermissionDenied)
ErrorCode: 401

Content:
{"error":{"code":"401","message":"Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource."}}

Headers:
apim-request-id: e787dbcc-ec31-48af-98bd-009c0340b2a7
Date: Thu, 26 Jun 2025 13:47:08 GMT
Content-Length: 224
Content-Type: application/json

   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisRestClient.DocumentModelsAnalyzeDocumentAsync(String modelId, InternalContentType contentType, String pages, String locale, Nullable`1 stringIndexType, IEnumerable`1 features, Stream analyzeRequest, CancellationToken cancellationToken)
   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisClient.AnalyzeDocumentAsync(WaitUntil waitUntil, String modelId, Stream document, AnalyzeDocumentOptions options, CancellationToken cancellationToken)
   at ImageOcrMicroservice.Services.AzureOcrService.ExtractTextAsync(Stream fileStream) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\AzureOcrService.cs:line 33
2025-06-26 14:47:11 [WRN] Azure OCR failed or returned no text for "PLANLOCALISATION_20250606124459.pdf". Falling back to Tesseract.
2025-06-26 14:47:11 [INF] Starting Tesseract OCR processing (306440 bytes)
2025-06-26 14:47:11 [INF] Starting PDF OCR processing for 306440 bytes
2025-06-26 14:47:12 [INF] PDF processed successfully. Processing 1 pages
2025-06-26 14:47:12 [DBG] Processing page 1/1
2025-06-26 14:47:13 [DBG] Starting OCR processing on image data of 1879905 bytes
2025-06-26 14:47:14 [INF] OCR completed successfully. Confidence: 0.42%, Text length: 86 characters
2025-06-26 14:47:14 [WRN] Low OCR confidence detected: 0.42%. Text quality may be poor
2025-06-26 14:47:14 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-06-26 14:47:14 [INF] Step 2: Starting metadata extraction from OCR text for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-06-26 14:47:14 [INF] Starting metadata extraction from raw text for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-06-26 14:47:14 [DBG] Normalized file name: '"planlocalisation20250606124459"' from original: '"PLANLOCALISATION_20250606124459.pdf"'
2025-06-26 14:47:14 [INF] Could not detect document type for file '"PLANLOCALISATION_20250606124459.pdf"', returning Unknown
2025-06-26 14:47:14 [INF] Detected document type: Unknown for file '"PLANLOCALISATION_20250606124459.pdf"'
2025-06-26 14:47:14 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 14:47:14 [INF] Document type is Unknown, returning all metadata fields.
2025-06-26 14:47:14 [INF] Metadata extraction completed for '"PLANLOCALISATION_20250606124459.pdf"'. Document type: Unknown, Extracted fields: 3, Is filtered: False
2025-06-26 14:47:14 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:47:14 [INF] Metadata extraction completed for '"PLANLOCALISATION_20250606124459.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 3, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-26 14:47:14 [INF] Step 4: Returning structured metadata for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-06-26 14:47:14 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:47:14 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 14:47:14 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 14:47:14 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 14:47:14 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 14:47:14 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 14:47:14 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 14:47:14 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-06-26 14:47:14 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4646.8641ms
2025-06-26 14:47:14 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:47:14 [DBG] Connection id ""0HNDKMTJSTCBU"" completed keep alive response.
2025-06-26 14:47:14 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 14:47:14 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4672.9906ms
2025-06-26 14:47:53 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryzZxnm0BngOeGV8Ls" 3650239
2025-06-26 14:47:53 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-06-26 14:47:53 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-06-26 14:47:53 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:47:53 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:47:53 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 14:47:53 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:47:53 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-06-26 14:47:53 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 14:47:53 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 14:47:53 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 14:47:53 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 14:47:53 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 14:47:53 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 14:47:53 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 14:47:53 [INF] Tesseract engine initialized successfully
2025-06-26 14:47:53 [INF] AzureOcrService initialized successfully.
2025-06-26 14:47:53 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-06-26 14:47:53 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000003"": started reading request body.
2025-06-26 14:47:53 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:47:53 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:47:53 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:47:53 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000003"": done reading request body.
2025-06-26 14:47:53 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:47:53 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 14:47:53 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:47:53 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:47:53 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:47:53 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:47:53 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:47:53 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-06-26 14:47:53 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:53 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:53 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:53 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:47:53 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:47:53 [INF] Step 1: Starting intelligent OCR process for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-06-26 14:47:53 [DBG] Normalized file name: '"687641056tchindachristelleallianceinfinimentbonaberi1"' from original: '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-06-26 14:47:53 [INF] Could not detect document type for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"', returning Unknown
2025-06-26 14:47:53 [INF] Detected document type: Unknown for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"
2025-06-26 14:47:53 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:47:53 [INF] Using "Azure OCR" for document type: Unknown
2025-06-26 14:47:53 [INF] Starting Azure OCR processing for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf" (3649997 bytes)
2025-06-26 14:47:53 [ERR] An error occurred during Azure Document Analysis.
Azure.RequestFailedException: Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource.
Status: 401 (PermissionDenied)
ErrorCode: 401

Content:
{"error":{"code":"401","message":"Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource."}}

Headers:
apim-request-id: 381e9cd9-5582-4477-b33b-f66572a9d15c
Date: Thu, 26 Jun 2025 13:47:51 GMT
Content-Length: 224
Content-Type: application/json

   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisRestClient.DocumentModelsAnalyzeDocumentAsync(String modelId, InternalContentType contentType, String pages, String locale, Nullable`1 stringIndexType, IEnumerable`1 features, Stream analyzeRequest, CancellationToken cancellationToken)
   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisClient.AnalyzeDocumentAsync(WaitUntil waitUntil, String modelId, Stream document, AnalyzeDocumentOptions options, CancellationToken cancellationToken)
   at ImageOcrMicroservice.Services.AzureOcrService.ExtractTextAsync(Stream fileStream) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\AzureOcrService.cs:line 33
2025-06-26 14:47:53 [WRN] Azure OCR failed or returned no text for "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf". Falling back to Tesseract.
2025-06-26 14:47:53 [INF] Starting Tesseract OCR processing (3649997 bytes)
2025-06-26 14:47:53 [INF] Starting PDF OCR processing for 3649997 bytes
2025-06-26 14:48:02 [INF] PDF processed successfully. Processing 6 pages
2025-06-26 14:48:02 [DBG] Processing page 1/6
2025-06-26 14:48:03 [DBG] Starting OCR processing on image data of 4871940 bytes
2025-06-26 14:48:05 [INF] OCR completed successfully. Confidence: 0.82%, Text length: 1084 characters
2025-06-26 14:48:05 [WRN] Low OCR confidence detected: 0.82%. Text quality may be poor
2025-06-26 14:48:05 [DBG] Processing page 2/6
2025-06-26 14:48:06 [DBG] Starting OCR processing on image data of 5514733 bytes
2025-06-26 14:48:09 [INF] OCR completed successfully. Confidence: 0.71%, Text length: 2822 characters
2025-06-26 14:48:09 [WRN] Low OCR confidence detected: 0.71%. Text quality may be poor
2025-06-26 14:48:09 [DBG] Processing page 3/6
2025-06-26 14:48:10 [DBG] Starting OCR processing on image data of 3585188 bytes
2025-06-26 14:48:12 [INF] OCR completed successfully. Confidence: 0.90%, Text length: 1754 characters
2025-06-26 14:48:12 [WRN] Low OCR confidence detected: 0.90%. Text quality may be poor
2025-06-26 14:48:12 [DBG] Processing page 4/6
2025-06-26 14:48:14 [DBG] Starting OCR processing on image data of 6956401 bytes
2025-06-26 14:48:15 [INF] OCR completed successfully. Confidence: 0.57%, Text length: 984 characters
2025-06-26 14:48:15 [WRN] Low OCR confidence detected: 0.57%. Text quality may be poor
2025-06-26 14:48:15 [DBG] Processing page 5/6
2025-06-26 14:48:19 [DBG] Starting OCR processing on image data of 8111565 bytes
2025-06-26 14:48:19 [INF] OCR completed successfully. Confidence: 0.71%, Text length: 40 characters
2025-06-26 14:48:19 [WRN] Low OCR confidence detected: 0.71%. Text quality may be poor
2025-06-26 14:48:19 [DBG] Processing page 6/6
2025-06-26 14:48:20 [DBG] Starting OCR processing on image data of 2165648 bytes
2025-06-26 14:48:21 [INF] OCR completed successfully. Confidence: 0.37%, Text length: 116 characters
2025-06-26 14:48:21 [WRN] Low OCR confidence detected: 0.37%. Text quality may be poor
2025-06-26 14:48:21 [INF] PDF processing completed. Successfully processed 6/6 pages
2025-06-26 14:48:21 [INF] Step 2: Starting metadata extraction from OCR text for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-06-26 14:48:21 [INF] Starting metadata extraction from raw text for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-06-26 14:48:21 [DBG] Normalized file name: '"687641056tchindachristelleallianceinfinimentbonaberi1"' from original: '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-06-26 14:48:21 [INF] Could not detect document type for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"', returning Unknown
2025-06-26 14:48:21 [INF] Detected document type: Unknown for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-06-26 14:48:21 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 2 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 1 Tax Attestation(s), 1 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-06-26 14:48:21 [INF] Document type is Unknown, returning all metadata fields.
2025-06-26 14:48:21 [INF] Metadata extraction completed for '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'. Document type: Unknown, Extracted fields: 8, Is filtered: False
2025-06-26 14:48:21 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:48:21 [INF] Metadata extraction completed for '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 1, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-06-26 14:48:21 [INF] Step 4: Returning structured metadata for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-06-26 14:48:21 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:48:21 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 14:48:21 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 14:48:21 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-26 14:48:21 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-26 14:48:21 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-26 14:48:21 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-06-26 14:48:21 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-06-26 14:48:21 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 28480.7266ms
2025-06-26 14:48:21 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-06-26 14:48:21 [DBG] Connection id ""0HNDKMTJSTCBU"" completed keep alive response.
2025-06-26 14:48:21 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 14:48:21 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 28508.3924ms
2025-06-26 14:49:20 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unkown" - "multipart/form-data; boundary=----WebKitFormBoundarypHstruPaTPfUR8lJ" 3650239
2025-06-26 14:49:20 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 14:49:20 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:49:20 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:49:20 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 14:49:20 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:49:20 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 14:49:20 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 14:49:20 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 14:49:20 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 14:49:20 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 14:49:20 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 14:49:20 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 14:49:20 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 14:49:20 [INF] Tesseract engine initialized successfully
2025-06-26 14:49:20 [INF] AzureOcrService initialized successfully.
2025-06-26 14:49:20 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000004"": started reading request body.
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000004"": done reading request body.
2025-06-26 14:49:20 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:49:20 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 14:49:20 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:49:20 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:49:20 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:49:20 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:49:20 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:49:20 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '"documentType"' in request data ...
2025-06-26 14:49:20 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:49:20 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:49:20 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:49:20 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:49:20 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 14:49:20 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 14:49:20 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter"' and content type '"text/plain"' to write the response.
2025-06-26 14:49:20 [INF] Executing "BadRequestObjectResult", writing value of type '"System.String"'.
2025-06-26 14:49:20 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 91.6347ms
2025-06-26 14:49:20 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:49:20 [DBG] Connection id ""0HNDKMTJSTCBU"" completed keep alive response.
2025-06-26 14:49:20 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 14:49:20 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unkown" - 400 null "text/plain; charset=utf-8" 118.5819ms
2025-06-26 14:49:59 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unkown" - "multipart/form-data; boundary=----WebKitFormBoundaryYdBO0nCrhFZ7FNmS" 3650239
2025-06-26 14:49:59 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 14:49:59 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:49:59 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 14:49:59 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:49:59 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 14:49:59 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:49:59 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 14:49:59 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 14:49:59 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 14:49:59 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 14:49:59 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 14:49:59 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 14:49:59 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 14:49:59 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 14:49:59 [INF] Tesseract engine initialized successfully
2025-06-26 14:49:59 [INF] AzureOcrService initialized successfully.
2025-06-26 14:49:59 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 14:49:59 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000005"": started reading request body.
2025-06-26 14:49:59 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:49:59 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000005"": done reading request body.
2025-06-26 14:49:59 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:49:59 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 14:49:59 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:49:59 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:49:59 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:49:59 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:49:59 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:49:59 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '"documentType"' in request data ...
2025-06-26 14:49:59 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:49:59 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:49:59 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:49:59 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:49:59 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-06-26 14:49:59 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-26 14:49:59 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter"' and content type '"text/plain"' to write the response.
2025-06-26 14:49:59 [INF] Executing "BadRequestObjectResult", writing value of type '"System.String"'.
2025-06-26 14:49:59 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 54.1062ms
2025-06-26 14:49:59 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:49:59 [DBG] Connection id ""0HNDKMTJSTCBU"" completed keep alive response.
2025-06-26 14:49:59 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 14:49:59 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unkown" - 400 null "text/plain; charset=utf-8" 78.4928ms
2025-06-26 14:50:44 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - "multipart/form-data; boundary=----WebKitFormBoundarydvap7HsDloOptQXd" 3650239
2025-06-26 14:50:44 [DBG] 1 candidate(s) found for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 14:50:44 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"' with route pattern '"api/Ocr/extractTextWithType"' is valid for the request path '"/api/Ocr/extractTextWithType"'
2025-06-26 14:50:44 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:50:44 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:50:44 [DBG] Static files was skipped as the request already matched an endpoint.
2025-06-26 14:50:44 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:50:44 [INF] Route matched with "{action = \"ExtractTextFromFileWithDocumentType\", controller = \"Ocr\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractTextFromFileWithDocumentType(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API").
2025-06-26 14:50:44 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-06-26 14:50:44 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-06-26 14:50:44 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-06-26 14:50:44 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-06-26 14:50:44 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-26 14:50:44 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 14:50:44 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-06-26 14:50:45 [INF] Tesseract engine initialized successfully
2025-06-26 14:50:45 [INF] AzureOcrService initialized successfully.
2025-06-26 14:50:45 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.OcrController" ("DocumentProcessor.API")
2025-06-26 14:50:45 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000006"": started reading request body.
2025-06-26 14:50:45 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:50:45 [DBG] Connection id ""0HNDKMTJSTCBU"" paused.
2025-06-26 14:50:45 [DBG] Connection id ""0HNDKMTJSTCBU"" resumed.
2025-06-26 14:50:45 [DBG] Connection id ""0HNDKMTJSTCBU"", Request id ""0HNDKMTJSTCBU:00000006"": done reading request body.
2025-06-26 14:50:45 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:50:45 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-06-26 14:50:45 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:50:45 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:50:45 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-06-26 14:50:45 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-06-26 14:50:45 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:50:45 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '"documentType"' in request data ...
2025-06-26 14:50:45 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:50:45 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:50:45 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-06-26 14:50:45 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-06-26 14:50:45 [INF] Processing file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"' with specified document type 'Unknown'.
2025-06-26 14:50:45 [INF] Processing document with specified type: Unknown for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"
2025-06-26 14:50:45 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:50:45 [INF] Using "Azure OCR" for specified document type: Unknown
2025-06-26 14:50:45 [INF] Starting Azure OCR processing for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf" (3649997 bytes)
2025-06-26 14:50:47 [ERR] An error occurred during Azure Document Analysis.
Azure.RequestFailedException: Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource.
Status: 401 (PermissionDenied)
ErrorCode: 401

Content:
{"error":{"code":"401","message":"Access denied due to invalid subscription key or wrong API endpoint. Make sure to provide a valid key for an active subscription and use a correct regional API endpoint for your resource."}}

Headers:
apim-request-id: 62c18545-3d04-4aeb-9aa0-2478f4268ee7
Date: Thu, 26 Jun 2025 13:50:44 GMT
Content-Length: 224
Content-Type: application/json

   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisRestClient.DocumentModelsAnalyzeDocumentAsync(String modelId, InternalContentType contentType, String pages, String locale, Nullable`1 stringIndexType, IEnumerable`1 features, Stream analyzeRequest, CancellationToken cancellationToken)
   at Azure.AI.FormRecognizer.DocumentAnalysis.DocumentAnalysisClient.AnalyzeDocumentAsync(WaitUntil waitUntil, String modelId, Stream document, AnalyzeDocumentOptions options, CancellationToken cancellationToken)
   at ImageOcrMicroservice.Services.AzureOcrService.ExtractTextAsync(Stream fileStream) in C:\Users\czar\Documents\Stage\model\DocumentProcessor\Services\AzureOcrService.cs:line 33
2025-06-26 14:50:47 [WRN] Azure OCR failed or returned no text for "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf". Falling back to Tesseract.
2025-06-26 14:50:47 [INF] Starting Tesseract OCR processing (3649997 bytes)
2025-06-26 14:50:47 [INF] Starting PDF OCR processing for 3649997 bytes
2025-06-26 14:50:56 [INF] PDF processed successfully. Processing 6 pages
2025-06-26 14:50:56 [DBG] Processing page 1/6
2025-06-26 14:50:57 [DBG] Starting OCR processing on image data of 4871940 bytes
2025-06-26 14:50:58 [INF] OCR completed successfully. Confidence: 0.82%, Text length: 1084 characters
2025-06-26 14:50:58 [WRN] Low OCR confidence detected: 0.82%. Text quality may be poor
2025-06-26 14:50:58 [DBG] Processing page 2/6
2025-06-26 14:51:00 [DBG] Starting OCR processing on image data of 5514733 bytes
2025-06-26 14:51:02 [INF] OCR completed successfully. Confidence: 0.71%, Text length: 2822 characters
2025-06-26 14:51:02 [WRN] Low OCR confidence detected: 0.71%. Text quality may be poor
2025-06-26 14:51:02 [DBG] Processing page 3/6
2025-06-26 14:51:03 [DBG] Starting OCR processing on image data of 3585188 bytes
2025-06-26 14:51:05 [INF] OCR completed successfully. Confidence: 0.90%, Text length: 1754 characters
2025-06-26 14:51:05 [WRN] Low OCR confidence detected: 0.90%. Text quality may be poor
2025-06-26 14:51:05 [DBG] Processing page 4/6
2025-06-26 14:51:07 [DBG] Starting OCR processing on image data of 6956401 bytes
2025-06-26 14:51:09 [INF] OCR completed successfully. Confidence: 0.57%, Text length: 984 characters
2025-06-26 14:51:09 [WRN] Low OCR confidence detected: 0.57%. Text quality may be poor
2025-06-26 14:51:09 [DBG] Processing page 5/6
2025-06-26 14:51:13 [DBG] Starting OCR processing on image data of 8111565 bytes
2025-06-26 14:51:13 [INF] OCR completed successfully. Confidence: 0.71%, Text length: 40 characters
2025-06-26 14:51:13 [WRN] Low OCR confidence detected: 0.71%. Text quality may be poor
2025-06-26 14:51:13 [DBG] Processing page 6/6
2025-06-26 14:51:14 [DBG] Starting OCR processing on image data of 2165648 bytes
2025-06-26 14:51:15 [INF] OCR completed successfully. Confidence: 0.37%, Text length: 116 characters
2025-06-26 14:51:15 [WRN] Low OCR confidence detected: 0.37%. Text quality may be poor
2025-06-26 14:51:15 [INF] PDF processing completed. Successfully processed 6/6 pages
2025-06-26 14:51:15 [DBG] Document type Unknown requires Azure OCR: True
2025-06-26 14:51:15 [INF] Successfully extracted text from file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"' using "Azure Document Analysis".
2025-06-26 14:51:15 [INF] Executing "FileContentResult", sending file with download name '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1_extracted_text.txt"' ...
2025-06-26 14:51:15 [DBG] The file result has not been enabled for processing range requests. To enable it, set the EnableRangeProcessing property on the result to 'true'.
2025-06-26 14:51:15 [INF] Executed action "ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)" in 30408.0697ms
2025-06-26 14:51:15 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.OcrController.ExtractTextFromFileWithDocumentType (DocumentProcessor.API)"'
2025-06-26 14:51:15 [DBG] Connection id ""0HNDKMTJSTCBU"" completed keep alive response.
2025-06-26 14:51:15 [DBG] Disposing OcrService and Tesseract engine
2025-06-26 14:51:15 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Ocr/extractTextWithType""?documentType=unknown" - 200 7111 "text/plain" 30435.0266ms
2025-06-26 14:53:25 [DBG] Connection id ""0HNDKMTJSTCBU"" disconnecting.
2025-06-26 14:53:25 [DBG] Connection id ""0HNDKMTJSTCBU"" stopped.
2025-06-26 14:53:25 [DBG] Connection id ""0HNDKMTJSTCBU"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-06-26 15:38:01 [INF] Application is shutting down...
2025-06-26 15:38:01 [DBG] Hosting stopping
2025-06-26 15:38:01 [DBG] Hosting stopped
