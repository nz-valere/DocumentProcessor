2025-07-04 09:37:33 [INF] Application starting up
2025-07-04 09:37:33 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-07-04 09:37:33 [DBG] Hosting starting
2025-07-04 09:37:33 [INF] Now listening on: "http://localhost:5190"
2025-07-04 09:37:33 [INF] Now listening on: "http://0.0.0.0:5190"
2025-07-04 09:37:33 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-07-04 09:37:33 [INF] Application started. Press Ctrl+C to shut down.
2025-07-04 09:37:33 [INF] Hosting environment: "Development"
2025-07-04 09:37:33 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-07-04 09:37:33 [DBG] Hosting started
2025-07-04 09:37:36 [INF] Application is shutting down...
2025-07-04 09:37:36 [DBG] Hosting stopping
2025-07-04 09:37:37 [DBG] Hosting stopped
2025-07-04 09:38:16 [INF] Application starting up
2025-07-04 09:38:16 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-07-04 09:38:16 [DBG] Hosting starting
2025-07-04 09:38:16 [INF] Now listening on: "http://localhost:5190"
2025-07-04 09:38:16 [INF] Now listening on: "http://0.0.0.0:5190"
2025-07-04 09:38:16 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-07-04 09:38:16 [INF] Application started. Press Ctrl+C to shut down.
2025-07-04 09:38:16 [INF] Hosting environment: "Development"
2025-07-04 09:38:16 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-07-04 09:38:16 [DBG] Hosting started
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" paused.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" accepted.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" started.
2025-07-04 09:39:27 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-030215943361" 3591828
2025-07-04 09:39:27 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-07-04 09:39:27 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 09:39:27 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 09:39:27 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 09:39:27 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 09:39:27 [WRN] Failed to determine the https port for redirect.
2025-07-04 09:39:27 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 09:39:27 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 09:39:27 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 09:39:27 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 09:39:27 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 09:39:27 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 09:39:27 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 09:39:27 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 09:39:27 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 09:39:27 [INF] Tesseract engine initialized successfully
2025-07-04 09:39:27 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 09:39:27 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"", Request id ""0HNDQQP4NEEIP:00000001"": started reading request body.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" resumed.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" paused.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" resumed.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" paused.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"" resumed.
2025-07-04 09:39:27 [DBG] Connection id ""0HNDQQP4NEEIP"", Request id ""0HNDQQP4NEEIP:00000001"": done reading request body.
2025-07-04 09:39:28 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 09:39:28 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 09:39:28 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 09:39:28 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 09:39:28 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 09:39:28 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 09:39:28 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 09:39:28 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 09:39:28 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:39:28 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:39:28 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:39:28 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 09:39:28 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:39:28 [INF] Step 1: Starting intelligent OCR process for file '"6876.jpg"'.
2025-07-04 09:39:28 [DBG] Normalized file name: '"6876"' from original: '"6876.jpg"'
2025-07-04 09:39:28 [INF] Could not detect document type for file '"6876.jpg"', returning Unknown
2025-07-04 09:39:28 [INF] Detected document type: Unknown for file: "6876.jpg"
2025-07-04 09:39:28 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 09:39:28 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 09:39:28 [INF] Starting Azure OCR processing for file: "6876.jpg" (3591660 bytes)
2025-07-04 09:39:28 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 09:39:28 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 09:39:28 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 09:39:45 [INF] Azure OCR completed successfully for "6876.jpg". Text length: 1108 characters
2025-07-04 09:39:45 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876.jpg"'.
2025-07-04 09:39:45 [INF] Starting metadata extraction from raw text for file '"6876.jpg"'.
2025-07-04 09:39:45 [DBG] Normalized file name: '"6876"' from original: '"6876.jpg"'
2025-07-04 09:39:45 [INF] Could not detect document type for file '"6876.jpg"', returning Unknown
2025-07-04 09:39:45 [INF] Detected document type: Unknown for file '"6876.jpg"'
2025-07-04 09:39:45 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 3 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 09:39:45 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 09:39:45 [INF] Metadata extraction completed for '"6876.jpg"'. Document type: Unknown, Extracted fields: 5, Is filtered: False
2025-07-04 09:39:45 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 09:39:45 [INF] Metadata extraction completed for '"6876.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 09:39:45 [INF] Step 4: Returning structured metadata for file '"6876.jpg"'.
2025-07-04 09:39:45 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 09:39:45 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 09:39:45 [DBG] No information found on request to perform content negotiation.
2025-07-04 09:39:45 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 09:39:45 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 09:39:45 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 09:39:45 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 09:39:45 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 17696.1732ms
2025-07-04 09:39:45 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 09:39:45 [DBG] Connection id ""0HNDQQP4NEEIP"" completed keep alive response.
2025-07-04 09:39:45 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 09:39:45 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 17791.5192ms
2025-07-04 09:39:49 [DBG] Connection id ""0HNDQQP4NEEIP"" received FIN.
2025-07-04 09:39:49 [DBG] Connection id ""0HNDQQP4NEEIP"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 09:39:49 [DBG] Connection id ""0HNDQQP4NEEIP"" disconnecting.
2025-07-04 09:39:49 [DBG] Connection id ""0HNDQQP4NEEIP"" stopped.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" accepted.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" started.
2025-07-04 09:46:07 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-085521059634" 2978211
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" paused.
2025-07-04 09:46:07 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 09:46:07 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 09:46:07 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 09:46:07 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 09:46:07 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 09:46:07 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 09:46:07 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 09:46:07 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 09:46:07 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 09:46:07 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 09:46:07 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 09:46:07 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 09:46:07 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 09:46:07 [INF] Tesseract engine initialized successfully
2025-07-04 09:46:07 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 09:46:07 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"", Request id ""0HNDQQP4NEEIQ:00000001"": started reading request body.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" resumed.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" paused.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" resumed.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" paused.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"" resumed.
2025-07-04 09:46:07 [DBG] Connection id ""0HNDQQP4NEEIQ"", Request id ""0HNDQQP4NEEIQ:00000001"": done reading request body.
2025-07-04 09:46:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 09:46:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 09:46:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 09:46:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 09:46:07 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 09:46:07 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 09:46:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 09:46:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 09:46:07 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:46:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:46:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:46:07 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 09:46:07 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 09:46:07 [INF] Step 1: Starting intelligent OCR process for file '"6876_page-0001.jpg"'.
2025-07-04 09:46:07 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 09:46:07 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 09:46:07 [INF] Detected document type: Unknown for file: "6876_page-0001.jpg"
2025-07-04 09:46:07 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 09:46:07 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 09:46:07 [INF] Starting Azure OCR processing for file: "6876_page-0001.jpg" (2978033 bytes)
2025-07-04 09:46:07 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 09:46:07 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 09:46:07 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 09:46:13 [INF] Azure OCR completed successfully for "6876_page-0001.jpg". Text length: 1354 characters
2025-07-04 09:46:13 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876_page-0001.jpg"'.
2025-07-04 09:46:13 [INF] Starting metadata extraction from raw text for file '"6876_page-0001.jpg"'.
2025-07-04 09:46:13 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 09:46:13 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 09:46:13 [INF] Detected document type: Unknown for file '"6876_page-0001.jpg"'
2025-07-04 09:46:13 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 09:46:13 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 09:46:13 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document type: Unknown, Extracted fields: 4, Is filtered: False
2025-07-04 09:46:13 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 09:46:13 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 09:46:13 [INF] Step 4: Returning structured metadata for file '"6876_page-0001.jpg"'.
2025-07-04 09:46:13 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 09:46:13 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 09:46:13 [DBG] No information found on request to perform content negotiation.
2025-07-04 09:46:13 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 09:46:13 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 09:46:13 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 09:46:13 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 09:46:13 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 5484.5769ms
2025-07-04 09:46:13 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 09:46:13 [DBG] Connection id ""0HNDQQP4NEEIQ"" completed keep alive response.
2025-07-04 09:46:13 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 09:46:13 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 5512.0288ms
2025-07-04 09:46:17 [DBG] Connection id ""0HNDQQP4NEEIQ"" received FIN.
2025-07-04 09:46:17 [DBG] Connection id ""0HNDQQP4NEEIQ"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 09:46:17 [DBG] Connection id ""0HNDQQP4NEEIQ"" disconnecting.
2025-07-04 09:46:17 [DBG] Connection id ""0HNDQQP4NEEIQ"" stopped.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" accepted.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" started.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" paused.
2025-07-04 10:00:01 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-062679570862" 2978211
2025-07-04 10:00:01 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:00:01 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:00:01 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:00:01 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:00:01 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:00:01 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:00:01 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:00:01 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:00:01 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:00:01 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:00:01 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:00:01 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:00:01 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:00:01 [INF] Tesseract engine initialized successfully
2025-07-04 10:00:01 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:00:01 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"", Request id ""0HNDQQP4NEEIR:00000001"": started reading request body.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" resumed.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" paused.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" resumed.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" paused.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"" resumed.
2025-07-04 10:00:01 [DBG] Connection id ""0HNDQQP4NEEIR"", Request id ""0HNDQQP4NEEIR:00000001"": done reading request body.
2025-07-04 10:00:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:00:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:00:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:00:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:00:01 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:00:01 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:00:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:00:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:00:01 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:00:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:00:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:00:01 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:00:01 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:00:01 [INF] Step 1: Starting intelligent OCR process for file '"6876_page-0001.jpg"'.
2025-07-04 10:00:01 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 10:00:01 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 10:00:01 [INF] Detected document type: Unknown for file: "6876_page-0001.jpg"
2025-07-04 10:00:01 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:00:01 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 10:00:01 [INF] Starting Azure OCR processing for file: "6876_page-0001.jpg" (2978033 bytes)
2025-07-04 10:00:01 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 10:00:01 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 10:00:01 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 10:00:07 [INF] Azure OCR completed successfully for "6876_page-0001.jpg". Text length: 1354 characters
2025-07-04 10:00:07 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876_page-0001.jpg"'.
2025-07-04 10:00:07 [INF] Starting metadata extraction from raw text for file '"6876_page-0001.jpg"'.
2025-07-04 10:00:07 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 10:00:07 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 10:00:07 [INF] Detected document type: Unknown for file '"6876_page-0001.jpg"'
2025-07-04 10:00:07 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:00:07 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 10:00:07 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document type: Unknown, Extracted fields: 4, Is filtered: False
2025-07-04 10:00:07 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:00:07 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:00:07 [INF] Step 4: Returning structured metadata for file '"6876_page-0001.jpg"'.
2025-07-04 10:00:07 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:00:07 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:00:07 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:00:07 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:00:07 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:00:07 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:00:07 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:00:07 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 5756.1074ms
2025-07-04 10:00:07 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:00:07 [DBG] Connection id ""0HNDQQP4NEEIR"" completed keep alive response.
2025-07-04 10:00:07 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:00:07 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 5794.2772ms
2025-07-04 10:00:11 [DBG] Connection id ""0HNDQQP4NEEIR"" received FIN.
2025-07-04 10:00:11 [DBG] Connection id ""0HNDQQP4NEEIR"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:00:11 [DBG] Connection id ""0HNDQQP4NEEIR"" disconnecting.
2025-07-04 10:00:11 [DBG] Connection id ""0HNDQQP4NEEIR"" stopped.
2025-07-04 10:21:06 [DBG] Connection id ""0HNDQQP4NEEIS"" accepted.
2025-07-04 10:21:06 [DBG] Connection id ""0HNDQQP4NEEIS"" started.
2025-07-04 10:21:06 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-032240247223" 2978211
2025-07-04 10:21:06 [DBG] Connection id ""0HNDQQP4NEEIS"" paused.
2025-07-04 10:21:07 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:21:07 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:21:07 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:21:07 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:21:07 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:21:07 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:21:07 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:21:07 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:21:07 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:21:07 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:21:07 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:21:07 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:21:07 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:21:07 [INF] Tesseract engine initialized successfully
2025-07-04 10:21:07 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:21:07 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"", Request id ""0HNDQQP4NEEIS:00000001"": started reading request body.
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"" resumed.
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"" paused.
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"" resumed.
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"" paused.
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"" resumed.
2025-07-04 10:21:07 [DBG] Connection id ""0HNDQQP4NEEIS"", Request id ""0HNDQQP4NEEIS:00000001"": done reading request body.
2025-07-04 10:21:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:21:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:21:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:21:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:21:07 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:21:07 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:21:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:21:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:21:07 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:21:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:21:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:21:07 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:21:07 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:21:07 [INF] Step 1: Starting intelligent OCR process for file '"6876_page-0001.jpg"'.
2025-07-04 10:21:07 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 10:21:07 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 10:21:07 [INF] Detected document type: Unknown for file: "6876_page-0001.jpg"
2025-07-04 10:21:07 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:21:07 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 10:21:07 [INF] Starting Azure OCR processing for file: "6876_page-0001.jpg" (2978033 bytes)
2025-07-04 10:21:07 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 10:21:07 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 10:21:07 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 10:21:12 [INF] Azure OCR completed successfully for "6876_page-0001.jpg". Text length: 1354 characters
2025-07-04 10:21:12 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876_page-0001.jpg"'.
2025-07-04 10:21:12 [INF] Starting metadata extraction from raw text for file '"6876_page-0001.jpg"'.
2025-07-04 10:21:12 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 10:21:12 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 10:21:12 [INF] Detected document type: Unknown for file '"6876_page-0001.jpg"'
2025-07-04 10:21:12 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:21:12 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 10:21:12 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document type: Unknown, Extracted fields: 4, Is filtered: False
2025-07-04 10:21:12 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:21:12 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:21:12 [INF] Step 4: Returning structured metadata for file '"6876_page-0001.jpg"'.
2025-07-04 10:21:12 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:21:12 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:21:12 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:21:12 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:21:12 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:21:12 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:21:12 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:21:12 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 5618.175ms
2025-07-04 10:21:12 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:21:12 [DBG] Connection id ""0HNDQQP4NEEIS"" completed keep alive response.
2025-07-04 10:21:12 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:21:12 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 5639.3848ms
2025-07-04 10:21:17 [DBG] Connection id ""0HNDQQP4NEEIS"" received FIN.
2025-07-04 10:21:17 [DBG] Connection id ""0HNDQQP4NEEIS"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:21:17 [DBG] Connection id ""0HNDQQP4NEEIS"" disconnecting.
2025-07-04 10:21:17 [DBG] Connection id ""0HNDQQP4NEEIS"" stopped.
2025-07-04 10:22:43 [DBG] Connection id ""0HNDQQP4NEEIT"" accepted.
2025-07-04 10:22:43 [DBG] Connection id ""0HNDQQP4NEEIT"" started.
2025-07-04 10:22:43 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-001332616594" 1198768
2025-07-04 10:22:43 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:22:43 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:22:43 [DBG] Connection id ""0HNDQQP4NEEIT"" paused.
2025-07-04 10:22:43 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:22:43 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:22:43 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:22:43 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:22:43 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:22:43 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:22:43 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:22:43 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:22:43 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:22:43 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:22:43 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:22:43 [INF] Tesseract engine initialized successfully
2025-07-04 10:22:43 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:22:43 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:22:43 [DBG] Connection id ""0HNDQQP4NEEIT"", Request id ""0HNDQQP4NEEIT:00000001"": started reading request body.
2025-07-04 10:22:43 [DBG] Connection id ""0HNDQQP4NEEIT"" resumed.
2025-07-04 10:22:43 [DBG] Connection id ""0HNDQQP4NEEIT"", Request id ""0HNDQQP4NEEIT:00000001"": done reading request body.
2025-07-04 10:22:43 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:22:43 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:22:43 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:22:43 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:22:43 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:22:43 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:22:43 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:22:43 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:22:43 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:22:43 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:22:43 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:22:43 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:22:43 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:22:43 [INF] Step 1: Starting intelligent OCR process for file '"REGISTRECOMMERCE_20250529121955.pdf"'.
2025-07-04 10:22:43 [DBG] Normalized file name: '"registrecommerce20250529121955"' from original: '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-07-04 10:22:43 [INF] Detected document type 'RegistreCommerce' for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-07-04 10:22:43 [INF] Detected document type: RegistreCommerce for file: "REGISTRECOMMERCE_20250529121955.pdf"
2025-07-04 10:22:43 [DBG] Document type RegistreCommerce requires Azure OCR: False
2025-07-04 10:22:43 [INF] Using "Tesseract OCR" for document type: RegistreCommerce
2025-07-04 10:22:43 [INF] Starting Tesseract OCR processing (1198568 bytes)
2025-07-04 10:22:43 [INF] Starting PDF OCR processing for 1198568 bytes
2025-07-04 10:22:46 [INF] PDF processed successfully. Processing 2 pages
2025-07-04 10:22:46 [DBG] Processing page 1/2
2025-07-04 10:22:47 [DBG] Starting OCR processing on image data of 3920374 bytes
2025-07-04 10:22:49 [INF] OCR completed successfully. Confidence: 0.76%, Text length: 1768 characters
2025-07-04 10:22:49 [WRN] Low OCR confidence detected: 0.76%. Text quality may be poor
2025-07-04 10:22:49 [DBG] Processing page 2/2
2025-07-04 10:22:50 [DBG] Starting OCR processing on image data of 4085823 bytes
2025-07-04 10:22:53 [INF] OCR completed successfully. Confidence: 0.61%, Text length: 2093 characters
2025-07-04 10:22:53 [WRN] Low OCR confidence detected: 0.61%. Text quality may be poor
2025-07-04 10:22:53 [INF] PDF processing completed. Successfully processed 2/2 pages
2025-07-04 10:22:53 [INF] Step 2: Starting metadata extraction from OCR text for file '"REGISTRECOMMERCE_20250529121955.pdf"'.
2025-07-04 10:22:53 [INF] Starting metadata extraction from raw text for file '"REGISTRECOMMERCE_20250529121955.pdf"'.
2025-07-04 10:22:53 [DBG] Normalized file name: '"registrecommerce20250529121955"' from original: '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-07-04 10:22:53 [INF] Detected document type 'RegistreCommerce' for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-07-04 10:22:53 [INF] Detected document type: RegistreCommerce for file '"REGISTRECOMMERCE_20250529121955.pdf"'
2025-07-04 10:22:53 [DBG] Full metadata extraction completed. Found 0 NIU(s), 1 RCCM(s), 3 Date(s), 3 Name(s), 0 Registration(s), 1 Delivered Date(s), 1 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:22:53 [INF] Filtered metadata for document type 'RegistreCommerce'. Allowed fields: ["DocumentName, DocumentType, RccmNumbers, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, RegistrationDates, DeliveredDates, CompanyDuration, TribunalNames, ActivityCodes, Quarters, PhoneNumbers, EmailAddresses"]
2025-07-04 10:22:53 [INF] Metadata extraction completed for '"REGISTRECOMMERCE_20250529121955.pdf"'. Document type: RegistreCommerce, Extracted fields: 10, Is filtered: True
2025-07-04 10:22:53 [DBG] Document type RegistreCommerce requires Azure OCR: False
2025-07-04 10:22:53 [INF] Metadata extraction completed for '"REGISTRECOMMERCE_20250529121955.pdf"'. Document Type: "Registre du Commerce", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 10, NIU Numbers: 0, RCCM Numbers: 1, Business Names: 3, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:22:53 [INF] Step 4: Returning structured metadata for file '"REGISTRECOMMERCE_20250529121955.pdf"'.
2025-07-04 10:22:53 [DBG] Document type RegistreCommerce requires Azure OCR: False
2025-07-04 10:22:53 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:22:53 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:22:53 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:22:53 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:22:53 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:22:53 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:22:53 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 10509.6415ms
2025-07-04 10:22:53 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:22:53 [DBG] Connection id ""0HNDQQP4NEEIT"" completed keep alive response.
2025-07-04 10:22:53 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:22:53 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 10538.3185ms
2025-07-04 10:22:58 [DBG] Connection id ""0HNDQQP4NEEIT"" received FIN.
2025-07-04 10:22:58 [DBG] Connection id ""0HNDQQP4NEEIT"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:22:58 [DBG] Connection id ""0HNDQQP4NEEIT"" disconnecting.
2025-07-04 10:22:58 [DBG] Connection id ""0HNDQQP4NEEIT"" stopped.
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"" accepted.
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"" started.
2025-07-04 10:36:24 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-051191738740" 2163701
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"" paused.
2025-07-04 10:36:24 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:36:24 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:36:24 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:36:24 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:36:24 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:36:24 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:36:24 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:36:24 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:36:24 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:36:24 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:36:24 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:36:24 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:36:24 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:36:24 [INF] Tesseract engine initialized successfully
2025-07-04 10:36:24 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:36:24 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"", Request id ""0HNDQQP4NEEIU:00000001"": started reading request body.
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"" resumed.
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"" paused.
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"" resumed.
2025-07-04 10:36:24 [DBG] Connection id ""0HNDQQP4NEEIU"", Request id ""0HNDQQP4NEEIU:00000001"": done reading request body.
2025-07-04 10:36:24 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:36:24 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:36:24 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:36:24 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:36:24 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:36:24 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:36:24 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:36:24 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:36:24 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:36:24 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:36:24 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:36:24 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:36:24 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:36:24 [INF] Step 1: Starting intelligent OCR process for file '"6876_page-0003.jpg"'.
2025-07-04 10:36:24 [DBG] Normalized file name: '"6876page0003"' from original: '"6876_page-0003.jpg"'
2025-07-04 10:36:24 [INF] Could not detect document type for file '"6876_page-0003.jpg"', returning Unknown
2025-07-04 10:36:24 [INF] Detected document type: Unknown for file: "6876_page-0003.jpg"
2025-07-04 10:36:24 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:36:24 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 10:36:24 [INF] Starting Azure OCR processing for file: "6876_page-0003.jpg" (2163523 bytes)
2025-07-04 10:36:24 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 10:36:24 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 10:36:24 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 10:36:34 [INF] Azure OCR completed successfully for "6876_page-0003.jpg". Text length: 1796 characters
2025-07-04 10:36:34 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876_page-0003.jpg"'.
2025-07-04 10:36:34 [INF] Starting metadata extraction from raw text for file '"6876_page-0003.jpg"'.
2025-07-04 10:36:34 [DBG] Normalized file name: '"6876page0003"' from original: '"6876_page-0003.jpg"'
2025-07-04 10:36:34 [INF] Could not detect document type for file '"6876_page-0003.jpg"', returning Unknown
2025-07-04 10:36:34 [INF] Detected document type: Unknown for file '"6876_page-0003.jpg"'
2025-07-04 10:36:34 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 0 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 1 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:36:34 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 10:36:34 [INF] Metadata extraction completed for '"6876_page-0003.jpg"'. Document type: Unknown, Extracted fields: 5, Is filtered: False
2025-07-04 10:36:34 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:36:34 [INF] Metadata extraction completed for '"6876_page-0003.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:36:34 [INF] Step 4: Returning structured metadata for file '"6876_page-0003.jpg"'.
2025-07-04 10:36:34 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:36:34 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:36:34 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:36:34 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:36:34 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:36:34 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:36:34 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:36:34 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 9592.9873ms
2025-07-04 10:36:34 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:36:34 [DBG] Connection id ""0HNDQQP4NEEIU"" completed keep alive response.
2025-07-04 10:36:34 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:36:34 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 9615.6418ms
2025-07-04 10:36:38 [DBG] Connection id ""0HNDQQP4NEEIU"" received FIN.
2025-07-04 10:36:38 [DBG] Connection id ""0HNDQQP4NEEIU"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:36:38 [DBG] Connection id ""0HNDQQP4NEEIU"" disconnecting.
2025-07-04 10:36:38 [DBG] Connection id ""0HNDQQP4NEEIU"" stopped.
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEIV"" accepted.
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEIV"" started.
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ0"" accepted.
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ0"" started.
2025-07-04 10:44:36 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - null null
2025-07-04 10:44:36 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-07-04 10:44:36 [DBG] Request did not match any endpoints
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEIV"" completed keep alive response.
2025-07-04 10:44:36 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 59.9255ms
2025-07-04 10:44:36 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui.css""" - null null
2025-07-04 10:44:36 [DBG] No candidates found for the request path '"/swagger/swagger-ui.css"'
2025-07-04 10:44:36 [DBG] Request did not match any endpoints
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ1"" accepted.
2025-07-04 10:44:36 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-bundle.js""" - null null
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ1"" started.
2025-07-04 10:44:36 [DBG] No candidates found for the request path '"/swagger/swagger-ui-bundle.js"'
2025-07-04 10:44:36 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-standalone-preset.js""" - null null
2025-07-04 10:44:36 [DBG] Request did not match any endpoints
2025-07-04 10:44:36 [DBG] No candidates found for the request path '"/swagger/swagger-ui-standalone-preset.js"'
2025-07-04 10:44:36 [DBG] Request did not match any endpoints
2025-07-04 10:44:36 [INF] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
2025-07-04 10:44:36 [INF] Sending file. Request path: '"/swagger-ui-standalone-preset.js"'. Physical path: '"N/A"'
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEIV"" completed keep alive response.
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ1"" completed keep alive response.
2025-07-04 10:44:36 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui.css""" - 200 152034 "text/css" 26.6893ms
2025-07-04 10:44:36 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-standalone-preset.js""" - 200 230280 "text/javascript" 17.7412ms
2025-07-04 10:44:36 [INF] Sending file. Request path: '"/swagger-ui-bundle.js"'. Physical path: '"N/A"'
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ0"" completed keep alive response.
2025-07-04 10:44:36 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/swagger-ui-bundle.js""" - 200 1456926 "text/javascript" 33.4184ms
2025-07-04 10:44:36 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 10:44:36 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 10:44:36 [DBG] Request did not match any endpoints
2025-07-04 10:44:36 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/favicon-32x32.png""" - null null
2025-07-04 10:44:36 [DBG] No candidates found for the request path '"/swagger/favicon-32x32.png"'
2025-07-04 10:44:36 [DBG] Request did not match any endpoints
2025-07-04 10:44:36 [INF] Sending file. Request path: '"/favicon-32x32.png"'. Physical path: '"N/A"'
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ1"" completed keep alive response.
2025-07-04 10:44:36 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/favicon-32x32.png""" - 200 628 "image/png" 6.2817ms
2025-07-04 10:44:36 [DBG] Connection id ""0HNDQQP4NEEJ0"" completed keep alive response.
2025-07-04 10:44:36 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 71.334ms
2025-07-04 10:45:07 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundarygQWiAG8BE36arkFl" 491180
2025-07-04 10:45:07 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:45:07 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:45:07 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:45:07 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:45:07 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:45:07 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:45:07 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:45:07 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:45:07 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:45:07 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:45:07 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:45:07 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:45:07 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:45:07 [INF] Tesseract engine initialized successfully
2025-07-04 10:45:07 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:45:07 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:45:07 [DBG] Connection id ""0HNDQQP4NEEJ0"", Request id ""0HNDQQP4NEEJ0:00000003"": started reading request body.
2025-07-04 10:45:07 [DBG] Connection id ""0HNDQQP4NEEJ0"", Request id ""0HNDQQP4NEEJ0:00000003"": done reading request body.
2025-07-04 10:45:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:45:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:45:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:45:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:45:07 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:45:07 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:45:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:45:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:45:07 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:45:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:45:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:45:07 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:45:07 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:45:07 [INF] Step 1: Starting intelligent OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:45:07 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:45:07 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:45:07 [INF] Detected document type: CarteContribuabledValide for file: "CARTECONTRIBUABLEVALIDE_20250529122029.pdf"
2025-07-04 10:45:07 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 10:45:07 [INF] Using "Tesseract OCR" for document type: CarteContribuabledValide
2025-07-04 10:45:07 [INF] Starting Tesseract OCR processing (490959 bytes)
2025-07-04 10:45:07 [INF] Starting PDF OCR processing for 490959 bytes
2025-07-04 10:45:08 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 10:45:08 [DBG] Processing page 1/1
2025-07-04 10:45:09 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-07-04 10:45:12 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-07-04 10:45:12 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 10:45:12 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 10:45:12 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:45:12 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:45:12 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:45:12 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:45:12 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:45:12 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:45:12 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems"]
2025-07-04 10:45:12 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-07-04 10:45:12 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 10:45:12 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:45:12 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:45:12 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 10:45:12 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:45:12 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-07-04 10:45:12 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-07-04 10:45:12 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:45:12 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:45:12 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:45:12 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:45:12 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4237.2739ms
2025-07-04 10:45:12 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:45:12 [DBG] Connection id ""0HNDQQP4NEEJ0"" completed keep alive response.
2025-07-04 10:45:12 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:45:12 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4263.684ms
2025-07-04 10:46:47 [DBG] Connection id ""0HNDQQP4NEEIV"" disconnecting.
2025-07-04 10:46:47 [DBG] Connection id ""0HNDQQP4NEEJ1"" disconnecting.
2025-07-04 10:46:47 [DBG] Connection id ""0HNDQQP4NEEIV"" stopped.
2025-07-04 10:46:47 [DBG] Connection id ""0HNDQQP4NEEJ1"" stopped.
2025-07-04 10:46:47 [DBG] Connection id ""0HNDQQP4NEEIV"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:46:47 [DBG] Connection id ""0HNDQQP4NEEJ1"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:47:22 [DBG] Connection id ""0HNDQQP4NEEJ0"" disconnecting.
2025-07-04 10:47:22 [DBG] Connection id ""0HNDQQP4NEEJ0"" stopped.
2025-07-04 10:47:22 [DBG] Connection id ""0HNDQQP4NEEJ0"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"" accepted.
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"" started.
2025-07-04 10:48:02 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryhlUNSkp0joF21VdV" 3650239
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"" paused.
2025-07-04 10:48:02 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:48:02 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:48:02 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:48:02 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:48:02 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:48:02 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:48:02 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:48:02 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:48:02 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:48:02 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:48:02 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:48:02 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:48:02 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:48:02 [INF] Tesseract engine initialized successfully
2025-07-04 10:48:02 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:48:02 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"", Request id ""0HNDQQP4NEEJ2:00000001"": started reading request body.
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"" resumed.
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"" paused.
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"" resumed.
2025-07-04 10:48:02 [DBG] Connection id ""0HNDQQP4NEEJ2"", Request id ""0HNDQQP4NEEJ2:00000001"": done reading request body.
2025-07-04 10:48:02 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:48:02 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:48:02 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:48:02 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:48:02 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:48:02 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:48:02 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:48:02 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:48:02 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:02 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:02 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:02 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:48:02 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:02 [INF] Step 1: Starting intelligent OCR process for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 10:48:02 [DBG] Normalized file name: '"687641056tchindachristelleallianceinfinimentbonaberi1"' from original: '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-07-04 10:48:02 [INF] Could not detect document type for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"', returning Unknown
2025-07-04 10:48:02 [INF] Detected document type: Unknown for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"
2025-07-04 10:48:02 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:48:02 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 10:48:02 [INF] Starting Azure OCR processing for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf" (3649997 bytes)
2025-07-04 10:48:02 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 10:48:12 [INF] File processed by ImageMagick. Found 6 page(s) to analyze with Azure.
2025-07-04 10:48:12 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 10:48:21 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 10:48:31 [DBG] Analyzing page 3 with Azure AI Vision.
2025-07-04 10:48:37 [DBG] Connection id ""0HNDQQP4NEEJ3"" accepted.
2025-07-04 10:48:37 [DBG] Connection id ""0HNDQQP4NEEJ3"" started.
2025-07-04 10:48:37 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-012256025582" 491166
2025-07-04 10:48:37 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:48:37 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:48:37 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:48:37 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:48:37 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:48:37 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:48:37 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:48:37 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:48:37 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:48:37 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:48:37 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:48:37 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:48:37 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:48:37 [INF] Tesseract engine initialized successfully
2025-07-04 10:48:37 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:48:37 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:48:37 [DBG] Connection id ""0HNDQQP4NEEJ3"", Request id ""0HNDQQP4NEEJ3:00000001"": started reading request body.
2025-07-04 10:48:37 [DBG] Connection id ""0HNDQQP4NEEJ3"", Request id ""0HNDQQP4NEEJ3:00000001"": done reading request body.
2025-07-04 10:48:37 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:48:37 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:48:37 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:48:37 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:48:37 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:48:37 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:48:37 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:48:37 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:48:37 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:37 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:37 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:37 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:48:37 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:48:37 [INF] Step 1: Starting intelligent OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:48:37 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:48:37 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:48:37 [INF] Detected document type: CarteContribuabledValide for file: "CARTECONTRIBUABLEVALIDE_20250529122029.pdf"
2025-07-04 10:48:37 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 10:48:37 [INF] Using "Tesseract OCR" for document type: CarteContribuabledValide
2025-07-04 10:48:37 [INF] Starting Tesseract OCR processing (490959 bytes)
2025-07-04 10:48:37 [INF] Starting PDF OCR processing for 490959 bytes
2025-07-04 10:48:38 [DBG] Analyzing page 4 with Azure AI Vision.
2025-07-04 10:48:38 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 10:48:38 [DBG] Processing page 1/1
2025-07-04 10:48:39 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-07-04 10:48:42 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-07-04 10:48:42 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 10:48:42 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 10:48:42 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:48:42 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:48:42 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:48:42 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:48:42 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 10:48:42 [DBG] Full metadata extraction completed. Found 1 NIU(s), 1 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 2 Tax Attestation(s), 1 Tax Center(s), 1 Tax System(s), 0 ACFE Reference(s), 1 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:48:42 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems"]
2025-07-04 10:48:42 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 7, Is filtered: True
2025-07-04 10:48:42 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 10:48:42 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 7, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 2, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:48:42 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 10:48:42 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 10:48:42 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:48:42 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:48:42 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:48:42 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:48:42 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:48:42 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:48:42 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4763.6459ms
2025-07-04 10:48:42 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:48:42 [DBG] Connection id ""0HNDQQP4NEEJ3"" completed keep alive response.
2025-07-04 10:48:42 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:48:42 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4788.1817ms
2025-07-04 10:48:46 [DBG] Connection id ""0HNDQQP4NEEJ3"" received FIN.
2025-07-04 10:48:46 [DBG] Connection id ""0HNDQQP4NEEJ3"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:48:46 [DBG] Connection id ""0HNDQQP4NEEJ3"" disconnecting.
2025-07-04 10:48:46 [DBG] Connection id ""0HNDQQP4NEEJ3"" stopped.
2025-07-04 10:48:51 [DBG] Analyzing page 5 with Azure AI Vision.
2025-07-04 10:49:14 [DBG] Analyzing page 6 with Azure AI Vision.
2025-07-04 10:49:19 [INF] Azure OCR completed successfully for "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf". Text length: 7470 characters
2025-07-04 10:49:19 [INF] Step 2: Starting metadata extraction from OCR text for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 10:49:19 [INF] Starting metadata extraction from raw text for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 10:49:19 [DBG] Normalized file name: '"687641056tchindachristelleallianceinfinimentbonaberi1"' from original: '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-07-04 10:49:19 [INF] Could not detect document type for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"', returning Unknown
2025-07-04 10:49:19 [INF] Detected document type: Unknown for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-07-04 10:49:19 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 5 Date(s), 4 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 1 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:49:19 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 10:49:19 [INF] Metadata extraction completed for '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'. Document type: Unknown, Extracted fields: 8, Is filtered: False
2025-07-04 10:49:19 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:49:19 [INF] Metadata extraction completed for '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 4, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:49:19 [INF] Step 4: Returning structured metadata for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 10:49:19 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:49:19 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:49:19 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-07-04 10:49:19 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-07-04 10:49:19 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:49:19 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:49:19 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:49:19 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:49:19 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 77163.231ms
2025-07-04 10:49:19 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:49:19 [DBG] Connection id ""0HNDQQP4NEEJ2"" completed keep alive response.
2025-07-04 10:49:19 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:49:19 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 77189.5226ms
2025-07-04 10:50:53 [DBG] Connection id ""0HNDQQP4NEEJ4"" accepted.
2025-07-04 10:50:53 [DBG] Connection id ""0HNDQQP4NEEJ4"" started.
2025-07-04 10:50:53 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-060752714446" 942742
2025-07-04 10:50:53 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:50:53 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:50:53 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:50:53 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:50:53 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:50:53 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:50:53 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:50:53 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:50:53 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:50:53 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:50:53 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:50:53 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:50:53 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:50:53 [INF] Tesseract engine initialized successfully
2025-07-04 10:50:53 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:50:53 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:50:53 [DBG] Connection id ""0HNDQQP4NEEJ4"", Request id ""0HNDQQP4NEEJ4:00000001"": started reading request body.
2025-07-04 10:50:53 [DBG] Connection id ""0HNDQQP4NEEJ4"", Request id ""0HNDQQP4NEEJ4:00000001"": done reading request body.
2025-07-04 10:50:53 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:50:53 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:50:53 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:50:53 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:50:53 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:50:53 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:50:53 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:50:53 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:50:53 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:50:53 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:50:53 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:50:53 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:50:53 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:50:53 [INF] Step 1: Starting intelligent OCR process for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 10:50:53 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 10:50:53 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 10:50:53 [INF] Detected document type: FormulaireAgregeOM for file: "FORMULAIREAGREGEOM_20250529122131.pdf"
2025-07-04 10:50:53 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 10:50:53 [INF] Using "Azure OCR" for document type: FormulaireAgregeOM
2025-07-04 10:50:53 [INF] Starting Azure OCR processing for file: "FORMULAIREAGREGEOM_20250529122131.pdf" (942540 bytes)
2025-07-04 10:50:53 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 10:50:55 [INF] File processed by ImageMagick. Found 2 page(s) to analyze with Azure.
2025-07-04 10:50:55 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 10:51:00 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 10:51:03 [INF] Azure OCR completed successfully for "FORMULAIREAGREGEOM_20250529122131.pdf". Text length: 4380 characters
2025-07-04 10:51:03 [INF] Step 2: Starting metadata extraction from OCR text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 10:51:03 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 10:51:03 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 10:51:03 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 10:51:03 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 10:51:03 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:51:03 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses, RawText"]
2025-07-04 10:51:03 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 10:51:03 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 5, Is filtered: True
2025-07-04 10:51:03 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 10:51:03 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document Type: "Formulaire Agrg OM", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 2, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-07-04 10:51:03 [WRN] Validation issues for '"FORMULAIREAGREGEOM_20250529122131.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 10:51:03 [INF] Step 4: Returning structured metadata for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 10:51:03 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 10:51:03 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:51:03 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:51:03 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:51:03 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:51:03 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:51:03 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:51:03 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 9551.2689ms
2025-07-04 10:51:03 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:51:03 [DBG] Connection id ""0HNDQQP4NEEJ4"" completed keep alive response.
2025-07-04 10:51:03 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:51:03 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 9571.7076ms
2025-07-04 10:51:07 [DBG] Connection id ""0HNDQQP4NEEJ4"" received FIN.
2025-07-04 10:51:07 [DBG] Connection id ""0HNDQQP4NEEJ4"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:51:07 [DBG] Connection id ""0HNDQQP4NEEJ4"" disconnecting.
2025-07-04 10:51:07 [DBG] Connection id ""0HNDQQP4NEEJ4"" stopped.
2025-07-04 10:51:30 [DBG] Connection id ""0HNDQQP4NEEJ2"" disconnecting.
2025-07-04 10:51:30 [DBG] Connection id ""0HNDQQP4NEEJ2"" stopped.
2025-07-04 10:51:30 [DBG] Connection id ""0HNDQQP4NEEJ2"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" accepted.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" started.
2025-07-04 10:54:46 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-054243724093" 3650170
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" paused.
2025-07-04 10:54:46 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 10:54:46 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 10:54:46 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:54:46 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 10:54:46 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:54:46 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 10:54:46 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 10:54:46 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 10:54:46 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 10:54:46 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 10:54:46 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 10:54:46 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:54:46 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 10:54:46 [INF] Tesseract engine initialized successfully
2025-07-04 10:54:46 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 10:54:46 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"", Request id ""0HNDQQP4NEEJ5:00000001"": started reading request body.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" resumed.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" paused.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" resumed.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" paused.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" resumed.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" paused.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"" resumed.
2025-07-04 10:54:46 [DBG] Connection id ""0HNDQQP4NEEJ5"", Request id ""0HNDQQP4NEEJ5:00000001"": done reading request body.
2025-07-04 10:54:46 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:54:46 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 10:54:46 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:54:46 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:54:46 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 10:54:46 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 10:54:46 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:54:46 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 10:54:46 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:54:46 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:54:46 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:54:46 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 10:54:46 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 10:54:46 [INF] Step 1: Starting intelligent OCR process for file '"6876.pdf"'.
2025-07-04 10:54:46 [DBG] Normalized file name: '"6876"' from original: '"6876.pdf"'
2025-07-04 10:54:46 [INF] Could not detect document type for file '"6876.pdf"', returning Unknown
2025-07-04 10:54:46 [INF] Detected document type: Unknown for file: "6876.pdf"
2025-07-04 10:54:46 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:54:46 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 10:54:46 [INF] Starting Azure OCR processing for file: "6876.pdf" (3649997 bytes)
2025-07-04 10:54:46 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 10:54:56 [INF] File processed by ImageMagick. Found 6 page(s) to analyze with Azure.
2025-07-04 10:54:56 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 10:55:01 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 10:55:05 [DBG] Analyzing page 3 with Azure AI Vision.
2025-07-04 10:55:08 [DBG] Analyzing page 4 with Azure AI Vision.
2025-07-04 10:55:15 [DBG] Analyzing page 5 with Azure AI Vision.
2025-07-04 10:55:26 [DBG] Analyzing page 6 with Azure AI Vision.
2025-07-04 10:55:30 [INF] Azure OCR completed successfully for "6876.pdf". Text length: 7470 characters
2025-07-04 10:55:30 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876.pdf"'.
2025-07-04 10:55:30 [INF] Starting metadata extraction from raw text for file '"6876.pdf"'.
2025-07-04 10:55:30 [DBG] Normalized file name: '"6876"' from original: '"6876.pdf"'
2025-07-04 10:55:30 [INF] Could not detect document type for file '"6876.pdf"', returning Unknown
2025-07-04 10:55:30 [INF] Detected document type: Unknown for file '"6876.pdf"'
2025-07-04 10:55:30 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 5 Date(s), 4 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 1 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 10:55:30 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 10:55:30 [INF] Metadata extraction completed for '"6876.pdf"'. Document type: Unknown, Extracted fields: 8, Is filtered: False
2025-07-04 10:55:30 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:55:30 [INF] Metadata extraction completed for '"6876.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 4, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 10:55:30 [INF] Step 4: Returning structured metadata for file '"6876.pdf"'.
2025-07-04 10:55:30 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 10:55:30 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 10:55:30 [DBG] No information found on request to perform content negotiation.
2025-07-04 10:55:30 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 10:55:30 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 10:55:30 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 10:55:30 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 10:55:30 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 44473.1457ms
2025-07-04 10:55:30 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 10:55:30 [DBG] Connection id ""0HNDQQP4NEEJ5"" completed keep alive response.
2025-07-04 10:55:30 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 10:55:30 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 44496.0662ms
2025-07-04 10:55:35 [DBG] Connection id ""0HNDQQP4NEEJ5"" received FIN.
2025-07-04 10:55:35 [DBG] Connection id ""0HNDQQP4NEEJ5"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 10:55:35 [DBG] Connection id ""0HNDQQP4NEEJ5"" disconnecting.
2025-07-04 10:55:35 [DBG] Connection id ""0HNDQQP4NEEJ5"" stopped.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" accepted.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" started.
2025-07-04 11:03:29 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-043326087029" 2978211
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" paused.
2025-07-04 11:03:29 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:03:29 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:03:29 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:03:29 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:03:29 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:03:29 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:03:29 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:03:29 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:03:29 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:03:29 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:03:29 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:03:29 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:03:29 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:03:29 [INF] Tesseract engine initialized successfully
2025-07-04 11:03:29 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:03:29 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"", Request id ""0HNDQQP4NEEJ6:00000001"": started reading request body.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" resumed.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" paused.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" resumed.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" paused.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"" resumed.
2025-07-04 11:03:29 [DBG] Connection id ""0HNDQQP4NEEJ6"", Request id ""0HNDQQP4NEEJ6:00000001"": done reading request body.
2025-07-04 11:03:29 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:03:29 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:03:29 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:03:29 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:03:29 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:03:29 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:03:29 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:03:29 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:03:29 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:03:29 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:03:29 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:03:29 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:03:29 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:03:29 [INF] Step 1: Starting intelligent OCR process for file '"6876_page-0001.jpg"'.
2025-07-04 11:03:29 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 11:03:29 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 11:03:29 [INF] Detected document type: Unknown for file: "6876_page-0001.jpg"
2025-07-04 11:03:29 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:03:29 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 11:03:29 [INF] Starting Azure OCR processing for file: "6876_page-0001.jpg" (2978033 bytes)
2025-07-04 11:03:29 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:03:29 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 11:03:29 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:03:34 [INF] Azure OCR completed successfully for "6876_page-0001.jpg". Text length: 1354 characters
2025-07-04 11:03:34 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876_page-0001.jpg"'.
2025-07-04 11:03:34 [INF] Starting metadata extraction from raw text for file '"6876_page-0001.jpg"'.
2025-07-04 11:03:34 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 11:03:34 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 11:03:34 [INF] Detected document type: Unknown for file '"6876_page-0001.jpg"'
2025-07-04 11:03:34 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:03:34 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 11:03:34 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document type: Unknown, Extracted fields: 4, Is filtered: False
2025-07-04 11:03:34 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:03:34 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 11:03:34 [INF] Step 4: Returning structured metadata for file '"6876_page-0001.jpg"'.
2025-07-04 11:03:34 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:03:34 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:03:34 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:03:34 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:03:34 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:03:34 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:03:34 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:03:34 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4915.4146ms
2025-07-04 11:03:34 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:03:34 [DBG] Connection id ""0HNDQQP4NEEJ6"" completed keep alive response.
2025-07-04 11:03:34 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:03:34 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4936.5087ms
2025-07-04 11:03:38 [DBG] Connection id ""0HNDQQP4NEEJ6"" received FIN.
2025-07-04 11:03:38 [DBG] Connection id ""0HNDQQP4NEEJ6"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:03:38 [DBG] Connection id ""0HNDQQP4NEEJ6"" disconnecting.
2025-07-04 11:03:38 [DBG] Connection id ""0HNDQQP4NEEJ6"" stopped.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" accepted.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" started.
2025-07-04 11:04:47 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-035861353832" 2978211
2025-07-04 11:04:47 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:04:47 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:04:47 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:04:47 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:04:47 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:04:47 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:04:47 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:04:47 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:04:47 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:04:47 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:04:47 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:04:47 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:04:47 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" paused.
2025-07-04 11:04:47 [INF] Tesseract engine initialized successfully
2025-07-04 11:04:47 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:04:47 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"", Request id ""0HNDQQP4NEEJ7:00000001"": started reading request body.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" resumed.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" paused.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" resumed.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" paused.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"" resumed.
2025-07-04 11:04:47 [DBG] Connection id ""0HNDQQP4NEEJ7"", Request id ""0HNDQQP4NEEJ7:00000001"": done reading request body.
2025-07-04 11:04:47 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:04:47 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:04:47 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:04:47 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:04:47 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:04:47 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:04:47 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:04:47 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:04:47 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:04:47 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:04:47 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:04:47 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:04:47 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:04:47 [INF] Step 1: Starting intelligent OCR process for file '"6876_page-0001.jpg"'.
2025-07-04 11:04:47 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 11:04:47 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 11:04:47 [INF] Detected document type: Unknown for file: "6876_page-0001.jpg"
2025-07-04 11:04:47 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:04:47 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 11:04:47 [INF] Starting Azure OCR processing for file: "6876_page-0001.jpg" (2978033 bytes)
2025-07-04 11:04:47 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:04:47 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 11:04:47 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:04:56 [INF] Azure OCR completed successfully for "6876_page-0001.jpg". Text length: 1354 characters
2025-07-04 11:04:56 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876_page-0001.jpg"'.
2025-07-04 11:04:56 [INF] Starting metadata extraction from raw text for file '"6876_page-0001.jpg"'.
2025-07-04 11:04:56 [DBG] Normalized file name: '"6876page0001"' from original: '"6876_page-0001.jpg"'
2025-07-04 11:04:56 [INF] Could not detect document type for file '"6876_page-0001.jpg"', returning Unknown
2025-07-04 11:04:56 [INF] Detected document type: Unknown for file '"6876_page-0001.jpg"'
2025-07-04 11:04:56 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:04:56 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 11:04:56 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document type: Unknown, Extracted fields: 4, Is filtered: False
2025-07-04 11:04:56 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:04:56 [INF] Metadata extraction completed for '"6876_page-0001.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 11:04:56 [INF] Step 4: Returning structured metadata for file '"6876_page-0001.jpg"'.
2025-07-04 11:04:56 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:04:56 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:04:56 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:04:56 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:04:56 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:04:56 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:04:56 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:04:56 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 9299.832ms
2025-07-04 11:04:56 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:04:56 [DBG] Connection id ""0HNDQQP4NEEJ7"" completed keep alive response.
2025-07-04 11:04:56 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:04:56 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 9321.0924ms
2025-07-04 11:05:01 [DBG] Connection id ""0HNDQQP4NEEJ7"" received FIN.
2025-07-04 11:05:01 [DBG] Connection id ""0HNDQQP4NEEJ7"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:05:01 [DBG] Connection id ""0HNDQQP4NEEJ7"" disconnecting.
2025-07-04 11:05:01 [DBG] Connection id ""0HNDQQP4NEEJ7"" stopped.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" accepted.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" started.
2025-07-04 11:17:16 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-009719179560" 3650170
2025-07-04 11:17:16 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" paused.
2025-07-04 11:17:16 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:17:16 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:17:16 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:17:16 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:17:16 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:17:16 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:17:16 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:17:16 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:17:16 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:17:16 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:17:16 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:17:16 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:17:16 [INF] Tesseract engine initialized successfully
2025-07-04 11:17:16 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:17:16 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"", Request id ""0HNDQQP4NEEJ8:00000001"": started reading request body.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" resumed.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" paused.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" resumed.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" paused.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"" resumed.
2025-07-04 11:17:16 [DBG] Connection id ""0HNDQQP4NEEJ8"", Request id ""0HNDQQP4NEEJ8:00000001"": done reading request body.
2025-07-04 11:17:16 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:17:16 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:17:16 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:17:16 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:17:16 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:17:16 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:17:16 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:17:16 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:17:16 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:17:16 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:17:16 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:17:16 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:17:16 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:17:16 [INF] Step 1: Starting intelligent OCR process for file '"6876.pdf"'.
2025-07-04 11:17:16 [DBG] Normalized file name: '"6876"' from original: '"6876.pdf"'
2025-07-04 11:17:16 [INF] Could not detect document type for file '"6876.pdf"', returning Unknown
2025-07-04 11:17:16 [INF] Detected document type: Unknown for file: "6876.pdf"
2025-07-04 11:17:16 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:17:16 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 11:17:16 [INF] Starting Azure OCR processing for file: "6876.pdf" (3649997 bytes)
2025-07-04 11:17:16 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:17:26 [INF] File processed by ImageMagick. Found 6 page(s) to analyze with Azure.
2025-07-04 11:17:26 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:17:32 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 11:17:36 [DBG] Analyzing page 3 with Azure AI Vision.
2025-07-04 11:17:41 [DBG] Analyzing page 4 with Azure AI Vision.
2025-07-04 11:17:53 [DBG] Analyzing page 5 with Azure AI Vision.
2025-07-04 11:18:10 [DBG] Analyzing page 6 with Azure AI Vision.
2025-07-04 11:18:14 [INF] Azure OCR completed successfully for "6876.pdf". Text length: 7470 characters
2025-07-04 11:18:14 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876.pdf"'.
2025-07-04 11:18:14 [INF] Starting metadata extraction from raw text for file '"6876.pdf"'.
2025-07-04 11:18:14 [DBG] Normalized file name: '"6876"' from original: '"6876.pdf"'
2025-07-04 11:18:14 [INF] Could not detect document type for file '"6876.pdf"', returning Unknown
2025-07-04 11:18:14 [INF] Detected document type: Unknown for file '"6876.pdf"'
2025-07-04 11:18:14 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 5 Date(s), 4 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 1 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:18:14 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 11:18:14 [INF] Metadata extraction completed for '"6876.pdf"'. Document type: Unknown, Extracted fields: 8, Is filtered: False
2025-07-04 11:18:14 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:18:14 [INF] Metadata extraction completed for '"6876.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 4, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 11:18:14 [INF] Step 4: Returning structured metadata for file '"6876.pdf"'.
2025-07-04 11:18:14 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:18:14 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:18:14 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:18:14 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:18:14 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:18:14 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:18:14 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:18:14 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 57701.6368ms
2025-07-04 11:18:14 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:18:14 [DBG] Connection id ""0HNDQQP4NEEJ8"" completed keep alive response.
2025-07-04 11:18:14 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:18:14 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 57725.3225ms
2025-07-04 11:18:19 [DBG] Connection id ""0HNDQQP4NEEJ8"" received FIN.
2025-07-04 11:18:19 [DBG] Connection id ""0HNDQQP4NEEJ8"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:18:19 [DBG] Connection id ""0HNDQQP4NEEJ8"" disconnecting.
2025-07-04 11:18:19 [DBG] Connection id ""0HNDQQP4NEEJ8"" stopped.
2025-07-04 11:23:01 [DBG] Connection id ""0HNDQQP4NEEJ9"" accepted.
2025-07-04 11:23:01 [DBG] Connection id ""0HNDQQP4NEEJ9"" started.
2025-07-04 11:23:01 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-025903069499" 284707
2025-07-04 11:23:01 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:23:01 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:23:01 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:23:01 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:23:01 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:23:01 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:23:01 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:23:01 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:23:01 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:23:01 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:23:01 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:23:01 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:23:01 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:23:01 [INF] Tesseract engine initialized successfully
2025-07-04 11:23:01 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:23:01 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:23:01 [DBG] Connection id ""0HNDQQP4NEEJ9"", Request id ""0HNDQQP4NEEJ9:00000001"": started reading request body.
2025-07-04 11:23:01 [DBG] Connection id ""0HNDQQP4NEEJ9"", Request id ""0HNDQQP4NEEJ9:00000001"": done reading request body.
2025-07-04 11:23:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:23:01 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:23:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:23:01 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:23:01 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:23:01 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:23:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:23:01 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:23:01 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:23:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:23:01 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:23:01 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:23:01 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:23:01 [INF] Step 1: Starting intelligent OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 11:23:01 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 11:23:01 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 11:23:01 [INF] Detected document type: CniOrRecipice for file: "CNIGERANTSTATUTAIRE_20250529122010.pdf"
2025-07-04 11:23:01 [DBG] Document type CniOrRecipice requires Azure OCR: False
2025-07-04 11:23:01 [INF] Using "Tesseract OCR" for document type: CniOrRecipice
2025-07-04 11:23:01 [INF] Starting Tesseract OCR processing (284504 bytes)
2025-07-04 11:23:01 [INF] Starting PDF OCR processing for 284504 bytes
2025-07-04 11:23:02 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:23:02 [DBG] Processing page 1/1
2025-07-04 11:23:02 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-07-04 11:23:03 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-07-04 11:23:03 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-07-04 11:23:03 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:23:03 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 11:23:03 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 11:23:03 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 11:23:03 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 11:23:03 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 11:23:03 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:23:03 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates"]
2025-07-04 11:23:03 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:23:03 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 3, Is filtered: True
2025-07-04 11:23:03 [DBG] Document type CniOrRecipice requires Azure OCR: False
2025-07-04 11:23:03 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Rcpiss", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 3, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-07-04 11:23:03 [WRN] Validation issues for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:23:03 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 11:23:03 [DBG] Document type CniOrRecipice requires Azure OCR: False
2025-07-04 11:23:03 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:23:03 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:23:03 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:23:03 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:23:03 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:23:03 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:23:03 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 2552.14ms
2025-07-04 11:23:03 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:23:03 [DBG] Connection id ""0HNDQQP4NEEJ9"" completed keep alive response.
2025-07-04 11:23:03 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:23:03 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 2574.7507ms
2025-07-04 11:23:08 [DBG] Connection id ""0HNDQQP4NEEJ9"" received FIN.
2025-07-04 11:23:08 [DBG] Connection id ""0HNDQQP4NEEJ9"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:23:08 [DBG] Connection id ""0HNDQQP4NEEJ9"" disconnecting.
2025-07-04 11:23:08 [DBG] Connection id ""0HNDQQP4NEEJ9"" stopped.
2025-07-04 11:24:04 [DBG] Connection id ""0HNDQQP4NEEJA"" accepted.
2025-07-04 11:24:04 [DBG] Connection id ""0HNDQQP4NEEJA"" started.
2025-07-04 11:24:04 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-028931761627" 306640
2025-07-04 11:24:04 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:24:04 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:24:04 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:24:04 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:24:04 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:24:04 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:24:04 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:24:04 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:24:04 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:24:04 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:24:04 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:24:04 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:24:04 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:24:05 [INF] Tesseract engine initialized successfully
2025-07-04 11:24:05 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:24:05 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:24:05 [DBG] Connection id ""0HNDQQP4NEEJA"", Request id ""0HNDQQP4NEEJA:00000001"": started reading request body.
2025-07-04 11:24:05 [DBG] Connection id ""0HNDQQP4NEEJA"", Request id ""0HNDQQP4NEEJA:00000001"": done reading request body.
2025-07-04 11:24:05 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:24:05 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:24:05 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:24:05 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:24:05 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:24:05 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:24:05 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:24:05 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:24:05 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:24:05 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:24:05 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:24:05 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:24:05 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:24:05 [INF] Step 1: Starting intelligent OCR process for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-07-04 11:24:05 [DBG] Normalized file name: '"planlocalisation20250606124459"' from original: '"PLANLOCALISATION_20250606124459.pdf"'
2025-07-04 11:24:05 [INF] Could not detect document type for file '"PLANLOCALISATION_20250606124459.pdf"', returning Unknown
2025-07-04 11:24:05 [INF] Detected document type: Unknown for file: "PLANLOCALISATION_20250606124459.pdf"
2025-07-04 11:24:05 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:24:05 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 11:24:05 [INF] Starting Azure OCR processing for file: "PLANLOCALISATION_20250606124459.pdf" (306440 bytes)
2025-07-04 11:24:05 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:24:05 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 11:24:05 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:24:09 [INF] Azure OCR completed successfully for "PLANLOCALISATION_20250606124459.pdf". Text length: 279 characters
2025-07-04 11:24:09 [INF] Step 2: Starting metadata extraction from OCR text for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-07-04 11:24:09 [INF] Starting metadata extraction from raw text for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-07-04 11:24:09 [DBG] Normalized file name: '"planlocalisation20250606124459"' from original: '"PLANLOCALISATION_20250606124459.pdf"'
2025-07-04 11:24:09 [INF] Could not detect document type for file '"PLANLOCALISATION_20250606124459.pdf"', returning Unknown
2025-07-04 11:24:09 [INF] Detected document type: Unknown for file '"PLANLOCALISATION_20250606124459.pdf"'
2025-07-04 11:24:09 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 1 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:24:09 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 11:24:09 [INF] Metadata extraction completed for '"PLANLOCALISATION_20250606124459.pdf"'. Document type: Unknown, Extracted fields: 6, Is filtered: False
2025-07-04 11:24:09 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:24:09 [INF] Metadata extraction completed for '"PLANLOCALISATION_20250606124459.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 6, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 2, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: True
2025-07-04 11:24:09 [INF] Step 4: Returning structured metadata for file '"PLANLOCALISATION_20250606124459.pdf"'.
2025-07-04 11:24:09 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:24:09 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:24:09 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:24:09 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:24:09 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:24:09 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:24:09 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:24:09 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4760.5415ms
2025-07-04 11:24:09 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:24:09 [DBG] Connection id ""0HNDQQP4NEEJA"" completed keep alive response.
2025-07-04 11:24:09 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:24:09 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4782.7717ms
2025-07-04 11:24:14 [DBG] Connection id ""0HNDQQP4NEEJA"" received FIN.
2025-07-04 11:24:14 [DBG] Connection id ""0HNDQQP4NEEJA"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:24:14 [DBG] Connection id ""0HNDQQP4NEEJA"" disconnecting.
2025-07-04 11:24:14 [DBG] Connection id ""0HNDQQP4NEEJA"" stopped.
2025-07-04 11:28:36 [DBG] Connection id ""0HNDQQP4NEEJB"" accepted.
2025-07-04 11:28:36 [DBG] Connection id ""0HNDQQP4NEEJB"" started.
2025-07-04 11:28:36 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-016922992149" 479381
2025-07-04 11:28:36 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:28:36 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:28:36 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:28:36 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:28:36 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:28:36 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:28:36 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:28:36 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:28:36 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:28:36 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:28:36 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:28:36 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:28:36 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:28:36 [INF] Tesseract engine initialized successfully
2025-07-04 11:28:36 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:28:36 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:28:36 [DBG] Connection id ""0HNDQQP4NEEJB"", Request id ""0HNDQQP4NEEJB:00000001"": started reading request body.
2025-07-04 11:28:36 [DBG] Connection id ""0HNDQQP4NEEJB"", Request id ""0HNDQQP4NEEJB:00000001"": done reading request body.
2025-07-04 11:28:36 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:28:36 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:28:36 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:28:36 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:28:36 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:28:36 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:28:36 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:28:36 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:28:36 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:28:36 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:28:36 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:28:36 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:28:36 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:28:36 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:28:36 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:28:36 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:28:36 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:28:36 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:28:36 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:28:36 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:28:36 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:28:38 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:28:38 [DBG] Processing page 1/1
2025-07-04 11:28:39 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:28:41 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:28:41 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:28:41 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:28:41 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:28:41 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:28:41 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:28:41 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:28:41 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:28:41 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:28:41 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:28:41 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:28:41 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:28:41 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:28:41 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:28:41 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:28:41 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:28:41 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:28:41 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:28:41 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:28:41 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:28:41 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:28:41 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:28:41 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:28:41 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4322.4882ms
2025-07-04 11:28:41 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:28:41 [DBG] Connection id ""0HNDQQP4NEEJB"" completed keep alive response.
2025-07-04 11:28:41 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:28:41 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4346.2759ms
2025-07-04 11:28:45 [DBG] Connection id ""0HNDQQP4NEEJB"" received FIN.
2025-07-04 11:28:45 [DBG] Connection id ""0HNDQQP4NEEJB"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:28:45 [DBG] Connection id ""0HNDQQP4NEEJB"" disconnecting.
2025-07-04 11:28:45 [DBG] Connection id ""0HNDQQP4NEEJB"" stopped.
2025-07-04 11:29:51 [DBG] Connection id ""0HNDQQP4NEEJC"" accepted.
2025-07-04 11:29:51 [DBG] Connection id ""0HNDQQP4NEEJC"" started.
2025-07-04 11:29:51 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-059224440781" 479381
2025-07-04 11:29:51 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:29:51 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:29:51 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:29:51 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:29:51 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:29:51 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:29:51 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:29:51 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:29:51 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:29:51 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:29:51 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:29:51 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:29:51 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:29:51 [INF] Tesseract engine initialized successfully
2025-07-04 11:29:51 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:29:51 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:29:51 [DBG] Connection id ""0HNDQQP4NEEJC"", Request id ""0HNDQQP4NEEJC:00000001"": started reading request body.
2025-07-04 11:29:51 [DBG] Connection id ""0HNDQQP4NEEJC"", Request id ""0HNDQQP4NEEJC:00000001"": done reading request body.
2025-07-04 11:29:51 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:29:51 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:29:51 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:29:51 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:29:51 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:29:51 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:29:51 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:29:51 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:29:51 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:29:51 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:29:51 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:29:51 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:29:51 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:29:51 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:29:51 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:29:51 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:29:51 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:29:51 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:29:51 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:29:51 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:29:51 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:29:53 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:29:53 [DBG] Processing page 1/1
2025-07-04 11:29:54 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:29:56 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:29:56 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:29:56 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:29:56 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:29:56 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:29:56 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:29:56 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:29:56 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:29:56 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:29:56 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:29:56 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:29:56 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:29:56 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:29:56 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:29:56 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:29:56 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:29:56 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:29:56 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:29:56 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:29:56 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:29:56 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:29:56 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:29:56 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:29:56 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4340.3373ms
2025-07-04 11:29:56 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:29:56 [DBG] Connection id ""0HNDQQP4NEEJC"" completed keep alive response.
2025-07-04 11:29:56 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:29:56 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4362.3311ms
2025-07-04 11:30:00 [DBG] Connection id ""0HNDQQP4NEEJC"" received FIN.
2025-07-04 11:30:00 [DBG] Connection id ""0HNDQQP4NEEJC"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:30:00 [DBG] Connection id ""0HNDQQP4NEEJC"" disconnecting.
2025-07-04 11:30:00 [DBG] Connection id ""0HNDQQP4NEEJC"" stopped.
2025-07-04 11:30:28 [DBG] Connection id ""0HNDQQP4NEEJD"" accepted.
2025-07-04 11:30:28 [DBG] Connection id ""0HNDQQP4NEEJD"" started.
2025-07-04 11:30:28 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-047422589379" 479381
2025-07-04 11:30:28 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:30:28 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:30:28 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:30:28 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:30:28 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:30:28 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:30:28 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:30:28 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:30:28 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:30:28 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:30:28 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:30:28 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:30:28 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:30:28 [INF] Tesseract engine initialized successfully
2025-07-04 11:30:28 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:30:28 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:30:28 [DBG] Connection id ""0HNDQQP4NEEJD"", Request id ""0HNDQQP4NEEJD:00000001"": started reading request body.
2025-07-04 11:30:28 [DBG] Connection id ""0HNDQQP4NEEJD"", Request id ""0HNDQQP4NEEJD:00000001"": done reading request body.
2025-07-04 11:30:28 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:30:28 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:30:28 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:30:28 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:30:28 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:30:28 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:30:28 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:30:28 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:30:28 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:30:28 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:30:28 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:30:28 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:30:28 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:30:28 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:30:28 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:30:28 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:30:28 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:30:28 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:30:28 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:30:28 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:30:28 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:30:30 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:30:30 [DBG] Processing page 1/1
2025-07-04 11:30:31 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:30:33 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:30:33 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:30:33 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:30:33 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:30:33 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:30:33 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:30:33 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:30:33 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:30:33 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:30:33 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:30:33 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:30:33 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:30:33 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:30:33 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:30:33 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:30:33 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:30:33 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:30:33 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:30:33 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:30:33 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:30:33 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:30:33 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:30:33 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:30:33 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4444.7157ms
2025-07-04 11:30:33 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:30:33 [DBG] Connection id ""0HNDQQP4NEEJD"" completed keep alive response.
2025-07-04 11:30:33 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:30:33 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4466.52ms
2025-07-04 11:30:37 [DBG] Connection id ""0HNDQQP4NEEJD"" received FIN.
2025-07-04 11:30:37 [DBG] Connection id ""0HNDQQP4NEEJD"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:30:37 [DBG] Connection id ""0HNDQQP4NEEJD"" disconnecting.
2025-07-04 11:30:37 [DBG] Connection id ""0HNDQQP4NEEJD"" stopped.
2025-07-04 11:31:15 [DBG] Connection id ""0HNDQQP4NEEJE"" accepted.
2025-07-04 11:31:15 [DBG] Connection id ""0HNDQQP4NEEJE"" started.
2025-07-04 11:31:15 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-076805862118" 479381
2025-07-04 11:31:15 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:31:15 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:31:15 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:31:15 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:31:15 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:31:15 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:31:15 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:31:15 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:31:15 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:31:15 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:31:15 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:31:15 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:31:15 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:31:15 [INF] Tesseract engine initialized successfully
2025-07-04 11:31:15 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:31:15 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:31:15 [DBG] Connection id ""0HNDQQP4NEEJE"", Request id ""0HNDQQP4NEEJE:00000001"": started reading request body.
2025-07-04 11:31:15 [DBG] Connection id ""0HNDQQP4NEEJE"", Request id ""0HNDQQP4NEEJE:00000001"": done reading request body.
2025-07-04 11:31:15 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:31:15 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:31:15 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:31:15 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:31:15 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:31:15 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:31:15 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:31:15 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:31:15 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:31:15 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:31:15 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:31:15 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:31:15 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:31:15 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:31:15 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:31:15 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:31:15 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:31:15 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:31:15 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:31:15 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:31:15 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:31:17 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:31:17 [DBG] Processing page 1/1
2025-07-04 11:31:18 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:31:20 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:31:20 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:31:20 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:31:20 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:31:20 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:31:20 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:31:20 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:31:20 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:31:20 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:31:20 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:31:20 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:31:20 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:31:20 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:31:20 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:31:20 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:31:20 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:31:20 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:31:20 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:31:20 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:31:20 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:31:20 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:31:20 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:31:20 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:31:20 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4373.3503ms
2025-07-04 11:31:20 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:31:20 [DBG] Connection id ""0HNDQQP4NEEJE"" completed keep alive response.
2025-07-04 11:31:20 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:31:20 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4394.572ms
2025-07-04 11:31:24 [DBG] Connection id ""0HNDQQP4NEEJE"" received FIN.
2025-07-04 11:31:24 [DBG] Connection id ""0HNDQQP4NEEJE"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:31:24 [DBG] Connection id ""0HNDQQP4NEEJE"" disconnecting.
2025-07-04 11:31:24 [DBG] Connection id ""0HNDQQP4NEEJE"" stopped.
2025-07-04 11:32:05 [DBG] Connection id ""0HNDQQP4NEEJF"" accepted.
2025-07-04 11:32:05 [DBG] Connection id ""0HNDQQP4NEEJF"" started.
2025-07-04 11:32:05 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-046710037894" 479381
2025-07-04 11:32:05 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:32:05 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:32:05 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:32:05 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:32:05 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:32:05 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:32:05 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:32:05 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:32:05 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:32:05 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:32:05 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:32:05 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:32:05 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:32:05 [INF] Tesseract engine initialized successfully
2025-07-04 11:32:05 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:32:05 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:32:05 [DBG] Connection id ""0HNDQQP4NEEJF"", Request id ""0HNDQQP4NEEJF:00000001"": started reading request body.
2025-07-04 11:32:05 [DBG] Connection id ""0HNDQQP4NEEJF"", Request id ""0HNDQQP4NEEJF:00000001"": done reading request body.
2025-07-04 11:32:05 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:32:05 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:32:05 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:32:05 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:32:05 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:32:05 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:32:05 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:32:05 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:32:05 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:32:05 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:32:05 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:32:05 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:32:05 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:32:05 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:32:05 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:32:05 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:32:05 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:32:05 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:32:05 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:32:05 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:32:05 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:32:06 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:32:06 [DBG] Processing page 1/1
2025-07-04 11:32:07 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:32:09 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:32:09 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:32:09 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:32:09 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:32:09 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:32:09 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:32:09 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:32:09 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:32:09 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:32:09 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:32:09 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:32:09 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:32:09 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:32:09 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:32:09 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:32:09 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:32:09 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:32:09 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:32:09 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:32:09 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:32:09 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:32:09 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:32:09 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:32:09 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4464.211ms
2025-07-04 11:32:09 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:32:09 [DBG] Connection id ""0HNDQQP4NEEJF"" completed keep alive response.
2025-07-04 11:32:09 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:32:09 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4486.6341ms
2025-07-04 11:32:14 [DBG] Connection id ""0HNDQQP4NEEJF"" received FIN.
2025-07-04 11:32:14 [DBG] Connection id ""0HNDQQP4NEEJF"" disconnecting.
2025-07-04 11:32:14 [DBG] Connection id ""0HNDQQP4NEEJF"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:32:14 [DBG] Connection id ""0HNDQQP4NEEJF"" stopped.
2025-07-04 11:33:07 [DBG] Connection id ""0HNDQQP4NEEJG"" accepted.
2025-07-04 11:33:07 [DBG] Connection id ""0HNDQQP4NEEJG"" started.
2025-07-04 11:33:07 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-010390360018" 942742
2025-07-04 11:33:07 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:33:07 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:33:07 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:33:07 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:33:07 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:33:07 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:33:07 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:33:07 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:33:07 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:33:07 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:33:07 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:33:07 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:33:07 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:33:07 [INF] Tesseract engine initialized successfully
2025-07-04 11:33:07 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:33:07 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:33:07 [DBG] Connection id ""0HNDQQP4NEEJG"", Request id ""0HNDQQP4NEEJG:00000001"": started reading request body.
2025-07-04 11:33:07 [DBG] Connection id ""0HNDQQP4NEEJG"", Request id ""0HNDQQP4NEEJG:00000001"": done reading request body.
2025-07-04 11:33:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:33:07 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:33:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:33:07 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:33:07 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:33:07 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:33:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:33:07 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:33:07 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:33:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:33:07 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:33:07 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:33:07 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:33:07 [INF] Step 1: Starting intelligent OCR process for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:33:07 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:33:07 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:33:07 [INF] Detected document type: FormulaireAgregeOM for file: "FORMULAIREAGREGEOM_20250529122131.pdf"
2025-07-04 11:33:07 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:33:07 [INF] Using "Azure OCR" for document type: FormulaireAgregeOM
2025-07-04 11:33:07 [INF] Starting Azure OCR processing for file: "FORMULAIREAGREGEOM_20250529122131.pdf" (942540 bytes)
2025-07-04 11:33:07 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:33:09 [INF] File processed by ImageMagick. Found 2 page(s) to analyze with Azure.
2025-07-04 11:33:09 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:33:14 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 11:33:17 [INF] Azure OCR completed successfully for "FORMULAIREAGREGEOM_20250529122131.pdf". Text length: 4380 characters
2025-07-04 11:33:17 [INF] Step 2: Starting metadata extraction from OCR text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:33:17 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:33:17 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:33:17 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:33:17 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:33:17 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:33:17 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses, RawText"]
2025-07-04 11:33:17 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:33:17 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 5, Is filtered: True
2025-07-04 11:33:17 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:33:17 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document Type: "Formulaire Agrg OM", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 2, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-07-04 11:33:17 [WRN] Validation issues for '"FORMULAIREAGREGEOM_20250529122131.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:33:17 [INF] Step 4: Returning structured metadata for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:33:17 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:33:17 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:33:17 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:33:17 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:33:17 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:33:17 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:33:17 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:33:17 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 10156.6617ms
2025-07-04 11:33:17 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:33:17 [DBG] Connection id ""0HNDQQP4NEEJG"" completed keep alive response.
2025-07-04 11:33:17 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:33:17 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 10177.5694ms
2025-07-04 11:33:22 [DBG] Connection id ""0HNDQQP4NEEJG"" received FIN.
2025-07-04 11:33:22 [DBG] Connection id ""0HNDQQP4NEEJG"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:33:22 [DBG] Connection id ""0HNDQQP4NEEJG"" disconnecting.
2025-07-04 11:33:22 [DBG] Connection id ""0HNDQQP4NEEJG"" stopped.
2025-07-04 11:34:57 [DBG] Connection id ""0HNDQQP4NEEJH"" accepted.
2025-07-04 11:34:57 [DBG] Connection id ""0HNDQQP4NEEJH"" started.
2025-07-04 11:34:57 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-086668533439" 479381
2025-07-04 11:34:57 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:34:57 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:34:57 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:34:57 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:34:57 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:34:57 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:34:57 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:34:57 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:34:57 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:34:57 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:34:57 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:34:57 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:34:57 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:34:57 [INF] Tesseract engine initialized successfully
2025-07-04 11:34:57 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:34:57 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:34:57 [DBG] Connection id ""0HNDQQP4NEEJH"", Request id ""0HNDQQP4NEEJH:00000001"": started reading request body.
2025-07-04 11:34:57 [DBG] Connection id ""0HNDQQP4NEEJH"", Request id ""0HNDQQP4NEEJH:00000001"": done reading request body.
2025-07-04 11:34:57 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:34:57 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:34:57 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:34:57 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:34:57 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:34:57 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:34:57 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:34:57 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:34:57 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:34:57 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:34:57 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:34:57 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:34:57 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:34:57 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:34:57 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:34:57 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:34:57 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:34:57 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:34:57 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:34:57 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:34:57 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:34:59 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:34:59 [DBG] Processing page 1/1
2025-07-04 11:35:00 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:35:01 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:35:01 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:35:01 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:35:01 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:35:01 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:35:01 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:35:01 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:35:01 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:35:01 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:35:02 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:35:02 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:35:02 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:35:02 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:35:02 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:35:02 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:35:02 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:35:02 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:35:02 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:35:02 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:35:02 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:35:02 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:35:02 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:35:02 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:35:02 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4347.4459ms
2025-07-04 11:35:02 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:35:02 [DBG] Connection id ""0HNDQQP4NEEJH"" completed keep alive response.
2025-07-04 11:35:02 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:35:02 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4380.8135ms
2025-07-04 11:35:06 [DBG] Connection id ""0HNDQQP4NEEJH"" received FIN.
2025-07-04 11:35:06 [DBG] Connection id ""0HNDQQP4NEEJH"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:35:06 [DBG] Connection id ""0HNDQQP4NEEJH"" disconnecting.
2025-07-04 11:35:06 [DBG] Connection id ""0HNDQQP4NEEJH"" stopped.
2025-07-04 11:39:19 [DBG] Connection id ""0HNDQQP4NEEJI"" accepted.
2025-07-04 11:39:19 [DBG] Connection id ""0HNDQQP4NEEJI"" started.
2025-07-04 11:39:19 [DBG] Connection id ""0HNDQQP4NEEJJ"" accepted.
2025-07-04 11:39:19 [DBG] Connection id ""0HNDQQP4NEEJJ"" started.
2025-07-04 11:39:20 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 11:39:20 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 11:39:20 [DBG] Request did not match any endpoints
2025-07-04 11:39:20 [DBG] Connection id ""0HNDQQP4NEEJI"" completed keep alive response.
2025-07-04 11:39:20 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 29.267ms
2025-07-04 11:39:40 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryVk0yAF18vltjKV58" 479395
2025-07-04 11:39:40 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:39:40 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:39:40 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:39:40 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:39:40 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:39:40 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:39:40 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:39:40 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:39:40 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:39:40 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:39:40 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:39:40 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:39:40 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:39:40 [INF] Tesseract engine initialized successfully
2025-07-04 11:39:40 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:39:40 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:39:40 [DBG] Connection id ""0HNDQQP4NEEJI"", Request id ""0HNDQQP4NEEJI:00000002"": started reading request body.
2025-07-04 11:39:40 [DBG] Connection id ""0HNDQQP4NEEJI"", Request id ""0HNDQQP4NEEJI:00000002"": done reading request body.
2025-07-04 11:39:40 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:39:40 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:39:40 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:39:40 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:39:40 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:39:40 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:39:40 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:39:40 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:39:40 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:39:40 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:39:40 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:39:40 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:39:40 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:39:40 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:39:40 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:39:40 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:39:40 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 11:39:40 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:39:40 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 11:39:40 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 11:39:40 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 11:39:42 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 11:39:42 [DBG] Processing page 1/1
2025-07-04 11:39:43 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 11:39:45 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 11:39:45 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 11:39:45 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 11:39:45 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:39:45 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:39:45 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:39:45 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:39:45 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 11:39:45 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 1 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 1 ACFE Reference(s), 0 Location/Date(s), 1 Quarter(s), 1 Phone(s), 0 Email(s), 1 Regime(s).
2025-07-04 11:39:45 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates"]
2025-07-04 11:39:45 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:39:45 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 11:39:45 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:39:45 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 11:39:45 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty"
2025-07-04 11:39:45 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 11:39:45 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 11:39:45 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:39:45 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-07-04 11:39:45 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-07-04 11:39:45 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:39:45 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:39:45 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:39:45 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:39:45 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4509.9779ms
2025-07-04 11:39:45 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:39:45 [DBG] Connection id ""0HNDQQP4NEEJI"" completed keep alive response.
2025-07-04 11:39:45 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:39:45 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4560.7181ms
2025-07-04 11:40:28 [DBG] Connection id ""0HNDQQP4NEEJJ"" received FIN.
2025-07-04 11:40:28 [DBG] Connection id ""0HNDQQP4NEEJJ"" disconnecting.
2025-07-04 11:40:28 [DBG] Connection id ""0HNDQQP4NEEJJ"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:40:28 [DBG] Connection id ""0HNDQQP4NEEJJ"" stopped.
2025-07-04 11:41:56 [DBG] Connection id ""0HNDQQP4NEEJI"" disconnecting.
2025-07-04 11:41:56 [DBG] Connection id ""0HNDQQP4NEEJI"" stopped.
2025-07-04 11:41:56 [DBG] Connection id ""0HNDQQP4NEEJI"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" accepted.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" started.
2025-07-04 11:42:59 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-085790786824" 3591828
2025-07-04 11:42:59 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:42:59 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:42:59 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:42:59 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:42:59 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:42:59 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:42:59 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:42:59 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:42:59 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:42:59 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:42:59 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:42:59 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:42:59 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" paused.
2025-07-04 11:42:59 [INF] Tesseract engine initialized successfully
2025-07-04 11:42:59 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:42:59 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"", Request id ""0HNDQQP4NEEJK:00000001"": started reading request body.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" resumed.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" paused.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" resumed.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" paused.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"" resumed.
2025-07-04 11:42:59 [DBG] Connection id ""0HNDQQP4NEEJK"", Request id ""0HNDQQP4NEEJK:00000001"": done reading request body.
2025-07-04 11:42:59 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:42:59 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:42:59 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:42:59 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:42:59 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:42:59 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:42:59 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:42:59 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:42:59 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:42:59 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:42:59 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:42:59 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:42:59 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:42:59 [INF] Step 1: Starting intelligent OCR process for file '"6876.jpg"'.
2025-07-04 11:42:59 [DBG] Normalized file name: '"6876"' from original: '"6876.jpg"'
2025-07-04 11:42:59 [INF] Could not detect document type for file '"6876.jpg"', returning Unknown
2025-07-04 11:42:59 [INF] Detected document type: Unknown for file: "6876.jpg"
2025-07-04 11:42:59 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:42:59 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 11:42:59 [INF] Starting Azure OCR processing for file: "6876.jpg" (3591660 bytes)
2025-07-04 11:42:59 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:42:59 [INF] File processed by ImageMagick. Found 1 page(s) to analyze with Azure.
2025-07-04 11:42:59 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:43:05 [INF] Azure OCR completed successfully for "6876.jpg". Text length: 1108 characters
2025-07-04 11:43:05 [INF] Step 2: Starting metadata extraction from OCR text for file '"6876.jpg"'.
2025-07-04 11:43:05 [INF] Starting metadata extraction from raw text for file '"6876.jpg"'.
2025-07-04 11:43:05 [DBG] Normalized file name: '"6876"' from original: '"6876.jpg"'
2025-07-04 11:43:05 [INF] Could not detect document type for file '"6876.jpg"', returning Unknown
2025-07-04 11:43:05 [INF] Detected document type: Unknown for file '"6876.jpg"'
2025-07-04 11:43:05 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 3 Date(s), 1 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:43:05 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 11:43:05 [INF] Metadata extraction completed for '"6876.jpg"'. Document type: Unknown, Extracted fields: 5, Is filtered: False
2025-07-04 11:43:05 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:43:05 [INF] Metadata extraction completed for '"6876.jpg"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 11:43:05 [INF] Step 4: Returning structured metadata for file '"6876.jpg"'.
2025-07-04 11:43:05 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:43:05 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:43:05 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:43:05 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:43:05 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:43:05 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:43:05 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:43:05 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 6391.0783ms
2025-07-04 11:43:05 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:43:05 [DBG] Connection id ""0HNDQQP4NEEJK"" completed keep alive response.
2025-07-04 11:43:05 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:43:05 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 6414.6321ms
2025-07-04 11:43:10 [DBG] Connection id ""0HNDQQP4NEEJK"" received FIN.
2025-07-04 11:43:10 [DBG] Connection id ""0HNDQQP4NEEJK"" disconnecting.
2025-07-04 11:43:10 [DBG] Connection id ""0HNDQQP4NEEJK"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:43:10 [DBG] Connection id ""0HNDQQP4NEEJK"" stopped.
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"" accepted.
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"" started.
2025-07-04 11:45:55 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----WebKitFormBoundaryNPhiH4a6Pj1ykxEt" 3650239
2025-07-04 11:45:55 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"" paused.
2025-07-04 11:45:55 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:45:55 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:45:55 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:45:55 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:45:55 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:45:55 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:45:55 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:45:55 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:45:55 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:45:55 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:45:55 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:45:55 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:45:55 [INF] Tesseract engine initialized successfully
2025-07-04 11:45:55 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:45:55 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"", Request id ""0HNDQQP4NEEJL:00000001"": started reading request body.
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"" resumed.
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"" paused.
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"" resumed.
2025-07-04 11:45:55 [DBG] Connection id ""0HNDQQP4NEEJL"", Request id ""0HNDQQP4NEEJL:00000001"": done reading request body.
2025-07-04 11:45:55 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:45:55 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:45:55 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:45:55 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:45:55 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:45:55 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:45:55 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:45:55 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:45:55 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:45:55 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:45:55 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:45:55 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:45:55 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:45:55 [INF] Step 1: Starting intelligent OCR process for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 11:45:55 [DBG] Normalized file name: '"687641056tchindachristelleallianceinfinimentbonaberi1"' from original: '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-07-04 11:45:55 [INF] Could not detect document type for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"', returning Unknown
2025-07-04 11:45:55 [INF] Detected document type: Unknown for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"
2025-07-04 11:45:55 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:45:55 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 11:45:55 [INF] Starting Azure OCR processing for file: "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf" (3649997 bytes)
2025-07-04 11:45:55 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:46:05 [INF] File processed by ImageMagick. Found 6 page(s) to analyze with Azure.
2025-07-04 11:46:05 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:46:11 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 11:46:15 [DBG] Analyzing page 3 with Azure AI Vision.
2025-07-04 11:46:19 [DBG] Analyzing page 4 with Azure AI Vision.
2025-07-04 11:46:26 [DBG] Analyzing page 5 with Azure AI Vision.
2025-07-04 11:46:38 [DBG] Analyzing page 6 with Azure AI Vision.
2025-07-04 11:46:43 [INF] Azure OCR completed successfully for "687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf". Text length: 7470 characters
2025-07-04 11:46:43 [INF] Step 2: Starting metadata extraction from OCR text for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 11:46:43 [INF] Starting metadata extraction from raw text for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 11:46:43 [DBG] Normalized file name: '"687641056tchindachristelleallianceinfinimentbonaberi1"' from original: '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-07-04 11:46:43 [INF] Could not detect document type for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"', returning Unknown
2025-07-04 11:46:43 [INF] Detected document type: Unknown for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'
2025-07-04 11:46:43 [DBG] Full metadata extraction completed. Found 1 NIU(s), 0 RCCM(s), 5 Date(s), 4 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 1 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:46:43 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 11:46:43 [INF] Metadata extraction completed for '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'. Document type: Unknown, Extracted fields: 8, Is filtered: False
2025-07-04 11:46:43 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:46:43 [INF] Metadata extraction completed for '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 8, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 4, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 11:46:43 [INF] Step 4: Returning structured metadata for file '"687641056_TCHINDA CHRISTELLE_ALLIANCE INFINIMENT BONABERI 1.pdf"'.
2025-07-04 11:46:43 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 11:46:43 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:46:43 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-07-04 11:46:43 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-07-04 11:46:43 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:46:43 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:46:43 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:46:43 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:46:43 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 48206.2525ms
2025-07-04 11:46:43 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:46:43 [DBG] Connection id ""0HNDQQP4NEEJL"" completed keep alive response.
2025-07-04 11:46:43 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:46:43 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 48236.7888ms
2025-07-04 11:48:54 [DBG] Connection id ""0HNDQQP4NEEJL"" disconnecting.
2025-07-04 11:48:54 [DBG] Connection id ""0HNDQQP4NEEJL"" stopped.
2025-07-04 11:48:54 [DBG] Connection id ""0HNDQQP4NEEJL"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:54:24 [DBG] Connection id ""0HNDQQP4NEEJM"" accepted.
2025-07-04 11:54:24 [DBG] Connection id ""0HNDQQP4NEEJM"" started.
2025-07-04 11:54:24 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-011818930951" 942742
2025-07-04 11:54:24 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:54:24 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:54:24 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:54:24 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:54:24 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:54:24 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:54:24 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:54:24 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:54:24 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:54:24 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:54:24 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:54:24 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:54:24 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:54:24 [INF] Tesseract engine initialized successfully
2025-07-04 11:54:24 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:54:24 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:54:24 [DBG] Connection id ""0HNDQQP4NEEJM"", Request id ""0HNDQQP4NEEJM:00000001"": started reading request body.
2025-07-04 11:54:24 [DBG] Connection id ""0HNDQQP4NEEJM"", Request id ""0HNDQQP4NEEJM:00000001"": done reading request body.
2025-07-04 11:54:24 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:54:24 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:54:24 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:54:24 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:54:24 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:54:24 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:54:24 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:54:24 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:54:24 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:54:24 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:54:24 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:54:24 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:54:24 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:54:24 [INF] Step 1: Starting intelligent OCR process for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:54:24 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:54:24 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:54:24 [INF] Detected document type: FormulaireAgregeOM for file: "FORMULAIREAGREGEOM_20250529122131.pdf"
2025-07-04 11:54:24 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:54:24 [INF] Using "Azure OCR" for document type: FormulaireAgregeOM
2025-07-04 11:54:24 [INF] Starting Azure OCR processing for file: "FORMULAIREAGREGEOM_20250529122131.pdf" (942540 bytes)
2025-07-04 11:54:24 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:54:27 [INF] File processed by ImageMagick. Found 2 page(s) to analyze with Azure.
2025-07-04 11:54:27 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:54:32 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 11:54:35 [INF] Azure OCR completed successfully for "FORMULAIREAGREGEOM_20250529122131.pdf". Text length: 4380 characters
2025-07-04 11:54:35 [INF] Step 2: Starting metadata extraction from OCR text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:54:35 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:54:35 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:54:35 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:54:35 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:54:35 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:54:35 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses, RawText"]
2025-07-04 11:54:35 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:54:35 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 5, Is filtered: True
2025-07-04 11:54:35 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:54:35 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document Type: "Formulaire Agrg OM", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 2, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-07-04 11:54:35 [WRN] Validation issues for '"FORMULAIREAGREGEOM_20250529122131.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:54:35 [INF] Step 4: Returning structured metadata for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:54:35 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:54:35 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:54:35 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:54:35 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:54:35 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:54:35 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:54:35 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:54:35 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 10887.3894ms
2025-07-04 11:54:35 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:54:35 [DBG] Connection id ""0HNDQQP4NEEJM"" completed keep alive response.
2025-07-04 11:54:35 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:54:35 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 10910.6948ms
2025-07-04 11:54:39 [DBG] Connection id ""0HNDQQP4NEEJM"" received FIN.
2025-07-04 11:54:39 [DBG] Connection id ""0HNDQQP4NEEJM"" disconnecting.
2025-07-04 11:54:39 [DBG] Connection id ""0HNDQQP4NEEJM"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:54:39 [DBG] Connection id ""0HNDQQP4NEEJM"" stopped.
2025-07-04 11:58:58 [DBG] Connection id ""0HNDQQP4NEEJN"" accepted.
2025-07-04 11:58:58 [DBG] Connection id ""0HNDQQP4NEEJN"" started.
2025-07-04 11:58:58 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-089914936803" 942742
2025-07-04 11:58:58 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 11:58:58 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 11:58:58 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:58:58 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 11:58:58 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:58:58 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 11:58:58 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 11:58:58 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 11:58:58 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 11:58:58 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 11:58:58 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 11:58:58 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:58:58 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 11:58:58 [INF] Tesseract engine initialized successfully
2025-07-04 11:58:58 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 11:58:58 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 11:58:58 [DBG] Connection id ""0HNDQQP4NEEJN"", Request id ""0HNDQQP4NEEJN:00000001"": started reading request body.
2025-07-04 11:58:58 [DBG] Connection id ""0HNDQQP4NEEJN"", Request id ""0HNDQQP4NEEJN:00000001"": done reading request body.
2025-07-04 11:58:58 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:58:58 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 11:58:58 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:58:58 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:58:58 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 11:58:58 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 11:58:58 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:58:58 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 11:58:58 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:58:58 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:58:58 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:58:58 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 11:58:58 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 11:58:58 [INF] Step 1: Starting intelligent OCR process for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:58:58 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:58:58 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:58:58 [INF] Detected document type: FormulaireAgregeOM for file: "FORMULAIREAGREGEOM_20250529122131.pdf"
2025-07-04 11:58:58 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:58:58 [INF] Using "Azure OCR" for document type: FormulaireAgregeOM
2025-07-04 11:58:58 [INF] Starting Azure OCR processing for file: "FORMULAIREAGREGEOM_20250529122131.pdf" (942540 bytes)
2025-07-04 11:58:58 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 11:59:00 [INF] File processed by ImageMagick. Found 2 page(s) to analyze with Azure.
2025-07-04 11:59:00 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 11:59:04 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 11:59:07 [INF] Azure OCR completed successfully for "FORMULAIREAGREGEOM_20250529122131.pdf". Text length: 4380 characters
2025-07-04 11:59:07 [INF] Step 2: Starting metadata extraction from OCR text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:59:07 [INF] Starting metadata extraction from raw text for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:59:07 [DBG] Normalized file name: '"formulaireagregeom20250529122131"' from original: '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:59:07 [INF] Detected document type 'FormulaireAgregeOM' for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:59:07 [INF] Detected document type: FormulaireAgregeOM for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'
2025-07-04 11:59:07 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 0 Date(s), 2 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 11:59:07 [INF] Filtered metadata for document type 'FormulaireAgregeOM'. Allowed fields: ["DocumentName, DocumentType, BusinessNames, RegistrationNumbers, CompanyAddresses, LegalForms, CapitalAmounts, ActivityCodes, PhoneNumbers, EmailAddresses, RawText"]
2025-07-04 11:59:07 [WRN] Validation failed for document type FormulaireAgregeOM: "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:59:07 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document type: FormulaireAgregeOM, Extracted fields: 5, Is filtered: True
2025-07-04 11:59:07 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:59:07 [INF] Metadata extraction completed for '"FORMULAIREAGREGEOM_20250529122131.pdf"'. Document Type: "Formulaire Agrg OM", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 2, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-07-04 11:59:07 [WRN] Validation issues for '"FORMULAIREAGREGEOM_20250529122131.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 11:59:07 [INF] Step 4: Returning structured metadata for file '"FORMULAIREAGREGEOM_20250529122131.pdf"'.
2025-07-04 11:59:07 [DBG] Document type FormulaireAgregeOM requires Azure OCR: True
2025-07-04 11:59:07 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 11:59:07 [DBG] No information found on request to perform content negotiation.
2025-07-04 11:59:07 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 11:59:07 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 11:59:07 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 11:59:07 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 11:59:07 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 9850.3604ms
2025-07-04 11:59:07 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 11:59:07 [DBG] Connection id ""0HNDQQP4NEEJN"" completed keep alive response.
2025-07-04 11:59:07 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 11:59:07 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 9871.091ms
2025-07-04 11:59:12 [DBG] Connection id ""0HNDQQP4NEEJN"" received FIN.
2025-07-04 11:59:12 [DBG] Connection id ""0HNDQQP4NEEJN"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 11:59:12 [DBG] Connection id ""0HNDQQP4NEEJN"" disconnecting.
2025-07-04 11:59:12 [DBG] Connection id ""0HNDQQP4NEEJN"" stopped.
2025-07-04 15:09:46 [DBG] Connection id ""0HNDQQP4NEEJO"" accepted.
2025-07-04 15:09:46 [DBG] Connection id ""0HNDQQP4NEEJO"" started.
2025-07-04 15:09:46 [DBG] Connection id ""0HNDQQP4NEEJP"" accepted.
2025-07-04 15:09:46 [DBG] Connection id ""0HNDQQP4NEEJP"" started.
2025-07-04 15:09:46 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 15:09:46 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 15:09:46 [DBG] Request did not match any endpoints
2025-07-04 15:09:46 [DBG] Connection id ""0HNDQQP4NEEJO"" completed keep alive response.
2025-07-04 15:09:46 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 23.7667ms
2025-07-04 15:10:46 [DBG] Connection id ""0HNDQQP4NEEJP"" received FIN.
2025-07-04 15:10:46 [DBG] Connection id ""0HNDQQP4NEEJP"" disconnecting.
2025-07-04 15:10:46 [DBG] Connection id ""0HNDQQP4NEEJP"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 15:10:46 [DBG] Connection id ""0HNDQQP4NEEJP"" stopped.
2025-07-04 15:11:40 [INF] Application is shutting down...
2025-07-04 15:11:40 [DBG] Hosting stopping
2025-07-04 15:11:40 [DBG] Connection id ""0HNDQQP4NEEJO"" disconnecting.
2025-07-04 15:11:40 [DBG] Connection id ""0HNDQQP4NEEJO"" stopped.
2025-07-04 15:11:40 [DBG] Connection id ""0HNDQQP4NEEJO"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 15:11:40 [DBG] Hosting stopped
2025-07-04 15:11:47 [INF] Application starting up
2025-07-04 15:11:47 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-07-04 15:11:47 [DBG] Hosting starting
2025-07-04 15:11:47 [INF] Now listening on: "http://localhost:5190"
2025-07-04 15:11:47 [INF] Now listening on: "http://0.0.0.0:5190"
2025-07-04 15:11:47 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-07-04 15:11:47 [INF] Application started. Press Ctrl+C to shut down.
2025-07-04 15:11:47 [INF] Hosting environment: "Development"
2025-07-04 15:11:47 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-07-04 15:11:47 [DBG] Hosting started
2025-07-04 15:11:54 [DBG] Connection id ""0HNDR0ITFMFUJ"" accepted.
2025-07-04 15:11:54 [DBG] Connection id ""0HNDR0ITFMFUJ"" started.
2025-07-04 15:11:54 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-073662923415" 284707
2025-07-04 15:11:54 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-07-04 15:11:54 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 15:11:54 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 15:11:54 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 15:11:54 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 15:11:54 [WRN] Failed to determine the https port for redirect.
2025-07-04 15:11:54 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 15:11:54 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 15:11:54 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 15:11:54 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 15:11:54 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 15:11:54 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 15:11:54 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 15:11:54 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 15:11:54 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 15:11:54 [INF] Tesseract engine initialized successfully
2025-07-04 15:11:55 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 15:11:55 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 15:11:55 [DBG] Connection id ""0HNDR0ITFMFUJ"", Request id ""0HNDR0ITFMFUJ:00000001"": started reading request body.
2025-07-04 15:11:55 [DBG] Connection id ""0HNDR0ITFMFUJ"", Request id ""0HNDR0ITFMFUJ:00000001"": done reading request body.
2025-07-04 15:11:55 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 15:11:55 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 15:11:55 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 15:11:55 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 15:11:55 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 15:11:55 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 15:11:55 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 15:11:55 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 15:11:55 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 15:11:55 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 15:11:55 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 15:11:55 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 15:11:55 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 15:11:55 [INF] Step 1: Starting intelligent OCR process for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 15:11:55 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 15:11:55 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 15:11:55 [INF] Detected document type: CniOrRecipice for file: "CNIGERANTSTATUTAIRE_20250529122010.pdf"
2025-07-04 15:11:55 [DBG] Document type CniOrRecipice requires Azure OCR: False
2025-07-04 15:11:55 [INF] Using "Tesseract OCR" for document type: CniOrRecipice
2025-07-04 15:11:55 [INF] Starting Tesseract OCR processing (284504 bytes)
2025-07-04 15:11:55 [INF] Starting PDF OCR processing for 284504 bytes
2025-07-04 15:11:56 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 15:11:56 [DBG] Processing page 1/1
2025-07-04 15:11:56 [DBG] Starting OCR processing on image data of 1850802 bytes
2025-07-04 15:11:57 [INF] OCR completed successfully. Confidence: 0.47%, Text length: 678 characters
2025-07-04 15:11:57 [WRN] Low OCR confidence detected: 0.47%. Text quality may be poor
2025-07-04 15:11:57 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 15:11:57 [INF] Step 2: Starting metadata extraction from OCR text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 15:11:57 [INF] Starting metadata extraction from raw text for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 15:11:57 [DBG] Normalized file name: '"cnigerantstatutaire20250529122010"' from original: '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 15:11:57 [INF] Detected document type 'CniOrRecipice' for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 15:11:58 [INF] Detected document type: CniOrRecipice for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'
2025-07-04 15:11:58 [DBG] Full metadata extraction completed. Found 0 NIU(s), 0 RCCM(s), 1 Date(s), 0 Name(s), 0 Registration(s), 0 Delivered Date(s), 0 Duration(s), 0 Tax Attestation(s), 0 Tax Center(s), 0 Tax System(s), 0 ACFE Reference(s), 0 Location/Date(s), 0 Quarter(s), 0 Phone(s), 0 Email(s), 0 Regime(s).
2025-07-04 15:11:58 [INF] Filtered metadata for document type 'CniOrRecipice'. Allowed fields: ["DocumentName, DocumentType, RegistrationNumbers, Dates, DocumentLocationsAndDates, RawText"]
2025-07-04 15:11:58 [WRN] Validation failed for document type CniOrRecipice: "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 15:11:58 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document type: CniOrRecipice, Extracted fields: 4, Is filtered: True
2025-07-04 15:11:58 [DBG] Document type CniOrRecipice requires Azure OCR: False
2025-07-04 15:11:58 [INF] Metadata extraction completed for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'. Document Type: "CNI ou Rcpiss", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 4, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: False
2025-07-04 15:11:58 [WRN] Validation issues for '"CNIGERANTSTATUTAIRE_20250529122010.pdf"': "Critical field 'RegistrationNumbers' is missing or empty"
2025-07-04 15:11:58 [INF] Step 4: Returning structured metadata for file '"CNIGERANTSTATUTAIRE_20250529122010.pdf"'.
2025-07-04 15:11:58 [DBG] Document type CniOrRecipice requires Azure OCR: False
2025-07-04 15:11:58 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 15:11:58 [DBG] No information found on request to perform content negotiation.
2025-07-04 15:11:58 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 15:11:58 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 15:11:58 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 15:11:58 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 15:11:58 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 3275.5087ms
2025-07-04 15:11:58 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 15:11:58 [DBG] Connection id ""0HNDR0ITFMFUJ"" completed keep alive response.
2025-07-04 15:11:58 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 15:11:58 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 3374.8793ms
2025-07-04 15:12:02 [DBG] Connection id ""0HNDR0ITFMFUJ"" received FIN.
2025-07-04 15:12:02 [DBG] Connection id ""0HNDR0ITFMFUJ"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 15:12:02 [DBG] Connection id ""0HNDR0ITFMFUJ"" disconnecting.
2025-07-04 15:12:02 [DBG] Connection id ""0HNDR0ITFMFUJ"" stopped.
2025-07-04 16:17:10 [DBG] Connection id ""0HNDR0ITFMFUK"" accepted.
2025-07-04 16:17:10 [DBG] Connection id ""0HNDR0ITFMFUL"" accepted.
2025-07-04 16:17:10 [DBG] Connection id ""0HNDR0ITFMFUK"" started.
2025-07-04 16:17:10 [DBG] Connection id ""0HNDR0ITFMFUL"" started.
2025-07-04 16:17:11 [INF] Request starting "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 16:17:11 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 16:17:11 [DBG] Request did not match any endpoints
2025-07-04 16:17:11 [DBG] Connection id ""0HNDR0ITFMFUK"" completed keep alive response.
2025-07-04 16:17:11 [INF] Request finished "HTTP/1.1" "GET" "http"://"localhost:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 208.7968ms
2025-07-04 16:18:26 [DBG] Connection id ""0HNDR0ITFMFUL"" received FIN.
2025-07-04 16:18:26 [DBG] Connection id ""0HNDR0ITFMFUL"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 16:18:26 [DBG] Connection id ""0HNDR0ITFMFUL"" disconnecting.
2025-07-04 16:18:26 [DBG] Connection id ""0HNDR0ITFMFUL"" stopped.
2025-07-04 16:19:22 [DBG] Connection id ""0HNDR0ITFMFUK"" disconnecting.
2025-07-04 16:19:22 [DBG] Connection id ""0HNDR0ITFMFUK"" stopped.
2025-07-04 16:19:22 [DBG] Connection id ""0HNDR0ITFMFUK"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 16:23:14 [INF] Application is shutting down...
2025-07-04 16:23:14 [DBG] Hosting stopping
2025-07-04 16:23:14 [DBG] Hosting stopped
2025-07-04 16:23:20 [INF] Application starting up
2025-07-04 16:23:20 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-07-04 16:23:21 [DBG] Hosting starting
2025-07-04 16:23:21 [INF] Now listening on: "http://localhost:5190"
2025-07-04 16:23:21 [INF] Now listening on: "http://0.0.0.0:5190"
2025-07-04 16:23:21 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-07-04 16:23:21 [INF] Application started. Press Ctrl+C to shut down.
2025-07-04 16:23:21 [INF] Hosting environment: "Development"
2025-07-04 16:23:21 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-07-04 16:23:21 [DBG] Hosting started
2025-07-04 16:24:36 [DBG] Connection id ""0HNDR1RH918LG"" accepted.
2025-07-04 16:24:36 [DBG] Connection id ""0HNDR1RH918LG"" started.
2025-07-04 16:24:36 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-004601094368" 479381
2025-07-04 16:24:36 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-07-04 16:24:36 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 16:24:36 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 16:24:36 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:24:36 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 16:24:36 [WRN] Failed to determine the https port for redirect.
2025-07-04 16:24:36 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:24:36 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 16:24:36 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 16:24:36 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 16:24:36 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 16:24:36 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 16:24:36 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 16:24:36 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 16:24:36 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 16:24:36 [INF] Tesseract engine initialized successfully
2025-07-04 16:24:36 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 16:24:36 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 16:24:36 [DBG] Connection id ""0HNDR1RH918LG"", Request id ""0HNDR1RH918LG:00000001"": started reading request body.
2025-07-04 16:24:36 [DBG] Connection id ""0HNDR1RH918LG"", Request id ""0HNDR1RH918LG:00000001"": done reading request body.
2025-07-04 16:24:36 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 16:24:36 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 16:24:36 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:24:36 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:24:36 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 16:24:36 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:24:36 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 16:24:36 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 16:24:36 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:24:36 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:24:36 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:24:36 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 16:24:36 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:24:36 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:24:36 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:24:36 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:24:36 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 16:24:36 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 16:24:36 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 16:24:36 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 16:24:36 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 16:24:37 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 16:24:37 [DBG] Processing page 1/1
2025-07-04 16:24:39 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 16:24:40 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 16:24:40 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 16:24:40 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 16:24:40 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:24:40 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:24:40 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:24:40 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:24:40 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:24:40 [INF] Starting targeted metadata extraction for document type 'AttestationFiscale' from file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:24:40 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates, RawText"]
2025-07-04 16:24:40 [DBG] Extraction results for document type AttestationFiscale: Total fields extracted: 6. Field breakdown: "NiuNumbers: 1, Dates: 1, AcfeReferences: 1, Quarters: 1, PhoneNumbers: 1, Regimes: 1"
2025-07-04 16:24:40 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-07-04 16:24:40 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 16:24:40 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 16:24:40 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 16:24:40 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-07-04 16:24:40 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:24:40 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 16:24:40 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 16:24:40 [DBG] No information found on request to perform content negotiation.
2025-07-04 16:24:40 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 16:24:40 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 16:24:40 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 16:24:40 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 16:24:40 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4725.6051ms
2025-07-04 16:24:40 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:24:40 [DBG] Connection id ""0HNDR1RH918LG"" completed keep alive response.
2025-07-04 16:24:40 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 16:24:40 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4812.9641ms
2025-07-04 16:24:45 [DBG] Connection id ""0HNDR1RH918LG"" received FIN.
2025-07-04 16:24:45 [DBG] Connection id ""0HNDR1RH918LG"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 16:24:45 [DBG] Connection id ""0HNDR1RH918LG"" disconnecting.
2025-07-04 16:24:45 [DBG] Connection id ""0HNDR1RH918LG"" stopped.
2025-07-04 16:32:47 [INF] Application is shutting down...
2025-07-04 16:32:47 [DBG] Hosting stopping
2025-07-04 16:32:47 [DBG] Hosting stopped
2025-07-04 16:32:51 [INF] Application starting up
2025-07-04 16:32:52 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-07-04 16:32:52 [DBG] Hosting starting
2025-07-04 16:32:52 [INF] Now listening on: "http://localhost:5190"
2025-07-04 16:32:52 [INF] Now listening on: "http://0.0.0.0:5190"
2025-07-04 16:32:52 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-07-04 16:32:52 [INF] Application started. Press Ctrl+C to shut down.
2025-07-04 16:32:52 [INF] Hosting environment: "Development"
2025-07-04 16:32:52 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-07-04 16:32:52 [DBG] Hosting started
2025-07-04 16:33:15 [DBG] Connection id ""0HNDR20C017I0"" accepted.
2025-07-04 16:33:15 [DBG] Connection id ""0HNDR20C017I0"" started.
2025-07-04 16:33:15 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-072119091401" 479381
2025-07-04 16:33:15 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-07-04 16:33:15 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 16:33:15 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 16:33:15 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:33:15 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 16:33:15 [WRN] Failed to determine the https port for redirect.
2025-07-04 16:33:15 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:33:15 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 16:33:15 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 16:33:15 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 16:33:15 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 16:33:15 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 16:33:15 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 16:33:15 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 16:33:15 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 16:33:15 [INF] Tesseract engine initialized successfully
2025-07-04 16:33:15 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 16:33:15 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 16:33:15 [DBG] Connection id ""0HNDR20C017I0"", Request id ""0HNDR20C017I0:00000001"": started reading request body.
2025-07-04 16:33:15 [DBG] Connection id ""0HNDR20C017I0"", Request id ""0HNDR20C017I0:00000001"": done reading request body.
2025-07-04 16:33:15 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 16:33:15 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 16:33:15 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:33:15 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:33:15 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 16:33:15 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:33:15 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 16:33:15 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 16:33:15 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:33:15 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:33:15 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:33:15 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 16:33:15 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:33:15 [INF] Step 1: Starting intelligent OCR process for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:33:15 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:33:15 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:33:15 [INF] Detected document type: AttestationFiscale for file: "ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"
2025-07-04 16:33:15 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 16:33:15 [INF] Using "Tesseract OCR" for document type: AttestationFiscale
2025-07-04 16:33:15 [INF] Starting Tesseract OCR processing (479169 bytes)
2025-07-04 16:33:15 [INF] Starting PDF OCR processing for 479169 bytes
2025-07-04 16:33:16 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 16:33:16 [DBG] Processing page 1/1
2025-07-04 16:33:18 [DBG] Starting OCR processing on image data of 3496461 bytes
2025-07-04 16:33:19 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1294 characters
2025-07-04 16:33:19 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 16:33:19 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 16:33:19 [INF] Step 2: Starting metadata extraction from OCR text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:33:19 [INF] Starting metadata extraction from raw text for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:33:19 [DBG] Normalized file name: '"attestationnonredevance3mois20250529122057"' from original: '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:33:19 [INF] Detected document type 'AttestationFiscale' for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:33:19 [INF] Detected document type: AttestationFiscale for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'
2025-07-04 16:33:19 [INF] Starting targeted metadata extraction for document type 'AttestationFiscale' from file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:33:19 [INF] Filtered metadata for document type 'AttestationFiscale'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, Dates, AcfeReferences, CompanyAddresses, Quarters, PhoneNumbers, EmailAddresses, Regimes, DocumentLocationsAndDates, RawText"]
2025-07-04 16:33:19 [DBG] Extraction results for document type AttestationFiscale: Total fields extracted: 6. Field breakdown: "NiuNumbers: 1, Dates: 1, AcfeReferences: 1, Quarters: 1, PhoneNumbers: 1, Regimes: 1"
2025-07-04 16:33:19 [WRN] Validation failed for document type AttestationFiscale: "Critical field 'TaxAttestationNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-07-04 16:33:19 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document type: AttestationFiscale, Extracted fields: 9, Is filtered: True
2025-07-04 16:33:19 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 16:33:19 [INF] Metadata extraction completed for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'. Document Type: "Attestation Fiscale", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 9, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 1, Email Addresses: 0, Validation Valid: False
2025-07-04 16:33:19 [WRN] Validation issues for '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"': "Critical field 'TaxAttestationNumbers' is missing or empty, Critical field 'BusinessNames' is missing or empty"
2025-07-04 16:33:19 [INF] Step 4: Returning structured metadata for file '"ATTESTATIONNONREDEVANCE3MOIS_20250529122057.pdf"'.
2025-07-04 16:33:19 [DBG] Document type AttestationFiscale requires Azure OCR: False
2025-07-04 16:33:19 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 16:33:19 [DBG] No information found on request to perform content negotiation.
2025-07-04 16:33:19 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 16:33:19 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 16:33:19 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 16:33:19 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 16:33:20 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4633.5966ms
2025-07-04 16:33:20 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:33:20 [DBG] Connection id ""0HNDR20C017I0"" completed keep alive response.
2025-07-04 16:33:20 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 16:33:20 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4710.9528ms
2025-07-04 16:33:24 [DBG] Connection id ""0HNDR20C017I0"" received FIN.
2025-07-04 16:33:24 [DBG] Connection id ""0HNDR20C017I0"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 16:33:24 [DBG] Connection id ""0HNDR20C017I0"" disconnecting.
2025-07-04 16:33:24 [DBG] Connection id ""0HNDR20C017I0"" stopped.
2025-07-04 16:41:17 [INF] Application is shutting down...
2025-07-04 16:41:17 [DBG] Hosting stopping
2025-07-04 16:41:17 [DBG] Hosting stopped
2025-07-04 16:41:21 [INF] Application starting up
2025-07-04 16:41:21 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider", "Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-07-04 16:41:21 [DBG] Hosting starting
2025-07-04 16:41:22 [INF] Now listening on: "http://localhost:5190"
2025-07-04 16:41:22 [INF] Now listening on: "http://0.0.0.0:5190"
2025-07-04 16:41:22 [DBG] Loaded hosting startup assembly "DocumentProcessor.API"
2025-07-04 16:41:22 [INF] Application started. Press Ctrl+C to shut down.
2025-07-04 16:41:22 [INF] Hosting environment: "Development"
2025-07-04 16:41:22 [INF] Content root path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor"
2025-07-04 16:41:22 [DBG] Hosting started
2025-07-04 16:46:23 [DBG] Connection id ""0HNDR27MVOL0T"" accepted.
2025-07-04 16:46:23 [DBG] Connection id ""0HNDR27MVOL0T"" started.
2025-07-04 16:46:23 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-053154452911" 491166
2025-07-04 16:46:23 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-07-04 16:46:23 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 16:46:23 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 16:46:23 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:46:23 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 16:46:23 [WRN] Failed to determine the https port for redirect.
2025-07-04 16:46:23 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:46:23 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 16:46:23 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 16:46:23 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 16:46:23 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 16:46:23 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 16:46:23 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 16:46:23 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 16:46:23 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 16:46:24 [INF] Tesseract engine initialized successfully
2025-07-04 16:46:24 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 16:46:24 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 16:46:24 [DBG] Connection id ""0HNDR27MVOL0T"", Request id ""0HNDR27MVOL0T:00000001"": started reading request body.
2025-07-04 16:46:24 [DBG] Connection id ""0HNDR27MVOL0T"", Request id ""0HNDR27MVOL0T:00000001"": done reading request body.
2025-07-04 16:46:24 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 16:46:24 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 16:46:24 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:46:24 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:46:24 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 16:46:24 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 16:46:24 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 16:46:24 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 16:46:24 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:46:24 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:46:24 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:46:24 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 16:46:24 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 16:46:24 [INF] Step 1: Starting intelligent OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 16:46:24 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 16:46:24 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 16:46:24 [INF] Detected document type: CarteContribuabledValide for file: "CARTECONTRIBUABLEVALIDE_20250529122029.pdf"
2025-07-04 16:46:24 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 16:46:24 [INF] Using "Tesseract OCR" for document type: CarteContribuabledValide
2025-07-04 16:46:24 [INF] Starting Tesseract OCR processing (490959 bytes)
2025-07-04 16:46:24 [INF] Starting PDF OCR processing for 490959 bytes
2025-07-04 16:46:25 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 16:46:25 [DBG] Processing page 1/1
2025-07-04 16:46:26 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-07-04 16:46:28 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-07-04 16:46:28 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 16:46:28 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 16:46:28 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 16:46:28 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 16:46:28 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 16:46:28 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 16:46:28 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 16:46:28 [INF] Starting targeted metadata extraction for document type 'CarteContribuabledValide' from file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 16:46:28 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, Regimes, RawText"]
2025-07-04 16:46:28 [DBG] Extraction results for document type CarteContribuabledValide: Total fields extracted: 3. Field breakdown: "NiuNumbers: 1, BusinessNames: 1, TaxCenters: 1"
2025-07-04 16:46:28 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 6, Is filtered: True
2025-07-04 16:46:28 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 16:46:28 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 6, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 16:46:28 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 16:46:28 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 16:46:28 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 16:46:28 [DBG] No information found on request to perform content negotiation.
2025-07-04 16:46:28 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 16:46:28 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 16:46:28 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 16:46:28 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 16:46:28 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4495.7018ms
2025-07-04 16:46:28 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 16:46:28 [DBG] Connection id ""0HNDR27MVOL0T"" completed keep alive response.
2025-07-04 16:46:28 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 16:46:28 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4581.5175ms
2025-07-04 16:46:32 [DBG] Connection id ""0HNDR27MVOL0T"" received FIN.
2025-07-04 16:46:32 [DBG] Connection id ""0HNDR27MVOL0T"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 16:46:32 [DBG] Connection id ""0HNDR27MVOL0T"" disconnecting.
2025-07-04 16:46:32 [DBG] Connection id ""0HNDR27MVOL0T"" stopped.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" accepted.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" started.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" accepted.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" started.
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - null null
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - null null
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" accepted.
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" started.
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-precomposed.png""" - null null
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" accepted.
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/apple-touch-icon-precomposed.png"'
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" started.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" accepted.
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon.png""" - null null
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" started.
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/apple-touch-icon.png"'
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/favicon.ico""" - null null
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" completed keep alive response.
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/favicon.ico"'
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-precomposed.png""" - 404 0 null 16.9807ms
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-precomposed.png", Response status code: 404
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" completed keep alive response.
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon.png""" - 404 0 null 17.4739ms
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon.png", Response status code: 404
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/favicon.ico""" - 404 0 null 16.7881ms
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/favicon.ico", Response status code: 404
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" completed keep alive response.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 65.8073ms
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 66.6536ms
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/favicon-16x16.png""" - null null
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/favicon-32x32.png""" - null null
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/swagger/favicon-16x16.png"'
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/swagger/favicon-32x32.png"'
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" accepted.
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" started.
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-120x120-precomposed.png""" - null null
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/apple-touch-icon-120x120-precomposed.png"'
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" completed keep alive response.
2025-07-04 17:33:49 [INF] Sending file. Request path: '"/favicon-32x32.png"'. Physical path: '"N/A"'
2025-07-04 17:33:49 [INF] Sending file. Request path: '"/favicon-16x16.png"'. Physical path: '"N/A"'
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-120x120-precomposed.png""" - 404 0 null 5.9358ms
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" completed keep alive response.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-120x120-precomposed.png", Response status code: 404
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/favicon-32x32.png""" - 200 628 "image/png" 20.9618ms
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/favicon-16x16.png""" - 200 665 "image/png" 22.0987ms
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-120x120.png""" - null null
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/apple-touch-icon-120x120.png"'
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-120x120.png""" - 404 0 null 9.8339ms
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-120x120.png", Response status code: 404
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" received FIN.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" received FIN.
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-precomposed.png""" - null null
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" received FIN.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" received FIN.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/apple-touch-icon-precomposed.png"'
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" disconnecting.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" disconnecting.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" disconnecting.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" disconnecting.
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL11"" stopped.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL10"" stopped.
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-precomposed.png""" - 404 0 null 17.2883ms
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon-precomposed.png", Response status code: 404
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL12"" stopped.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0V"" stopped.
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon.png""" - null null
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/apple-touch-icon.png"'
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon.png""" - 404 0 null 4.9059ms
2025-07-04 17:33:49 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/apple-touch-icon.png", Response status code: 404
2025-07-04 17:33:49 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/favicon-32x32.png""" - null null
2025-07-04 17:33:49 [DBG] No candidates found for the request path '"/swagger/favicon-32x32.png"'
2025-07-04 17:33:49 [DBG] Request did not match any endpoints
2025-07-04 17:33:49 [INF] Sending file. Request path: '"/favicon-32x32.png"'. Physical path: '"N/A"'
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL13"" completed keep alive response.
2025-07-04 17:33:49 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/favicon-32x32.png""" - 200 628 "image/png" 5.0919ms
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" received FIN.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" disconnecting.
2025-07-04 17:33:49 [DBG] Connection id ""0HNDR27MVOL0U"" stopped.
2025-07-04 17:33:53 [DBG] Connection id ""0HNDR27MVOL14"" accepted.
2025-07-04 17:33:53 [DBG] Connection id ""0HNDR27MVOL14"" started.
2025-07-04 17:33:53 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/""" - null null
2025-07-04 17:33:53 [DBG] No candidates found for the request path '"/"'
2025-07-04 17:33:53 [DBG] Request did not match any endpoints
2025-07-04 17:33:53 [DBG] The request path "" does not match the path filter
2025-07-04 17:33:53 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:33:53 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/""" - 404 0 null 5.4191ms
2025-07-04 17:33:53 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/", Response status code: 404
2025-07-04 17:33:58 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - null null
2025-07-04 17:33:58 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-07-04 17:33:58 [DBG] Request did not match any endpoints
2025-07-04 17:33:58 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:33:58 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 6.1303ms
2025-07-04 17:33:58 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 17:33:58 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 17:33:58 [DBG] Request did not match any endpoints
2025-07-04 17:33:58 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:33:58 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 69.6076ms
2025-07-04 17:34:08 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - null null
2025-07-04 17:34:08 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-07-04 17:34:08 [DBG] Request did not match any endpoints
2025-07-04 17:34:08 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:34:08 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 5.7654ms
2025-07-04 17:34:08 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 17:34:08 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 17:34:08 [DBG] Request did not match any endpoints
2025-07-04 17:34:08 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:34:08 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 13.4035ms
2025-07-04 17:34:11 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/""" - null null
2025-07-04 17:34:11 [DBG] No candidates found for the request path '"/"'
2025-07-04 17:34:11 [DBG] Request did not match any endpoints
2025-07-04 17:34:11 [DBG] The request path "" does not match the path filter
2025-07-04 17:34:11 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:34:11 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/""" - 404 0 null 6.6553ms
2025-07-04 17:34:11 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: "GET" "http"://"172.16.16.86:5190""""/", Response status code: 404
2025-07-04 17:34:11 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - null null
2025-07-04 17:34:11 [DBG] No candidates found for the request path '"/swagger/index.html"'
2025-07-04 17:34:11 [DBG] Request did not match any endpoints
2025-07-04 17:34:12 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:34:12 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 5.0512ms
2025-07-04 17:34:12 [INF] Request starting "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/v1/swagger.json""" - null null
2025-07-04 17:34:12 [DBG] No candidates found for the request path '"/swagger/v1/swagger.json"'
2025-07-04 17:34:12 [DBG] Request did not match any endpoints
2025-07-04 17:34:12 [DBG] Connection id ""0HNDR27MVOL14"" completed keep alive response.
2025-07-04 17:34:12 [INF] Request finished "HTTP/1.1" "GET" "http"://"172.16.16.86:5190""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 10.4529ms
2025-07-04 17:34:19 [DBG] Connection id ""0HNDR27MVOL13"" received FIN.
2025-07-04 17:34:19 [DBG] Connection id ""0HNDR27MVOL13"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:34:19 [DBG] Connection id ""0HNDR27MVOL13"" disconnecting.
2025-07-04 17:34:19 [DBG] Connection id ""0HNDR27MVOL13"" stopped.
2025-07-04 17:34:28 [DBG] Connection id ""0HNDR27MVOL15"" accepted.
2025-07-04 17:34:28 [DBG] Connection id ""0HNDR27MVOL15"" started.
2025-07-04 17:34:28 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-096642392375" 169797
2025-07-04 17:34:28 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 17:34:28 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 17:34:28 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 17:34:28 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 17:34:28 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 17:34:28 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 17:34:28 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 17:34:28 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 17:34:28 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 17:34:28 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 17:34:28 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 17:34:28 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 17:34:28 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 17:34:28 [INF] Tesseract engine initialized successfully
2025-07-04 17:34:28 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 17:34:28 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 17:34:28 [DBG] Connection id ""0HNDR27MVOL15"", Request id ""0HNDR27MVOL15:00000001"": started reading request body.
2025-07-04 17:34:28 [DBG] Connection id ""0HNDR27MVOL15"", Request id ""0HNDR27MVOL15:00000001"": done reading request body.
2025-07-04 17:34:28 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 17:34:28 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 17:34:28 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 17:34:28 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 17:34:28 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 17:34:28 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 17:34:28 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 17:34:28 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 17:34:28 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 17:34:28 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 17:34:28 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 17:34:28 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 17:34:28 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 17:34:28 [INF] Step 1: Starting intelligent OCR process for file '"1750083531286_rib_information_local.pdf"'.
2025-07-04 17:34:28 [DBG] Normalized file name: '"1750083531286ribinformationlocal"' from original: '"1750083531286_rib_information_local.pdf"'
2025-07-04 17:34:28 [INF] Could not detect document type for file '"1750083531286_rib_information_local.pdf"', returning Unknown
2025-07-04 17:34:28 [INF] Detected document type: Unknown for file: "1750083531286_rib_information_local.pdf"
2025-07-04 17:34:28 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 17:34:28 [INF] Using "Azure OCR" for document type: Unknown
2025-07-04 17:34:28 [INF] Starting Azure OCR processing for file: "1750083531286_rib_information_local.pdf" (169593 bytes)
2025-07-04 17:34:28 [INF] Processing file with ImageMagick to handle PDF conversion if necessary.
2025-07-04 17:34:31 [INF] File processed by ImageMagick. Found 4 page(s) to analyze with Azure.
2025-07-04 17:34:31 [DBG] Analyzing page 1 with Azure AI Vision.
2025-07-04 17:34:35 [DBG] Analyzing page 2 with Azure AI Vision.
2025-07-04 17:34:36 [DBG] Analyzing page 3 with Azure AI Vision.
2025-07-04 17:34:38 [DBG] Analyzing page 4 with Azure AI Vision.
2025-07-04 17:34:39 [INF] Azure OCR completed successfully for "1750083531286_rib_information_local.pdf". Text length: 3237 characters
2025-07-04 17:34:39 [INF] Step 2: Starting metadata extraction from OCR text for file '"1750083531286_rib_information_local.pdf"'.
2025-07-04 17:34:39 [INF] Starting metadata extraction from raw text for file '"1750083531286_rib_information_local.pdf"'.
2025-07-04 17:34:39 [DBG] Normalized file name: '"1750083531286ribinformationlocal"' from original: '"1750083531286_rib_information_local.pdf"'
2025-07-04 17:34:39 [INF] Could not detect document type for file '"1750083531286_rib_information_local.pdf"', returning Unknown
2025-07-04 17:34:39 [INF] Detected document type: Unknown for file '"1750083531286_rib_information_local.pdf"'
2025-07-04 17:34:39 [INF] Starting targeted metadata extraction for document type 'Unknown' from file '"1750083531286_rib_information_local.pdf"'.
2025-07-04 17:34:39 [INF] Document type is Unknown, returning all metadata fields.
2025-07-04 17:34:39 [DBG] Extraction results for document type Unknown: Total fields extracted: 2. Field breakdown: "LegalForms: 1, EmailAddresses: 1"
2025-07-04 17:34:39 [INF] Metadata extraction completed for '"1750083531286_rib_information_local.pdf"'. Document type: Unknown, Extracted fields: 5, Is filtered: False
2025-07-04 17:34:39 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 17:34:39 [INF] Metadata extraction completed for '"1750083531286_rib_information_local.pdf"'. Document Type: "Document Type Unknown", OCR Service Used: "Azure Document Analysis", Total Fields Extracted: 5, NIU Numbers: 0, RCCM Numbers: 0, Business Names: 0, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 1, Validation Valid: True
2025-07-04 17:34:39 [INF] Step 4: Returning structured metadata for file '"1750083531286_rib_information_local.pdf"'.
2025-07-04 17:34:39 [DBG] Document type Unknown requires Azure OCR: True
2025-07-04 17:34:39 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 17:34:39 [DBG] No information found on request to perform content negotiation.
2025-07-04 17:34:39 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 17:34:39 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 17:34:39 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 17:34:39 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 17:34:39 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 11252.2057ms
2025-07-04 17:34:39 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 17:34:39 [DBG] Connection id ""0HNDR27MVOL15"" completed keep alive response.
2025-07-04 17:34:39 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 17:34:39 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 11277.0892ms
2025-07-04 17:34:41 [DBG] Connection id ""0HNDR27MVOL14"" received FIN.
2025-07-04 17:34:41 [DBG] Connection id ""0HNDR27MVOL14"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:34:41 [DBG] Connection id ""0HNDR27MVOL14"" disconnecting.
2025-07-04 17:34:41 [DBG] Connection id ""0HNDR27MVOL14"" stopped.
2025-07-04 17:34:44 [DBG] Connection id ""0HNDR27MVOL15"" received FIN.
2025-07-04 17:34:44 [DBG] Connection id ""0HNDR27MVOL15"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 17:34:44 [DBG] Connection id ""0HNDR27MVOL15"" disconnecting.
2025-07-04 17:34:44 [DBG] Connection id ""0HNDR27MVOL15"" stopped.
2025-07-04 18:02:30 [DBG] Connection id ""0HNDR27MVOL16"" accepted.
2025-07-04 18:02:30 [DBG] Connection id ""0HNDR27MVOL16"" started.
2025-07-04 18:02:30 [INF] Request starting "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - "multipart/form-data; boundary=----formdata-undici-007639338540" 491166
2025-07-04 18:02:30 [DBG] 1 candidate(s) found for the request path '"/api/Metadata/extract"'
2025-07-04 18:02:30 [DBG] Endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"' with route pattern '"api/Metadata/extract"' is valid for the request path '"/api/Metadata/extract"'
2025-07-04 18:02:30 [DBG] Request matched endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 18:02:30 [DBG] Static files was skipped as the request already matched an endpoint.
2025-07-04 18:02:30 [INF] Executing endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 18:02:30 [INF] Route matched with "{action = \"ExtractMetadataFromFile\", controller = \"Metadata\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ExtractMetadataFromFile(Microsoft.AspNetCore.Http.IFormFile, System.String)" on controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API").
2025-07-04 18:02:30 [DBG] Execution plan of "authorization" filters (in the following order): ["None"]
2025-07-04 18:02:30 [DBG] Execution plan of "resource" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-07-04 18:02:30 [DBG] Execution plan of "action" filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)", "Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-07-04 18:02:30 [DBG] Execution plan of "exception" filters (in the following order): ["None"]
2025-07-04 18:02:30 [DBG] Execution plan of "result" filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-07-04 18:02:30 [DBG] Executing controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 18:02:30 [INF] Initializing Tesseract engine with tessdata path: "C:\Users\czar\Documents\Stage\model\DocumentProcessor\bin\Debug\net8.0\tessdata" and model: "fra"
2025-07-04 18:02:30 [INF] Tesseract engine initialized successfully
2025-07-04 18:02:30 [INF] AzureOcrService (Image Analysis SDK) initialized successfully.
2025-07-04 18:02:30 [DBG] Executed controller factory for controller "ImageOcrMicroservice.Controllers.MetadataController" ("DocumentProcessor.API")
2025-07-04 18:02:30 [DBG] Connection id ""0HNDR27MVOL16"", Request id ""0HNDR27MVOL16:00000001"": started reading request body.
2025-07-04 18:02:30 [DBG] Connection id ""0HNDR27MVOL16"", Request id ""0HNDR27MVOL16:00000001"": done reading request body.
2025-07-04 18:02:30 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 18:02:30 [DBG] Attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' using the name '"file"' in request data ...
2025-07-04 18:02:30 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 18:02:30 [DBG] Done attempting to bind parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 18:02:30 [DBG] Attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"' ...
2025-07-04 18:02:30 [DBG] Done attempting to validate the bound parameter '"file"' of type '"Microsoft.AspNetCore.Http.IFormFile"'.
2025-07-04 18:02:30 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' ...
2025-07-04 18:02:30 [DBG] Attempting to bind parameter '"documentType"' of type '"System.String"' using the name '""' in request data ...
2025-07-04 18:02:30 [DBG] Could not find a value in the request with name '""' for binding parameter '"documentType"' of type '"System.String"'.
2025-07-04 18:02:30 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 18:02:30 [DBG] Done attempting to bind parameter '"documentType"' of type '"System.String"'.
2025-07-04 18:02:30 [DBG] Attempting to validate the bound parameter '"documentType"' of type '"System.String"' ...
2025-07-04 18:02:30 [DBG] Done attempting to validate the bound parameter '"documentType"' of type '"System.String"'.
2025-07-04 18:02:30 [INF] Step 1: Starting intelligent OCR process for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 18:02:30 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 18:02:30 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 18:02:30 [INF] Detected document type: CarteContribuabledValide for file: "CARTECONTRIBUABLEVALIDE_20250529122029.pdf"
2025-07-04 18:02:30 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 18:02:30 [INF] Using "Tesseract OCR" for document type: CarteContribuabledValide
2025-07-04 18:02:30 [INF] Starting Tesseract OCR processing (490959 bytes)
2025-07-04 18:02:30 [INF] Starting PDF OCR processing for 490959 bytes
2025-07-04 18:02:32 [INF] PDF processed successfully. Processing 1 pages
2025-07-04 18:02:32 [DBG] Processing page 1/1
2025-07-04 18:02:32 [DBG] Starting OCR processing on image data of 2988763 bytes
2025-07-04 18:02:35 [INF] OCR completed successfully. Confidence: 0.87%, Text length: 1952 characters
2025-07-04 18:02:35 [WRN] Low OCR confidence detected: 0.87%. Text quality may be poor
2025-07-04 18:02:35 [INF] PDF processing completed. Successfully processed 1/1 pages
2025-07-04 18:02:35 [INF] Step 2: Starting metadata extraction from OCR text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 18:02:35 [INF] Starting metadata extraction from raw text for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 18:02:35 [DBG] Normalized file name: '"cartecontribuablevalide20250529122029"' from original: '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 18:02:35 [INF] Detected document type 'CarteContribuabledValide' for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 18:02:35 [INF] Detected document type: CarteContribuabledValide for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'
2025-07-04 18:02:35 [INF] Starting targeted metadata extraction for document type 'CarteContribuabledValide' from file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 18:02:35 [INF] Filtered metadata for document type 'CarteContribuabledValide'. Allowed fields: ["DocumentName, DocumentType, NiuNumbers, BusinessNames, TaxAttestationNumbers, TaxCenters, TaxSystems, Regimes, RawText"]
2025-07-04 18:02:35 [DBG] Extraction results for document type CarteContribuabledValide: Total fields extracted: 3. Field breakdown: "NiuNumbers: 1, BusinessNames: 1, TaxCenters: 1"
2025-07-04 18:02:35 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document type: CarteContribuabledValide, Extracted fields: 6, Is filtered: True
2025-07-04 18:02:35 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 18:02:35 [INF] Metadata extraction completed for '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'. Document Type: "Carte Contribuable Valide", OCR Service Used: "Tesseract OCR", Total Fields Extracted: 6, NIU Numbers: 1, RCCM Numbers: 0, Business Names: 1, Tax Attestations: 0, Phone Numbers: 0, Email Addresses: 0, Validation Valid: True
2025-07-04 18:02:35 [INF] Step 4: Returning structured metadata for file '"CARTECONTRIBUABLEVALIDE_20250529122029.pdf"'.
2025-07-04 18:02:35 [DBG] Document type CarteContribuabledValide requires Azure OCR: False
2025-07-04 18:02:35 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter", "Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-07-04 18:02:35 [DBG] No information found on request to perform content negotiation.
2025-07-04 18:02:35 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-07-04 18:02:35 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-07-04 18:02:35 [DBG] Selected output formatter '"Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"' and content type '"application/json"' to write the response.
2025-07-04 18:02:35 [INF] Executing "OkObjectResult", writing value of type '"<>f__AnonymousType0`4[[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], DocumentProcessor.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]"'.
2025-07-04 18:02:35 [INF] Executed action "ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)" in 4521.3818ms
2025-07-04 18:02:35 [INF] Executed endpoint '"ImageOcrMicroservice.Controllers.MetadataController.ExtractMetadataFromFile (DocumentProcessor.API)"'
2025-07-04 18:02:35 [DBG] Connection id ""0HNDR27MVOL16"" completed keep alive response.
2025-07-04 18:02:35 [DBG] Disposing OcrService and Tesseract engine
2025-07-04 18:02:35 [INF] Request finished "HTTP/1.1" "POST" "http"://"localhost:5190""""/api/Metadata/extract""" - 200 null "application/json; charset=utf-8" 4544.3687ms
2025-07-04 18:02:39 [DBG] Connection id ""0HNDR27MVOL16"" received FIN.
2025-07-04 18:02:39 [DBG] Connection id ""0HNDR27MVOL16"" sending FIN because: ""The Socket transport's send loop completed gracefully.""
2025-07-04 18:02:39 [DBG] Connection id ""0HNDR27MVOL16"" disconnecting.
2025-07-04 18:02:39 [DBG] Connection id ""0HNDR27MVOL16"" stopped.
2025-07-04 18:05:05 [INF] Application is shutting down...
2025-07-04 18:05:05 [DBG] Hosting stopping
2025-07-04 18:05:05 [DBG] Hosting stopped
